{"timers": {"training_iteration": 4.257459065061994, "restore_env_runners": 2.2521940991282463e-05, "training_step": 4.257308474043384, "env_runner_sampling_timer": 0.5095357539830729, "learner_update_timer": 3.7397469360148534, "synch_weights": 0.001681059948168695}, "env_runners": {"episode_duration_sec_mean": 0.0012250686377228703, "num_module_steps_sampled": {"default_policy": 4096}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 2.279741058424357e-05, "get_actions": 0.00011193846392201097, "un_batch_to_individual_items": 9.439304806091073e-06, "remove_single_ts_time_rank_from_batch": 1.0152191293624057e-06, "listify_data_for_vector_env": 1.6073289365000646e-05, "tensor_to_numpy": 4.3030489016023265e-05}}, "connector_pipeline_timer": 0.00024038606703873205}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 9.567418199465055e-06, "add_time_dim_to_batch_and_zero_pad": 3.5144384535158264e-06, "numpy_to_tensor": 1.9742811293034528e-05, "add_observations_from_episodes_to_batch": 4.6998116026252075e-06, "add_states_from_episodes_to_batch": 1.960377326976352e-06}}, "connector_pipeline_timer": 6.679631676439517e-05}, "num_episodes": 1299, "episode_len_min": 1, "time_between_sampling": 0.14340727852214574, "episode_len_mean": 3.5, "env_step_timer": 2.9042612316015143e-05, "num_episodes_lifetime": 1299, "agent_episode_returns_mean": {"default_agent": 50.95625}, "episode_return_mean": 50.95625, "weights_seq_no": 0.0, "num_env_steps_sampled_lifetime": 4096, "env_reset_timer": 0.00013909503468312323, "sample": 0.08149582208434543, "env_to_module_sum_episodes_length_out": 2.2317907686669454, "env_to_module_sum_episodes_length_in": 2.2317907686669454, "episode_len_max": 12, "rlmodule_inference_timer": 7.320945949695617e-05, "num_env_steps_sampled": 4096, "episode_return_max": 52.6, "num_module_steps_sampled_lifetime": {"default_policy": 4096}, "num_agent_steps_sampled": {"default_agent": 4096}, "episode_return_min": 49.0, "num_agent_steps_sampled_lifetime": {"default_agent": 4096}, "module_episode_returns_mean": {"default_policy": 50.95625}, "num_env_steps_sampled_lifetime_throughput": NaN}, "learners": {"default_policy": {"vf_explained_var": 3.5762786865234375e-07, "gradients_default_optimizer_global_norm": 1.8693264722824097, "mean_kl_loss": 0.01636398769915104, "vf_loss_unclipped": 2164.464111328125, "module_train_batch_size_mean": 128.0, "vf_loss": 9.726834297180176, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 1.0934009552001953, "num_module_steps_trained": 162560, "num_trainable_parameters": 134148, "weights_seq_no": 1.0, "policy_loss": -0.6014745235443115, "total_loss": 9.128632545471191, "curr_entropy_coeff": 0.0, "num_module_steps_trained_lifetime": 162560, "curr_kl_coeff": 0.20000000298023224}, "__all_modules__": {"num_env_steps_trained": 6879590, "num_module_steps_trained_lifetime": 162560, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.7864047549664974e-05, "numpy_to_tensor": 0.0001680139685049653, "add_observations_from_episodes_to_batch": 0.005963620962575078, "add_states_from_episodes_to_batch": 5.570007488131523e-06, "batch_individual_items": 0.030488490010611713, "general_advantage_estimation": 0.01779086806345731, "add_columns_from_episodes_to_train_batch": 0.04677207209169865, "add_one_ts_to_episodes_and_truncate": 0.0404281800147146}}, "connector_pipeline_timer": 0.14213838800787926}, "learner_connector_sum_episodes_length_out": 5417, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 4096, "num_module_steps_trained": 162560, "num_trainable_parameters": 134148, "num_env_steps_trained_lifetime": 6879590, "num_env_steps_trained_lifetime_throughput": NaN}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 4096, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": NaN, "done": false, "training_iteration": 1, "trial_id": "40149_00000", "date": "2025-05-17_14-53-36", "timestamp": 1747461216, "time_this_iter_s": 4.261927604675293, "time_total_s": 4.261927604675293, "pid": 1464251, "hostname": "localhost.localdomain", "node_ip": "10.139.239.36", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MatmulEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4096, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f7796fcc220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4.261927604675293, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 9.442857142857141, "ram_util_percent": 14.828571428571427}}
{"timers": {"training_iteration": 4.259233127431944, "restore_env_runners": 2.2406531497836115e-05, "training_step": 4.259082130352035, "env_runner_sampling_timer": 0.5101924773934298, "learner_update_timer": 3.740844584584702, "synch_weights": 0.0016804774675983937, "synch_env_connectors": 0.0026599590200930834}, "env_runners": {"episode_duration_sec_mean": 0.0010181138168263715, "num_module_steps_sampled": {"default_policy": 4096}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 2.0548011977729003e-05, "get_actions": 0.0001052771945834981, "un_batch_to_individual_items": 9.340550588713292e-06, "remove_single_ts_time_rank_from_batch": 1.0052004199916554e-06, "listify_data_for_vector_env": 1.5877951360407137e-05, "tensor_to_numpy": 3.8983246591005146e-05}}, "connector_pipeline_timer": 0.00022637894723603826}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 9.262638258475938e-06, "add_time_dim_to_batch_and_zero_pad": 3.375085616707831e-06, "numpy_to_tensor": 1.911096649287218e-05, "add_observations_from_episodes_to_batch": 4.510414171460007e-06, "add_states_from_episodes_to_batch": 1.9257363026305913e-06}}, "connector_pipeline_timer": 6.383202913604259e-05}, "num_episodes": 1597, "episode_len_min": 1, "time_between_sampling": 0.15276779245411234, "episode_len_mean": 2.78125, "env_step_timer": 2.7798542869092534e-05, "num_episodes_lifetime": 2896, "agent_episode_returns_mean": {"default_agent": 50.85000000000001}, "episode_return_mean": 50.85000000000001, "weights_seq_no": 1.0, "num_env_steps_sampled_lifetime": 8192, "env_reset_timer": 0.00013909503468312323, "sample": 0.08139564630766172, "env_to_module_sum_episodes_length_out": 2.136528449738309, "env_to_module_sum_episodes_length_in": 2.136528449738309, "episode_len_max": 13, "rlmodule_inference_timer": 6.920996899089056e-05, "num_env_steps_sampled": 4096, "episode_return_max": 51.8, "num_module_steps_sampled_lifetime": {"default_policy": 8192}, "num_agent_steps_sampled": {"default_agent": 4096}, "episode_return_min": 49.2, "num_agent_steps_sampled_lifetime": {"default_agent": 8192}, "module_episode_returns_mean": {"default_policy": 50.85000000000001}, "num_env_steps_sampled_lifetime_throughput": 920.9799559795298}, "learners": {"default_policy": {"vf_explained_var": 2.384185791015625e-07, "gradients_default_optimizer_global_norm": 1.9148749113082886, "mean_kl_loss": 0.022230826318264008, "vf_loss_unclipped": 2153.524658203125, "module_train_batch_size_mean": 128.0, "vf_loss": 9.881627082824707, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 1.0897271633148193, "num_module_steps_trained": 171264, "num_trainable_parameters": 134148.0, "weights_seq_no": 2.0, "policy_loss": -0.6204205751419067, "total_loss": 9.265653610229492, "curr_entropy_coeff": 0.0, "num_module_steps_trained_lifetime": 333824, "curr_kl_coeff": 0.30000001192092896}, "__all_modules__": {"num_env_steps_trained": 7635966, "num_module_steps_trained_lifetime": 333824, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.786445224424824e-05, "numpy_to_tensor": 0.0001680116762057878, "add_observations_from_episodes_to_batch": 0.005963706268975511, "add_states_from_episodes_to_batch": 5.569898278918117e-06, "batch_individual_items": 0.030488891818211416, "general_advantage_estimation": 0.01779102167445235, "add_columns_from_episodes_to_train_batch": 0.04677236919468269, "add_one_ts_to_episodes_and_truncate": 0.04042891962541034}}, "connector_pipeline_timer": 0.14214003875897033}, "learner_connector_sum_episodes_length_out": 5417.0289999999995, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 4096.0, "num_module_steps_trained": 171264, "num_trainable_parameters": 134148.0, "num_env_steps_trained_lifetime": 14515556, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 8192, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 920.9799559795298, "done": false, "training_iteration": 2, "trial_id": "40149_00000", "date": "2025-05-17_14-53-40", "timestamp": 1747461220, "time_this_iter_s": 4.439693450927734, "time_total_s": 8.701621055603027, "pid": 1464251, "hostname": "localhost.localdomain", "node_ip": "10.139.239.36", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MatmulEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4096, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f7796fcc220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 8.701621055603027, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 11.0, "ram_util_percent": 14.9}}
{"timers": {"training_iteration": 4.2647972450583245, "restore_env_runners": 2.225390560925007e-05, "training_step": 4.26464624631838, "env_runner_sampling_timer": 0.5106687176493695, "learner_update_timer": 3.7458861595585247, "synch_weights": 0.0016813707531779074, "synch_env_connectors": 0.002663136359769851}, "env_runners": {"episode_duration_sec_mean": 0.0006091088434914127, "num_module_steps_sampled": {"default_policy": 4096}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.8850780530341204e-05, "get_actions": 0.00010013115551792237, "un_batch_to_individual_items": 9.215813305157883e-06, "remove_single_ts_time_rank_from_batch": 9.912890743493101e-07, "listify_data_for_vector_env": 1.564223022482138e-05, "tensor_to_numpy": 3.5918409553463447e-05}}, "connector_pipeline_timer": 0.00021533986505477233}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 8.960300897609987e-06, "add_time_dim_to_batch_and_zero_pad": 3.2574695797559176e-06, "numpy_to_tensor": 1.855708062253649e-05, "add_observations_from_episodes_to_batch": 4.346626060394373e-06, "add_states_from_episodes_to_batch": 1.8889251306136001e-06}}, "connector_pipeline_timer": 6.1272146478566e-05}, "num_episodes": 1941, "episode_len_min": 1, "time_between_sampling": 0.16883030908361443, "episode_len_mean": 1.71875, "env_step_timer": 2.6676890734837638e-05, "num_episodes_lifetime": 4837, "agent_episode_returns_mean": {"default_agent": 50.89999999999999}, "episode_return_mean": 50.89999999999999, "weights_seq_no": 2.0, "num_env_steps_sampled_lifetime": 12288, "env_reset_timer": 0.00013909503468312323, "sample": 0.08130016070581328, "env_to_module_sum_episodes_length_out": 1.9473142346248442, "env_to_module_sum_episodes_length_in": 1.9473142346248442, "episode_len_max": 6, "rlmodule_inference_timer": 6.616042557917846e-05, "num_env_steps_sampled": 4096, "episode_return_max": 51.2, "num_module_steps_sampled_lifetime": {"default_policy": 12288}, "num_agent_steps_sampled": {"default_agent": 4096}, "episode_return_min": 50.0, "num_agent_steps_sampled_lifetime": {"default_agent": 12288}, "module_episode_returns_mean": {"default_policy": 50.89999999999999}, "num_env_steps_sampled_lifetime_throughput": 848.4733124877299}, "learners": {"default_policy": {"vf_explained_var": -3.5762786865234375e-07, "gradients_default_optimizer_global_norm": 0.7763156294822693, "mean_kl_loss": 0.00976380705833435, "vf_loss_unclipped": 2312.81005859375, "module_train_batch_size_mean": 128.0, "vf_loss": 9.90283203125, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 1.0657806396484375, "num_module_steps_trained": 181760, "num_trainable_parameters": 134148.0, "weights_seq_no": 3.0, "policy_loss": -0.7027074098587036, "total_loss": 9.203054428100586, "curr_entropy_coeff": 0.0, "num_module_steps_trained_lifetime": 515584, "curr_kl_coeff": 0.30000001192092896}, "__all_modules__": {"num_env_steps_trained": 8598100, "num_module_steps_trained_lifetime": 515584, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.7864677446661512e-05, "numpy_to_tensor": 0.00016800739194895137, "add_observations_from_episodes_to_batch": 0.005964073701548856, "add_states_from_episodes_to_batch": 5.569617946399376e-06, "batch_individual_items": 0.03050351814445807, "general_advantage_estimation": 0.017791329543121622, "add_columns_from_episodes_to_train_batch": 0.046773467544605485, "add_one_ts_to_episodes_and_truncate": 0.040431527518894284}}, "connector_pipeline_timer": 0.1421590193800421}, "learner_connector_sum_episodes_length_out": 5417.121219999999, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 4096.0, "num_module_steps_trained": 181760, "num_trainable_parameters": 134148.0, "num_env_steps_trained_lifetime": 23113656, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 12288, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 848.4733124877299, "done": false, "training_iteration": 3, "trial_id": "40149_00000", "date": "2025-05-17_14-53-45", "timestamp": 1747461225, "time_this_iter_s": 4.820086717605591, "time_total_s": 13.521707773208618, "pid": 1464251, "hostname": "localhost.localdomain", "node_ip": "10.139.239.36", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MatmulEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4096, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f7796fcc220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 13.521707773208618, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 10.685714285714287, "ram_util_percent": 14.885714285714286}}
{"timers": {"training_iteration": 4.273041718788546, "restore_env_runners": 2.212684574350715e-05, "training_step": 4.272890454214564, "env_runner_sampling_timer": 0.5122573728639067, "learner_update_timer": 3.7524883606027517, "synch_weights": 0.001682262525050086, "synch_env_connectors": 0.0026602113862289117}, "env_runners": {"episode_duration_sec_mean": 0.0006587708412553184, "num_module_steps_sampled": {"default_policy": 4096}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.7823772505846064e-05, "get_actions": 9.75558820798651e-05, "un_batch_to_individual_items": 9.266537553543674e-06, "remove_single_ts_time_rank_from_batch": 9.995808301663472e-07, "listify_data_for_vector_env": 1.5716709870232627e-05, "tensor_to_numpy": 3.4077963953913055e-05}}, "connector_pipeline_timer": 0.00021014018647091604}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 8.951636588973648e-06, "add_time_dim_to_batch_and_zero_pad": 3.219441834999397e-06, "numpy_to_tensor": 1.8413878858992598e-05, "add_observations_from_episodes_to_batch": 4.296996991740101e-06, "add_states_from_episodes_to_batch": 1.8963687711655948e-06}}, "connector_pipeline_timer": 6.0524138610247377e-05}, "num_episodes": 2164, "episode_len_min": 1, "time_between_sampling": 0.19025721019110767, "episode_len_mean": 1.78125, "env_step_timer": 2.615402402423804e-05, "num_episodes_lifetime": 7001, "agent_episode_returns_mean": {"default_agent": 50.95625}, "episode_return_mean": 50.95625, "weights_seq_no": 3.0, "num_env_steps_sampled_lifetime": 16384, "env_reset_timer": 0.00013909503468312323, "sample": 0.08129278189082688, "env_to_module_sum_episodes_length_out": 1.7558182517484355, "env_to_module_sum_episodes_length_in": 1.7558182517484355, "episode_len_max": 6, "rlmodule_inference_timer": 6.676376215637248e-05, "num_env_steps_sampled": 4096, "episode_return_max": 51.2, "num_module_steps_sampled_lifetime": {"default_policy": 16384}, "num_agent_steps_sampled": {"default_agent": 4096}, "episode_return_min": 50.2, "num_agent_steps_sampled_lifetime": {"default_agent": 16384}, "module_episode_returns_mean": {"default_policy": 50.95625}, "num_env_steps_sampled_lifetime_throughput": 802.923275698711}, "learners": {"default_policy": {"vf_explained_var": -1.1920928955078125e-07, "gradients_default_optimizer_global_norm": 0.989558219909668, "mean_kl_loss": 0.010364919900894165, "vf_loss_unclipped": 2290.7578125, "module_train_batch_size_mean": 128.0, "vf_loss": 9.890508651733398, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 1.0205508470535278, "num_module_steps_trained": 188160, "num_trainable_parameters": 134148.0, "weights_seq_no": 4.0, "policy_loss": -0.6854576468467712, "total_loss": 9.208161354064941, "curr_entropy_coeff": 0.0, "num_module_steps_trained_lifetime": 703744, "curr_kl_coeff": 0.30000001192092896}, "__all_modules__": {"num_env_steps_trained": 9219840, "num_module_steps_trained_lifetime": 703744, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.786462160652619e-05, "numpy_to_tensor": 0.0001680012139057263, "add_observations_from_episodes_to_batch": 0.005964777969037057, "add_states_from_episodes_to_batch": 5.569207933564903e-06, "batch_individual_items": 0.03051873714090259, "general_advantage_estimation": 0.017791934635848564, "add_columns_from_episodes_to_train_batch": 0.046790371154807796, "add_one_ts_to_episodes_and_truncate": 0.04043645615575255}}, "connector_pipeline_timer": 0.14219735628631772}, "learner_connector_sum_episodes_length_out": 5417.297092699999, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 4096.0, "num_module_steps_trained": 188160, "num_trainable_parameters": 134148.0, "num_env_steps_trained_lifetime": 32333496, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 16384, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 802.923275698711, "done": false, "training_iteration": 4, "trial_id": "40149_00000", "date": "2025-05-17_14-53-50", "timestamp": 1747461230, "time_this_iter_s": 5.093109369277954, "time_total_s": 18.614817142486572, "pid": 1464251, "hostname": "localhost.localdomain", "node_ip": "10.139.239.36", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MatmulEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4096, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f7796fcc220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 18.614817142486572, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 11.4, "ram_util_percent": 14.799999999999999}}
{"timers": {"training_iteration": 4.284466588600545, "restore_env_runners": 2.1987127383165066e-05, "training_step": 4.284315128673268, "env_runner_sampling_timer": 0.5170655219849439, "learner_update_timer": 3.759056131107588, "synch_weights": 0.0016824561900209486, "synch_env_connectors": 0.0026533050730957186}, "env_runners": {"episode_duration_sec_mean": 0.0007150164165068418, "num_module_steps_sampled": {"default_policy": 4096}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.6951723925229937e-05, "get_actions": 9.502445570773295e-05, "un_batch_to_individual_items": 9.218670524092017e-06, "remove_single_ts_time_rank_from_batch": 9.941060667550017e-07, "listify_data_for_vector_env": 1.5625431627829954e-05, "tensor_to_numpy": 3.2511868357002136e-05}}, "connector_pipeline_timer": 0.00020475574628313643}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 8.830620858102478e-06, "add_time_dim_to_batch_and_zero_pad": 3.1610877292925677e-06, "numpy_to_tensor": 1.816060731049215e-05, "add_observations_from_episodes_to_batch": 4.221727842818098e-06, "add_states_from_episodes_to_batch": 1.879918779528407e-06}}, "connector_pipeline_timer": 5.934753875100945e-05}, "num_episodes": 2393, "episode_len_min": 1, "time_between_sampling": 0.2161854525198589, "episode_len_mean": 2.0, "env_step_timer": 2.551231892361747e-05, "num_episodes_lifetime": 9394, "agent_episode_returns_mean": {"default_agent": 50.9375}, "episode_return_mean": 50.9375, "weights_seq_no": 4.0, "num_env_steps_sampled_lifetime": 20480, "env_reset_timer": 0.00013909503468312323, "sample": 0.08147174822298547, "env_to_module_sum_episodes_length_out": 1.5677083127346134, "env_to_module_sum_episodes_length_in": 1.5677083127346134, "episode_len_max": 4, "rlmodule_inference_timer": 7.4700189432859e-05, "num_env_steps_sampled": 4096, "episode_return_max": 51.4, "num_module_steps_sampled_lifetime": {"default_policy": 20480}, "num_agent_steps_sampled": {"default_agent": 4096}, "episode_return_min": 50.0, "num_agent_steps_sampled_lifetime": {"default_agent": 20480}, "module_episode_returns_mean": {"default_policy": 50.9375}, "num_env_steps_sampled_lifetime_throughput": 754.7908285726918}, "learners": {"default_policy": {"vf_explained_var": -4.76837158203125e-07, "gradients_default_optimizer_global_norm": 0.6271354556083679, "mean_kl_loss": 0.014995300211012363, "vf_loss_unclipped": 2325.5986328125, "module_train_batch_size_mean": 128.0, "vf_loss": 9.879523277282715, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 0.9475245475769043, "num_module_steps_trained": 195072, "num_trainable_parameters": 134148.0, "weights_seq_no": 5.0, "policy_loss": -0.7359363436698914, "total_loss": 9.148086547851562, "curr_entropy_coeff": 0.0, "num_module_steps_trained_lifetime": 898816, "curr_kl_coeff": 0.30000001192092896}, "__all_modules__": {"num_env_steps_trained": 9907524, "num_module_steps_trained_lifetime": 898816, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.7864274210292467e-05, "numpy_to_tensor": 0.00016799279967888057, "add_observations_from_episodes_to_batch": 0.005965943028202379, "add_states_from_episodes_to_batch": 5.568641956129856e-06, "batch_individual_items": 0.03053456646629605, "general_advantage_estimation": 0.017792881744166145, "add_columns_from_episodes_to_train_batch": 0.04680818089584401, "add_one_ts_to_episodes_and_truncate": 0.040444441835219204}}, "connector_pipeline_timer": 0.14224108739533642}, "learner_connector_sum_episodes_length_out": 5417.577835823999, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 4096.0, "num_module_steps_trained": 195072, "num_trainable_parameters": 134148.0, "num_env_steps_trained_lifetime": 42241020, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 20480, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 754.7908285726918, "done": false, "training_iteration": 5, "trial_id": "40149_00000", "date": "2025-05-17_14-53-56", "timestamp": 1747461236, "time_this_iter_s": 5.420582056045532, "time_total_s": 24.035399198532104, "pid": 1464251, "hostname": "localhost.localdomain", "node_ip": "10.139.239.36", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MatmulEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4096, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f7796fcc220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 24.035399198532104, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 10.9875, "ram_util_percent": 14.8}}
{"timers": {"training_iteration": 4.297436468354563, "restore_env_runners": 2.1845196167296547e-05, "training_step": 4.2972845219868745, "env_runner_sampling_timer": 0.5198631270652073, "learner_update_timer": 3.769167305566609, "synch_weights": 0.0016831346275195964, "synch_env_connectors": 0.0026589680731074023}, "env_runners": {"episode_duration_sec_mean": 0.0006141044541436713, "num_module_steps_sampled": {"default_policy": 4096}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.6340015166921026e-05, "get_actions": 9.32577309955483e-05, "un_batch_to_individual_items": 9.19967078716192e-06, "remove_single_ts_time_rank_from_batch": 9.921040311835126e-07, "listify_data_for_vector_env": 1.5573328169765544e-05, "tensor_to_numpy": 3.1405589515891006e-05}}, "connector_pipeline_timer": 0.0002009998121861484}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 8.744038337450896e-06, "add_time_dim_to_batch_and_zero_pad": 3.1241866067074453e-06, "numpy_to_tensor": 1.8004683625132908e-05, "add_observations_from_episodes_to_batch": 4.1777835257857386e-06, "add_states_from_episodes_to_batch": 1.8687334435743958e-06}}, "connector_pipeline_timer": 5.8540959085535015e-05}, "num_episodes": 2681, "episode_len_min": 1, "time_between_sampling": 0.2455835456803689, "episode_len_mean": 1.71875, "env_step_timer": 2.5024308341788808e-05, "num_episodes_lifetime": 12075, "agent_episode_returns_mean": {"default_agent": 50.98125000000001}, "episode_return_mean": 50.98125000000001, "weights_seq_no": 5.0, "num_env_steps_sampled_lifetime": 24576, "env_reset_timer": 0.00013909503468312323, "sample": 0.08175423071212404, "env_to_module_sum_episodes_length_out": 1.3928930475263268, "env_to_module_sum_episodes_length_in": 1.3928930475263268, "episode_len_max": 5, "rlmodule_inference_timer": 7.138928267783541e-05, "num_env_steps_sampled": 4096, "episode_return_max": 51.8, "num_module_steps_sampled_lifetime": {"default_policy": 24576}, "num_agent_steps_sampled": {"default_agent": 4096}, "episode_return_min": 50.0, "num_agent_steps_sampled_lifetime": {"default_agent": 24576}, "module_episode_returns_mean": {"default_policy": 50.98125000000001}, "num_env_steps_sampled_lifetime_throughput": 732.2952363053538}, "learners": {"default_policy": {"vf_explained_var": 1.7881393432617188e-07, "gradients_default_optimizer_global_norm": 0.5826328992843628, "mean_kl_loss": 0.006804217584431171, "vf_loss_unclipped": 2428.350830078125, "module_train_batch_size_mean": 128.0, "vf_loss": 10.0, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 0.8872358202934265, "num_module_steps_trained": 203648, "num_trainable_parameters": 134148.0, "weights_seq_no": 6.0, "policy_loss": -0.7938306331634521, "total_loss": 9.208210945129395, "curr_entropy_coeff": 0.0, "num_module_steps_trained_lifetime": 1102464, "curr_kl_coeff": 0.30000001192092896}, "__all_modules__": {"num_env_steps_trained": 10799708, "num_module_steps_trained_lifetime": 1102464, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.7863576006859883e-05, "numpy_to_tensor": 0.00016798268351931797, "add_observations_from_episodes_to_batch": 0.005967629568497799, "add_states_from_episodes_to_batch": 5.567897074072376e-06, "batch_individual_items": 0.030566958695969378, "general_advantage_estimation": 0.017794244013753364, "add_columns_from_episodes_to_train_batch": 0.04682714112234744, "add_one_ts_to_episodes_and_truncate": 0.04045620225947767}}, "connector_pipeline_timer": 0.14230725895745144}, "learner_connector_sum_episodes_length_out": 5417.990034376249, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 4096.0, "num_module_steps_trained": 203648, "num_trainable_parameters": 134148.0, "num_env_steps_trained_lifetime": 53040728, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 24576, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 732.2952363053538, "done": false, "training_iteration": 6, "trial_id": "40149_00000", "date": "2025-05-17_14-54-01", "timestamp": 1747461241, "time_this_iter_s": 5.587335109710693, "time_total_s": 29.622734308242798, "pid": 1464251, "hostname": "localhost.localdomain", "node_ip": "10.139.239.36", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MatmulEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4096, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f7796fcc220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 29.622734308242798, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 10.774999999999999, "ram_util_percent": 14.8}}
{"timers": {"training_iteration": 4.30815368079077, "restore_env_runners": 2.170459462378891e-05, "training_step": 4.308001627757962, "env_runner_sampling_timer": 0.5211415526748039, "learner_update_timer": 3.7785255423200814, "synch_weights": 0.001683428281257439, "synch_env_connectors": 0.002671164153365741}, "env_runners": {"episode_duration_sec_mean": 0.0005177245948289055, "num_module_steps_sampled": {"default_policy": 4096}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.577307550140408e-05, "get_actions": 9.134107501425692e-05, "un_batch_to_individual_items": 9.104691198900874e-06, "remove_single_ts_time_rank_from_batch": 9.803147507775473e-07, "listify_data_for_vector_env": 1.540869119168314e-05, "tensor_to_numpy": 3.0393865785168796e-05}}, "connector_pipeline_timer": 0.00019670408689236274}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 8.552221585519919e-06, "add_time_dim_to_batch_and_zero_pad": 3.0718413631219086e-06, "numpy_to_tensor": 1.7751242468733693e-05, "add_observations_from_episodes_to_batch": 4.106594758246841e-06, "add_states_from_episodes_to_batch": 1.8414570639198435e-06}}, "connector_pipeline_timer": 5.731032296956325e-05}, "num_episodes": 2812, "episode_len_min": 1, "time_between_sampling": 0.2771488598618686, "episode_len_mean": 1.4375, "env_step_timer": 2.445956714512743e-05, "num_episodes_lifetime": 14887, "agent_episode_returns_mean": {"default_agent": 50.93124999999999}, "episode_return_mean": 50.93124999999999, "weights_seq_no": 6.0, "num_env_steps_sampled_lifetime": 28672, "env_reset_timer": 0.00013909503468312323, "sample": 0.08207788597009029, "env_to_module_sum_episodes_length_out": 1.245715062140574, "env_to_module_sum_episodes_length_in": 1.245715062140574, "episode_len_max": 4, "rlmodule_inference_timer": 6.778608353849134e-05, "num_env_steps_sampled": 4096, "episode_return_max": 51.2, "num_module_steps_sampled_lifetime": {"default_policy": 28672}, "num_agent_steps_sampled": {"default_agent": 4096}, "episode_return_min": 50.0, "num_agent_steps_sampled_lifetime": {"default_agent": 28672}, "module_episode_returns_mean": {"default_policy": 50.93124999999999}, "num_env_steps_sampled_lifetime_throughput": 760.9256491674267}, "learners": {"default_policy": {"vf_explained_var": 1.1920928955078125e-07, "gradients_default_optimizer_global_norm": 0.3087061643600464, "mean_kl_loss": 0.03155210241675377, "vf_loss_unclipped": 2456.808837890625, "module_train_batch_size_mean": 128.0, "vf_loss": 10.0, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 0.7351049184799194, "num_module_steps_trained": 207616, "num_trainable_parameters": 134148.0, "weights_seq_no": 7.0, "policy_loss": -0.8477185368537903, "total_loss": 9.161746978759766, "curr_entropy_coeff": 0.0, "num_module_steps_trained_lifetime": 1310080, "curr_kl_coeff": 0.45000001788139343}, "__all_modules__": {"num_env_steps_trained": 11220996, "num_module_steps_trained_lifetime": 1310080, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.7862679240301428e-05, "numpy_to_tensor": 0.00016797214260993936, "add_observations_from_episodes_to_batch": 0.005969925306382359, "add_states_from_episodes_to_batch": 5.566985932628566e-06, "batch_individual_items": 0.03060036371550148, "general_advantage_estimation": 0.017796181145870154, "add_columns_from_episodes_to_train_batch": 0.04684742331432587, "add_one_ts_to_episodes_and_truncate": 0.0404720702162699}}, "connector_pipeline_timer": 0.1423810355691847}, "learner_connector_sum_episodes_length_out": 5418.544031173871, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 4096.0, "num_module_steps_trained": 207616, "num_trainable_parameters": 134148.0, "num_env_steps_trained_lifetime": 64261724, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 28672, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 760.9256491674267, "done": false, "training_iteration": 7, "trial_id": "40149_00000", "date": "2025-05-17_14-54-07", "timestamp": 1747461247, "time_this_iter_s": 5.373363733291626, "time_total_s": 34.996098041534424, "pid": 1464251, "hostname": "localhost.localdomain", "node_ip": "10.139.239.36", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MatmulEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4096, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f7796fcc220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 34.996098041534424, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 10.957142857142857, "ram_util_percent": 14.77142857142857}}
{"timers": {"training_iteration": 4.324329749772325, "restore_env_runners": 2.1579318875747193e-05, "training_step": 4.324177337660654, "env_runner_sampling_timer": 0.5234879317080356, "learner_update_timer": 3.7922551449869664, "synch_weights": 0.0016839677582100427, "synch_env_connectors": 0.0026671435018404974}, "env_runners": {"episode_duration_sec_mean": 0.0003877540002577007, "num_module_steps_sampled": {"default_policy": 4096}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.5512563127117395e-05, "get_actions": 9.073959373361987e-05, "un_batch_to_individual_items": 9.132112286516345e-06, "remove_single_ts_time_rank_from_batch": 9.835197158574553e-07, "listify_data_for_vector_env": 1.5462526442059784e-05, "tensor_to_numpy": 2.9921363637982556e-05}}, "connector_pipeline_timer": 0.0001955386761738183}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 8.569518219294302e-06, "add_time_dim_to_batch_and_zero_pad": 3.0621181054095974e-06, "numpy_to_tensor": 1.77355532096663e-05, "add_observations_from_episodes_to_batch": 4.1015633951748e-06, "add_states_from_episodes_to_batch": 1.8438670393335442e-06}}, "connector_pipeline_timer": 5.716823194091235e-05}, "num_episodes": 3237, "episode_len_min": 1, "time_between_sampling": 0.30999498049780766, "episode_len_mean": 1.03125, "env_step_timer": 2.4208338890956285e-05, "num_episodes_lifetime": 18124, "agent_episode_returns_mean": {"default_agent": 51.00625000000001}, "episode_return_mean": 51.00625000000001, "weights_seq_no": 7.0, "num_env_steps_sampled_lifetime": 32768, "env_reset_timer": 0.00013909503468312323, "sample": 0.08247747603450867, "env_to_module_sum_episodes_length_out": 1.098123745256795, "env_to_module_sum_episodes_length_in": 1.098123745256795, "episode_len_max": 2, "rlmodule_inference_timer": 6.575053914524233e-05, "num_env_steps_sampled": 4096, "episode_return_max": 51.2, "num_module_steps_sampled_lifetime": {"default_policy": 32768}, "num_agent_steps_sampled": {"default_agent": 4096}, "episode_return_min": 51.0, "num_agent_steps_sampled_lifetime": {"default_agent": 32768}, "module_episode_returns_mean": {"default_policy": 51.00625000000001}, "num_env_steps_sampled_lifetime_throughput": 689.8838464040294}, "learners": {"default_policy": {"vf_explained_var": 0.0, "gradients_default_optimizer_global_norm": 0.7105913758277893, "mean_kl_loss": 0.01774514466524124, "vf_loss_unclipped": 2533.02734375, "module_train_batch_size_mean": 128.0, "vf_loss": 10.0, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 0.5943198204040527, "num_module_steps_trained": 220288, "num_trainable_parameters": 134148.0, "weights_seq_no": 8.0, "policy_loss": -0.9350670576095581, "total_loss": 9.072916984558105, "curr_entropy_coeff": 0.0, "num_module_steps_trained_lifetime": 1530368, "curr_kl_coeff": 0.45000001788139343}, "__all_modules__": {"num_env_steps_trained": 12635582, "num_module_steps_trained_lifetime": 1530368, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.7861657044193464e-05, "numpy_to_tensor": 0.00016796157824148106, "add_observations_from_episodes_to_batch": 0.0059730311617589476, "add_states_from_episodes_to_batch": 5.565890918508766e-06, "batch_individual_items": 0.030649820019170763, "general_advantage_estimation": 0.01779872398835196, "add_columns_from_episodes_to_train_batch": 0.04686964019805723, "add_one_ts_to_episodes_and_truncate": 0.04049327390020475}}, "connector_pipeline_timer": 0.1424795392679871}, "learner_connector_sum_episodes_length_out": 5419.279349032104, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 4096.0, "num_module_steps_trained": 220288, "num_trainable_parameters": 134148.0, "num_env_steps_trained_lifetime": 76897306, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 32768, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 689.8838464040294, "done": false, "training_iteration": 8, "trial_id": "40149_00000", "date": "2025-05-17_14-54-13", "timestamp": 1747461253, "time_this_iter_s": 5.930157899856567, "time_total_s": 40.92625594139099, "pid": 1464251, "hostname": "localhost.localdomain", "node_ip": "10.139.239.36", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MatmulEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4096, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f7796fcc220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 40.92625594139099, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 11.199999999999998, "ram_util_percent": 14.800000000000002}}
{"timers": {"training_iteration": 4.34037569657389, "restore_env_runners": 2.14594065101996e-05, "training_step": 4.340222921353599, "env_runner_sampling_timer": 0.525545482581092, "learner_update_timer": 3.8061377541869157, "synch_weights": 0.0016864906599606067, "synch_env_connectors": 0.002662593697431128}, "env_runners": {"episode_duration_sec_mean": 0.00045594005860039033, "num_module_steps_sampled": {"default_policy": 4096}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.5200063365342455e-05, "get_actions": 8.971596591520549e-05, "un_batch_to_individual_items": 9.077052789800603e-06, "remove_single_ts_time_rank_from_batch": 9.751460744327267e-07, "listify_data_for_vector_env": 1.535352841637481e-05, "tensor_to_numpy": 2.935369182966343e-05}}, "connector_pipeline_timer": 0.0001931424681352534}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 8.446822787274792e-06, "add_time_dim_to_batch_and_zero_pad": 3.03118687320005e-06, "numpy_to_tensor": 1.758816005801559e-05, "add_observations_from_episodes_to_batch": 4.059834529029594e-06, "add_states_from_episodes_to_batch": 1.8272522023708498e-06}}, "connector_pipeline_timer": 5.644279887975874e-05}, "num_episodes": 3476, "episode_len_min": 1, "time_between_sampling": 0.3443619482172267, "episode_len_mean": 1.28125, "env_step_timer": 2.3816572883765678e-05, "num_episodes_lifetime": 21600, "agent_episode_returns_mean": {"default_agent": 50.90625}, "episode_return_mean": 50.90625, "weights_seq_no": 8.0, "num_env_steps_sampled_lifetime": 36864, "env_reset_timer": 0.00013909503468312323, "sample": 0.08296169922604058, "env_to_module_sum_episodes_length_out": 0.9720314539784034, "env_to_module_sum_episodes_length_in": 0.9720314539784034, "episode_len_max": 3, "rlmodule_inference_timer": 6.392562904807027e-05, "num_env_steps_sampled": 4096, "episode_return_max": 51.0, "num_module_steps_sampled_lifetime": {"default_policy": 36864}, "num_agent_steps_sampled": {"default_agent": 4096}, "episode_return_min": 49.0, "num_agent_steps_sampled_lifetime": {"default_agent": 36864}, "module_episode_returns_mean": {"default_policy": 50.90625}, "num_env_steps_sampled_lifetime_throughput": 689.5158436989102}, "learners": {"default_policy": {"vf_explained_var": -2.384185791015625e-07, "gradients_default_optimizer_global_norm": 0.23259243369102478, "mean_kl_loss": 0.016826944425702095, "vf_loss_unclipped": 2566.101318359375, "module_train_batch_size_mean": 128.0, "vf_loss": 10.0, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 0.44012850522994995, "num_module_steps_trained": 227328, "num_trainable_parameters": 134148.0, "weights_seq_no": 9.0, "policy_loss": -0.9525282979011536, "total_loss": 9.055045127868652, "curr_entropy_coeff": 0.0, "num_module_steps_trained_lifetime": 1757696, "curr_kl_coeff": 0.45000001788139343}, "__all_modules__": {"num_env_steps_trained": 13451424, "num_module_steps_trained_lifetime": 1757696, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.7860595323607937e-05, "numpy_to_tensor": 0.0001679491644494936, "add_observations_from_episodes_to_batch": 0.005976977208599379, "add_states_from_episodes_to_batch": 5.564617697850387e-06, "batch_individual_items": 0.03070006411799415, "general_advantage_estimation": 0.01780189811606964, "add_columns_from_episodes_to_train_batch": 0.04689382725798138, "add_one_ts_to_episodes_and_truncate": 0.04052032449823467}}, "connector_pipeline_timer": 0.14258810868505664}, "learner_connector_sum_episodes_length_out": 5420.215506130054, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 4096.0, "num_module_steps_trained": 227328, "num_trainable_parameters": 134148.0, "num_env_steps_trained_lifetime": 90348730, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 36864, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 689.5158436989102, "done": false, "training_iteration": 9, "trial_id": "40149_00000", "date": "2025-05-17_14-54-18", "timestamp": 1747461258, "time_this_iter_s": 5.9331018924713135, "time_total_s": 46.859357833862305, "pid": 1464251, "hostname": "localhost.localdomain", "node_ip": "10.139.239.36", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MatmulEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4096, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f7796fcc220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 46.859357833862305, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 11.15, "ram_util_percent": 14.8}}
{"timers": {"training_iteration": 4.359869897438143, "restore_env_runners": 2.1319441651307977e-05, "training_step": 4.359716770459818, "env_runner_sampling_timer": 0.5290423637951874, "learner_update_timer": 3.8220219578048336, "synch_weights": 0.0016868690639373054, "synch_env_connectors": 0.002658749520655812}, "env_runners": {"episode_duration_sec_mean": 0.0003893811190209817, "num_module_steps_sampled": {"default_policy": 4096}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.4986339426716048e-05, "get_actions": 8.902686482594828e-05, "un_batch_to_individual_items": 9.04723733558789e-06, "remove_single_ts_time_rank_from_batch": 9.71105438624494e-07, "listify_data_for_vector_env": 1.5286780901393844e-05, "tensor_to_numpy": 2.898250977550428e-05}}, "connector_pipeline_timer": 0.00019156958751486545}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 8.375927887398913e-06, "add_time_dim_to_batch_and_zero_pad": 3.010316403842816e-06, "numpy_to_tensor": 1.7501108487370143e-05, "add_observations_from_episodes_to_batch": 4.037225901305425e-06, "add_states_from_episodes_to_batch": 1.8163323048514313e-06}}, "connector_pipeline_timer": 5.6006660856356894e-05}, "num_episodes": 3706, "episode_len_min": 1, "time_between_sampling": 0.3797007444296392, "episode_len_mean": 1.0625, "env_step_timer": 2.3516014124499408e-05, "num_episodes_lifetime": 25306, "agent_episode_returns_mean": {"default_agent": 51.00625000000001}, "episode_return_mean": 51.00625000000001, "weights_seq_no": 9.0, "num_env_steps_sampled_lifetime": 40960, "env_reset_timer": 0.00013909503468312323, "sample": 0.08352994997547245, "env_to_module_sum_episodes_length_out": 0.8641428387537416, "env_to_module_sum_episodes_length_in": 0.8641428387537416, "episode_len_max": 2, "rlmodule_inference_timer": 6.258770356774741e-05, "num_env_steps_sampled": 4096, "episode_return_max": 51.2, "num_module_steps_sampled_lifetime": {"default_policy": 40960}, "num_agent_steps_sampled": {"default_agent": 4096}, "episode_return_min": 51.0, "num_agent_steps_sampled_lifetime": {"default_agent": 40960}, "module_episode_returns_mean": {"default_policy": 51.00625000000001}, "num_env_steps_sampled_lifetime_throughput": 650.0477002676048}, "learners": {"default_policy": {"vf_explained_var": -1.1920928955078125e-07, "gradients_default_optimizer_global_norm": 0.6402618885040283, "mean_kl_loss": 0.010262741707265377, "vf_loss_unclipped": 2537.781005859375, "module_train_batch_size_mean": 128.0, "vf_loss": 10.0, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 0.34618714451789856, "num_module_steps_trained": 234240, "num_trainable_parameters": 134148.0, "weights_seq_no": 10.0, "policy_loss": -0.9386937618255615, "total_loss": 9.065924644470215, "curr_entropy_coeff": 0.0, "num_module_steps_trained_lifetime": 1991936, "curr_kl_coeff": 0.45000001788139343}, "__all_modules__": {"num_env_steps_trained": 14286810, "num_module_steps_trained_lifetime": 1991936, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.7859276471336472e-05, "numpy_to_tensor": 0.00016793604036992286, "add_observations_from_episodes_to_batch": 0.005981850551082171, "add_states_from_episodes_to_batch": 5.563208151794237e-06, "batch_individual_items": 0.03075150263883757, "general_advantage_estimation": 0.017805816797631564, "add_columns_from_episodes_to_train_batch": 0.04692027311578956, "add_one_ts_to_episodes_and_truncate": 0.040553745295820495}}, "connector_pipeline_timer": 0.14270820148155502}, "learner_connector_sum_episodes_length_out": 5421.371712151142, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 4096.0, "num_module_steps_trained": 234240, "num_trainable_parameters": 134148.0, "num_env_steps_trained_lifetime": 104635540, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 40960, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 650.0477002676048, "done": false, "training_iteration": 10, "trial_id": "40149_00000", "date": "2025-05-17_14-54-25", "timestamp": 1747461265, "time_this_iter_s": 6.294156312942505, "time_total_s": 53.15351414680481, "pid": 1464251, "hostname": "localhost.localdomain", "node_ip": "10.139.239.36", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MatmulEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4096, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f7796fcc220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 53.15351414680481, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 11.022222222222222, "ram_util_percent": 14.800000000000002}}
{"timers": {"training_iteration": 4.382457824103437, "restore_env_runners": 2.1198027910370036e-05, "training_step": 4.3823042648258115, "env_runner_sampling_timer": 0.5324652924765544, "learner_update_timer": 3.841089913956121, "synch_weights": 0.0016866881534509386, "synch_env_connectors": 0.0026547493254946695}, "env_runners": {"episode_duration_sec_mean": 0.0004074410244356841, "num_module_steps_sampled": {"default_policy": 4096}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.5286439630815045e-05, "get_actions": 9.099200590939178e-05, "un_batch_to_individual_items": 9.295977023709293e-06, "remove_single_ts_time_rank_from_batch": 1.0064879044321318e-06, "listify_data_for_vector_env": 1.574505075599808e-05, "tensor_to_numpy": 2.9511266681657913e-05}}, "connector_pipeline_timer": 0.00019631340024133786}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 8.740416787092035e-06, "add_time_dim_to_batch_and_zero_pad": 3.094858478064258e-06, "numpy_to_tensor": 1.7972357360548925e-05, "add_observations_from_episodes_to_batch": 4.16383365434401e-06, "add_states_from_episodes_to_batch": 1.8747925813644244e-06}}, "connector_pipeline_timer": 5.789154370913599e-05}, "num_episodes": 3791, "episode_len_min": 1, "time_between_sampling": 0.4160900094326352, "episode_len_mean": 1.125, "env_step_timer": 2.396228571304279e-05, "num_episodes_lifetime": 29097, "agent_episode_returns_mean": {"default_agent": 50.98125000000001}, "episode_return_mean": 50.98125000000001, "weights_seq_no": 10.0, "num_env_steps_sampled_lifetime": 45056, "env_reset_timer": 0.00013909503468312323, "sample": 0.08427875468662718, "env_to_module_sum_episodes_length_out": 0.7822365358799442, "env_to_module_sum_episodes_length_in": 0.7822365358799442, "episode_len_max": 2, "rlmodule_inference_timer": 6.350576998943091e-05, "num_env_steps_sampled": 4096, "episode_return_max": 51.2, "num_module_steps_sampled_lifetime": {"default_policy": 45056}, "num_agent_steps_sampled": {"default_agent": 4096}, "episode_return_min": 50.0, "num_agent_steps_sampled_lifetime": {"default_agent": 45056}, "module_episode_returns_mean": {"default_policy": 50.98125000000001}, "num_env_steps_sampled_lifetime_throughput": 617.7796307079145}, "learners": {"default_policy": {"vf_explained_var": -2.384185791015625e-07, "gradients_default_optimizer_global_norm": 0.8738734722137451, "mean_kl_loss": 0.0001246312167495489, "vf_loss_unclipped": 2547.409423828125, "module_train_batch_size_mean": 128.0, "vf_loss": 10.0, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 0.3363838493824005, "num_module_steps_trained": 236672, "num_trainable_parameters": 134148.0, "weights_seq_no": 11.0, "policy_loss": -0.9589977264404297, "total_loss": 9.041058540344238, "curr_entropy_coeff": 0.0, "num_module_steps_trained_lifetime": 2228608, "curr_kl_coeff": 0.22500000894069672}, "__all_modules__": {"num_env_steps_trained": 14586761, "num_module_steps_trained_lifetime": 2228608, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.7857884037891755e-05, "numpy_to_tensor": 0.00016792220845794972, "add_observations_from_episodes_to_batch": 0.006002611964393312, "add_states_from_episodes_to_batch": 5.561645029244257e-06, "batch_individual_items": 0.030819666199656072, "general_advantage_estimation": 0.01781041971625349, "add_columns_from_episodes_to_train_batch": 0.04694910857611598, "add_one_ts_to_episodes_and_truncate": 0.040593674844804487}}, "connector_pipeline_timer": 0.14287051779695886}, "learner_connector_sum_episodes_length_out": 5422.751672501195, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 4096.0, "num_module_steps_trained": 236672, "num_trainable_parameters": 134148.0, "num_env_steps_trained_lifetime": 119222301, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 45056, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 617.7796307079145, "done": false, "training_iteration": 11, "trial_id": "40149_00000", "date": "2025-05-17_14-54-31", "timestamp": 1747461271, "time_this_iter_s": 6.624406576156616, "time_total_s": 59.777920722961426, "pid": 1464251, "hostname": "localhost.localdomain", "node_ip": "10.139.239.36", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MatmulEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4096, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f7796fcc220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 59.777920722961426, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 11.455555555555556, "ram_util_percent": 14.800000000000002}}
{"timers": {"training_iteration": 4.4031325130216645, "restore_env_runners": 2.106749761118255e-05, "training_step": 4.402978579367675, "env_runner_sampling_timer": 0.5354188103420793, "learner_update_timer": 3.8586954960163276, "synch_weights": 0.0016873314820803206, "synch_env_connectors": 0.0026672977725409174}, "env_runners": {"episode_duration_sec_mean": 0.00040574048398411833, "num_module_steps_sampled": {"default_policy": 4096}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.5081132512344857e-05, "get_actions": 9.009012677450799e-05, "un_batch_to_individual_items": 9.219095051495374e-06, "remove_single_ts_time_rank_from_batch": 9.956846584011445e-07, "listify_data_for_vector_env": 1.5601312026319715e-05, "tensor_to_numpy": 2.9140336039160523e-05}}, "connector_pipeline_timer": 0.00019422529753484487}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 8.610192663985742e-06, "add_time_dim_to_batch_and_zero_pad": 3.0606529985824924e-06, "numpy_to_tensor": 1.779886317625357e-05, "add_observations_from_episodes_to_batch": 4.1241797160018965e-06, "add_states_from_episodes_to_batch": 1.85237653791057e-06}}, "connector_pipeline_timer": 5.715323139690415e-05}, "num_episodes": 3832, "episode_len_min": 1, "time_between_sampling": 0.45332735698483495, "episode_len_mean": 1.125, "env_step_timer": 2.3634163068606345e-05, "num_episodes_lifetime": 32929, "agent_episode_returns_mean": {"default_agent": 51.00625000000001}, "episode_return_mean": 51.00625000000001, "weights_seq_no": 11.0, "num_env_steps_sampled_lifetime": 49152, "env_reset_timer": 0.00013909503468312323, "sample": 0.08513081766585236, "env_to_module_sum_episodes_length_out": 0.719473137668047, "env_to_module_sum_episodes_length_in": 0.719473137668047, "episode_len_max": 2, "rlmodule_inference_timer": 6.244486185019539e-05, "num_env_steps_sampled": 4096, "episode_return_max": 51.2, "num_module_steps_sampled_lifetime": {"default_policy": 49152}, "num_agent_steps_sampled": {"default_agent": 4096}, "episode_return_min": 51.0, "num_agent_steps_sampled_lifetime": {"default_agent": 49152}, "module_episode_returns_mean": {"default_policy": 51.00625000000001}, "num_env_steps_sampled_lifetime_throughput": 633.6471508959802}, "learners": {"default_policy": {"vf_explained_var": -1.1920928955078125e-07, "gradients_default_optimizer_global_norm": 0.4435838460922241, "mean_kl_loss": 0.004004685208201408, "vf_loss_unclipped": 2569.806396484375, "module_train_batch_size_mean": 128.0, "vf_loss": 10.0, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 0.2648365795612335, "num_module_steps_trained": 238080, "num_trainable_parameters": 134148.0, "weights_seq_no": 12.0, "policy_loss": -0.9824659824371338, "total_loss": 9.018436431884766, "curr_entropy_coeff": 0.0, "num_module_steps_trained_lifetime": 2466688, "curr_kl_coeff": 0.11250000447034836}, "__all_modules__": {"num_env_steps_trained": 14755380, "num_module_steps_trained_lifetime": 2466688, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.7856285423199476e-05, "numpy_to_tensor": 0.00016790716208319492, "add_observations_from_episodes_to_batch": 0.00602403441458364, "add_states_from_episodes_to_batch": 5.5599376428477935e-06, "batch_individual_items": 0.030905535961384945, "general_advantage_estimation": 0.01781582502242138, "add_columns_from_episodes_to_train_batch": 0.04698020523262718, "add_one_ts_to_episodes_and_truncate": 0.040640070750274516}}, "connector_pipeline_timer": 0.14306073535420988}, "learner_connector_sum_episodes_length_out": 5424.355196473032, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 4096.0, "num_module_steps_trained": 238080, "num_trainable_parameters": 134148.0, "num_env_steps_trained_lifetime": 133977681, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 49152, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 633.6471508959802, "done": false, "training_iteration": 12, "trial_id": "40149_00000", "date": "2025-05-17_14-54-38", "timestamp": 1747461278, "time_this_iter_s": 6.454269886016846, "time_total_s": 66.23219060897827, "pid": 1464251, "hostname": "localhost.localdomain", "node_ip": "10.139.239.36", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MatmulEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4096, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f7796fcc220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 66.23219060897827, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 11.255555555555555, "ram_util_percent": 14.800000000000002}}
{"timers": {"training_iteration": 4.4240520415218825, "restore_env_runners": 2.0952993332431953e-05, "training_step": 4.423897753064282, "env_runner_sampling_timer": 0.5383991746689734, "learner_update_timer": 3.876502358706551, "synch_weights": 0.0016884742276081174, "synch_env_connectors": 0.0026644523045372495}, "env_runners": {"episode_duration_sec_mean": 0.0003604095836635679, "num_module_steps_sampled": {"default_policy": 4096}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.4941746919570408e-05, "get_actions": 8.949870123351164e-05, "un_batch_to_individual_items": 9.176192995480174e-06, "remove_single_ts_time_rank_from_batch": 9.902404360439305e-07, "listify_data_for_vector_env": 1.5514787190207696e-05, "tensor_to_numpy": 2.8896342014889157e-05}}, "connector_pipeline_timer": 0.00019291153155724712}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 8.54532861295124e-06, "add_time_dim_to_batch_and_zero_pad": 3.040384088798173e-06, "numpy_to_tensor": 1.770645671280161e-05, "add_observations_from_episodes_to_batch": 4.097387140963113e-06, "add_states_from_episodes_to_batch": 1.841370747541261e-06}}, "connector_pipeline_timer": 5.6757599999215194e-05}, "num_episodes": 3882, "episode_len_min": 1, "time_between_sampling": 0.4907384147001417, "episode_len_mean": 1.0, "env_step_timer": 2.3418114637969905e-05, "num_episodes_lifetime": 36811, "agent_episode_returns_mean": {"default_agent": 51.0}, "episode_return_mean": 51.0, "weights_seq_no": 12.0, "num_env_steps_sampled_lifetime": 53248, "env_reset_timer": 0.00013909503468312323, "sample": 0.08601471252673185, "env_to_module_sum_episodes_length_out": 0.6708461206352185, "env_to_module_sum_episodes_length_in": 0.6708461206352185, "episode_len_max": 1, "rlmodule_inference_timer": 6.17949768307741e-05, "num_env_steps_sampled": 4096, "episode_return_max": 51.0, "num_module_steps_sampled_lifetime": {"default_policy": 53248}, "num_agent_steps_sampled": {"default_agent": 4096}, "episode_return_min": 51.0, "num_agent_steps_sampled_lifetime": {"default_agent": 53248}, "module_episode_returns_mean": {"default_policy": 51.0}, "num_env_steps_sampled_lifetime_throughput": 629.4332955071824}, "learners": {"default_policy": {"vf_explained_var": -1.1920928955078125e-07, "gradients_default_optimizer_global_norm": 0.15761439502239227, "mean_kl_loss": 0.007204342167824507, "vf_loss_unclipped": 2578.20068359375, "module_train_batch_size_mean": 128.0, "vf_loss": 10.0, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 0.1837591975927353, "num_module_steps_trained": 239488, "num_trainable_parameters": 134148.0, "weights_seq_no": 13.0, "policy_loss": -0.9839162230491638, "total_loss": 9.01689338684082, "curr_entropy_coeff": 0.0, "num_module_steps_trained_lifetime": 2706176, "curr_kl_coeff": 0.11250000447034836}, "__all_modules__": {"num_env_steps_trained": 14934322, "num_module_steps_trained_lifetime": 2706176, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.7854720386682458e-05, "numpy_to_tensor": 0.000167891226512936, "add_observations_from_episodes_to_batch": 0.0060461191256683715, "add_states_from_episodes_to_batch": 5.55811004715962e-06, "batch_individual_items": 0.031008183711856638, "general_advantage_estimation": 0.017822013739505548, "add_columns_from_episodes_to_train_batch": 0.04701373172185539, "add_one_ts_to_episodes_and_truncate": 0.040692886617545915}}, "connector_pipeline_timer": 0.1432780366694345}, "learner_connector_sum_episodes_length_out": 5426.182574798182, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 4096.0, "num_module_steps_trained": 239488, "num_trainable_parameters": 134148.0, "num_env_steps_trained_lifetime": 148912003, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 53248, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 629.4332955071824, "done": false, "training_iteration": 13, "trial_id": "40149_00000", "date": "2025-05-17_14-54-44", "timestamp": 1747461284, "time_this_iter_s": 6.499362945556641, "time_total_s": 72.73155355453491, "pid": 1464251, "hostname": "localhost.localdomain", "node_ip": "10.139.239.36", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MatmulEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4096, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f7796fcc220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 72.73155355453491, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 10.499999999999998, "ram_util_percent": 14.800000000000002}}
{"timers": {"training_iteration": 4.444122330087035, "restore_env_runners": 2.0849163854713617e-05, "training_step": 4.4439675267637675, "env_runner_sampling_timer": 0.541805511852183, "learner_update_timer": 3.8930372061094696, "synch_weights": 0.001688596465820113, "synch_env_connectors": 0.0026600885111004876}, "env_runners": {"episode_duration_sec_mean": 0.0003524592721078079, "num_module_steps_sampled": {"default_policy": 4096}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.4920183992296423e-05, "get_actions": 8.950684778567347e-05, "un_batch_to_individual_items": 9.189477965823614e-06, "remove_single_ts_time_rank_from_batch": 9.936090616369932e-07, "listify_data_for_vector_env": 1.5541253517195303e-05, "tensor_to_numpy": 2.8858481677452096e-05}}, "connector_pipeline_timer": 0.00019297726907505644}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 8.56123160049962e-06, "add_time_dim_to_batch_and_zero_pad": 3.044752423115828e-06, "numpy_to_tensor": 1.773254063767417e-05, "add_observations_from_episodes_to_batch": 4.102706835593791e-06, "add_states_from_episodes_to_batch": 1.8452891546101176e-06}}, "connector_pipeline_timer": 5.683354402304499e-05}, "num_episodes": 3961, "episode_len_min": 1, "time_between_sampling": 0.5278660705197596, "episode_len_mean": 1.0, "env_step_timer": 2.336719512492063e-05, "num_episodes_lifetime": 40772, "agent_episode_returns_mean": {"default_agent": 51.0}, "episode_return_mean": 51.0, "weights_seq_no": 13.0, "num_env_steps_sampled_lifetime": 57344, "env_reset_timer": 0.00013909503468312323, "sample": 0.08690798299366326, "env_to_module_sum_episodes_length_out": 0.6316680632188001, "env_to_module_sum_episodes_length_in": 0.6316680632188001, "episode_len_max": 1, "rlmodule_inference_timer": 6.166886543780304e-05, "num_env_steps_sampled": 4096, "episode_return_max": 51.0, "num_module_steps_sampled_lifetime": {"default_policy": 57344}, "num_agent_steps_sampled": {"default_agent": 4096}, "episode_return_min": 51.0, "num_agent_steps_sampled_lifetime": {"default_agent": 57344}, "module_episode_returns_mean": {"default_policy": 51.0}, "num_env_steps_sampled_lifetime_throughput": 635.7469286457008}, "learners": {"default_policy": {"vf_explained_var": 0.0, "gradients_default_optimizer_global_norm": 0.22353412210941315, "mean_kl_loss": 0.006012927740812302, "vf_loss_unclipped": 2622.605712890625, "module_train_batch_size_mean": 128.0, "vf_loss": 10.0, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 0.11454039812088013, "num_module_steps_trained": 241792, "num_trainable_parameters": 134148.0, "weights_seq_no": 14.0, "policy_loss": -0.9985782504081726, "total_loss": 9.002098083496094, "curr_entropy_coeff": 0.0, "num_module_steps_trained_lifetime": 2947968, "curr_kl_coeff": 0.11250000447034836}, "__all_modules__": {"num_env_steps_trained": 15223451, "num_module_steps_trained_lifetime": 2947968, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.7853882729259568e-05, "numpy_to_tensor": 0.00016787392013551525, "add_observations_from_episodes_to_batch": 0.006068882117885917, "add_states_from_episodes_to_batch": 5.556142709834596e-06, "batch_individual_items": 0.03111090408472121, "general_advantage_estimation": 0.017828975052849347, "add_columns_from_episodes_to_train_batch": 0.04704961362508417, "add_one_ts_to_episodes_and_truncate": 0.04075215821520089}}, "connector_pipeline_timer": 0.14350568571741773}, "learner_connector_sum_episodes_length_out": 5428.236870037183, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 4096.0, "num_module_steps_trained": 241792, "num_trainable_parameters": 134148.0, "num_env_steps_trained_lifetime": 164135454, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 57344, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 635.7469286457008, "done": false, "training_iteration": 14, "trial_id": "40149_00000", "date": "2025-05-17_14-54-51", "timestamp": 1747461291, "time_this_iter_s": 6.435333490371704, "time_total_s": 79.16688704490662, "pid": 1464251, "hostname": "localhost.localdomain", "node_ip": "10.139.239.36", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MatmulEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4096, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f7796fcc220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 79.16688704490662, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 11.28888888888889, "ram_util_percent": 14.800000000000002}}
{"timers": {"training_iteration": 4.466821739846063, "restore_env_runners": 2.0730941820864305e-05, "training_step": 4.466666482716571, "env_runner_sampling_timer": 0.5458472657042299, "learner_update_timer": 3.911573429298091, "synch_weights": 0.0016927707406855612, "synch_env_connectors": 0.0026564581454837483}, "env_runners": {"episode_duration_sec_mean": 0.0003552601774572395, "num_module_steps_sampled": {"default_policy": 4096}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.4688862591097914e-05, "get_actions": 8.837601678826131e-05, "un_batch_to_individual_items": 9.067965631167813e-06, "remove_single_ts_time_rank_from_batch": 9.747296121854242e-07, "listify_data_for_vector_env": 1.5321377735928912e-05, "tensor_to_numpy": 2.845759199668132e-05}}, "connector_pipeline_timer": 0.00019024120852012194}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 8.364501071038473e-06, "add_time_dim_to_batch_and_zero_pad": 3.000179042106344e-06, "numpy_to_tensor": 1.749678249746877e-05, "add_observations_from_episodes_to_batch": 4.041936456505164e-06, "add_states_from_episodes_to_batch": 1.8133396986124521e-06}}, "connector_pipeline_timer": 5.580187967593121e-05}, "num_episodes": 4019, "episode_len_min": 1, "time_between_sampling": 0.56443739828824, "episode_len_mean": 1.0, "env_step_timer": 2.2995773674328232e-05, "num_episodes_lifetime": 44791, "agent_episode_returns_mean": {"default_agent": 51.0}, "episode_return_mean": 51.0, "weights_seq_no": 14.0, "num_env_steps_sampled_lifetime": 61440, "env_reset_timer": 0.00013909503468312323, "sample": 0.08781709049178478, "env_to_module_sum_episodes_length_out": 0.6001948818993397, "env_to_module_sum_episodes_length_in": 0.6001948818993397, "episode_len_max": 1, "rlmodule_inference_timer": 6.66038230887735e-05, "num_env_steps_sampled": 4096, "episode_return_max": 51.0, "num_module_steps_sampled_lifetime": {"default_policy": 61440}, "num_agent_steps_sampled": {"default_agent": 4096}, "episode_return_min": 51.0, "num_agent_steps_sampled_lifetime": {"default_agent": 61440}, "module_episode_returns_mean": {"default_policy": 51.0}, "num_env_steps_sampled_lifetime_throughput": 608.9852009905383}, "learners": {"default_policy": {"vf_explained_var": 0.0, "gradients_default_optimizer_global_norm": 0.09639426320791245, "mean_kl_loss": 0.0014824243262410164, "vf_loss_unclipped": 2623.439453125, "module_train_batch_size_mean": 128.0, "vf_loss": 10.0, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 0.08802591264247894, "num_module_steps_trained": 243456, "num_trainable_parameters": 134148.0, "weights_seq_no": 15.0, "policy_loss": -0.9890852570533752, "total_loss": 9.01108169555664, "curr_entropy_coeff": 0.0, "num_module_steps_trained_lifetime": 3191424, "curr_kl_coeff": 0.05625000223517418}, "__all_modules__": {"num_env_steps_trained": 15434730, "num_module_steps_trained_lifetime": 3191424, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.78530887532428e-05, "numpy_to_tensor": 0.00016785552845851158, "add_observations_from_episodes_to_batch": 0.00609236739984452, "add_states_from_episodes_to_batch": 5.554059609789084e-06, "batch_individual_items": 0.031230438131855307, "general_advantage_estimation": 0.01783670603115057, "add_columns_from_episodes_to_train_batch": 0.04708798353027547, "add_one_ts_to_episodes_and_truncate": 0.04081798725714323}}, "connector_pipeline_timer": 0.14376072585067545}, "learner_connector_sum_episodes_length_out": 5430.518961113923, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 4096.0, "num_module_steps_trained": 243456, "num_trainable_parameters": 134148.0, "num_env_steps_trained_lifetime": 179570184, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 61440, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 608.9852009905383, "done": false, "training_iteration": 15, "trial_id": "40149_00000", "date": "2025-05-17_14-54-58", "timestamp": 1747461298, "time_this_iter_s": 6.718361139297485, "time_total_s": 85.8852481842041, "pid": 1464251, "hostname": "localhost.localdomain", "node_ip": "10.139.239.36", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MatmulEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4096, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f7796fcc220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 85.8852481842041, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 11.233333333333336, "ram_util_percent": 14.800000000000002}}
{"timers": {"training_iteration": 4.487234240286903, "restore_env_runners": 2.061059231975395e-05, "training_step": 4.487078554928989, "env_runner_sampling_timer": 0.5490900174080354, "learner_update_timer": 3.9286171264656566, "synch_weights": 0.0016950216635971981, "synch_env_connectors": 0.002651997463420279}, "env_runners": {"episode_duration_sec_mean": 0.0003500147577142343, "num_module_steps_sampled": {"default_policy": 4096}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.4803034493520303e-05, "get_actions": 8.914942099445856e-05, "un_batch_to_individual_items": 9.157872004647893e-06, "remove_single_ts_time_rank_from_batch": 9.862926582961922e-07, "listify_data_for_vector_env": 1.5484804307381303e-05, "tensor_to_numpy": 2.868913064141296e-05}}, "connector_pipeline_timer": 0.00019205662495054603}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 8.497322694297707e-06, "add_time_dim_to_batch_and_zero_pad": 3.030897272108913e-06, "numpy_to_tensor": 1.7666460433401946e-05, "add_observations_from_episodes_to_batch": 4.086863623423994e-06, "add_states_from_episodes_to_batch": 1.8390753182333965e-06}}, "connector_pipeline_timer": 5.6513278433470974e-05}, "num_episodes": 4061, "episode_len_min": 1, "time_between_sampling": 0.6006031254351174, "episode_len_mean": 1.0, "env_step_timer": 2.3158912623941534e-05, "num_episodes_lifetime": 48852, "agent_episode_returns_mean": {"default_agent": 51.0}, "episode_return_mean": 51.0, "weights_seq_no": 15.0, "num_env_steps_sampled_lifetime": 65536, "env_reset_timer": 0.00013909503468312323, "sample": 0.0887795102668954, "env_to_module_sum_episodes_length_out": 0.5751497317180175, "env_to_module_sum_episodes_length_in": 0.5751497317180175, "episode_len_max": 1, "rlmodule_inference_timer": 6.570964798078515e-05, "num_env_steps_sampled": 4096, "episode_return_max": 51.0, "num_module_steps_sampled_lifetime": {"default_policy": 65536}, "num_agent_steps_sampled": {"default_agent": 4096}, "episode_return_min": 51.0, "num_agent_steps_sampled_lifetime": {"default_agent": 65536}, "module_episode_returns_mean": {"default_policy": 51.0}, "num_env_steps_sampled_lifetime_throughput": 628.2174967760673}, "learners": {"default_policy": {"vf_explained_var": -1.1920928955078125e-07, "gradients_default_optimizer_global_norm": 0.0509372316300869, "mean_kl_loss": 0.015021261759102345, "vf_loss_unclipped": 2623.046875, "module_train_batch_size_mean": 128.0, "vf_loss": 10.0, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 0.023938672617077827, "num_module_steps_trained": 244736, "num_trainable_parameters": 134148.0, "weights_seq_no": 16.0, "policy_loss": -0.9818440079689026, "total_loss": 9.019000053405762, "curr_entropy_coeff": 0.0, "num_module_steps_trained_lifetime": 3436160, "curr_kl_coeff": 0.05625000223517418}, "__all_modules__": {"num_env_steps_trained": 15596184, "num_module_steps_trained_lifetime": 3436160, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.7852361661967597e-05, "numpy_to_tensor": 0.00016783711781357338, "add_observations_from_episodes_to_batch": 0.006116498576958514, "add_states_from_episodes_to_batch": 5.551879359250237e-06, "batch_individual_items": 0.03135014472054226, "general_advantage_estimation": 0.017845283387280253, "add_columns_from_episodes_to_train_batch": 0.047128783229104514, "add_one_ts_to_episodes_and_truncate": 0.040890293141925084}}, "connector_pipeline_timer": 0.1440263518083043}, "learner_connector_sum_episodes_length_out": 5433.028286682125, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 4096.0, "num_module_steps_trained": 244736, "num_trainable_parameters": 134148.0, "num_env_steps_trained_lifetime": 195166368, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 65536, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 628.2174967760673, "done": false, "training_iteration": 16, "trial_id": "40149_00000", "date": "2025-05-17_14-55-04", "timestamp": 1747461304, "time_this_iter_s": 6.512941122055054, "time_total_s": 92.39818930625916, "pid": 1464251, "hostname": "localhost.localdomain", "node_ip": "10.139.239.36", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MatmulEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4096, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f7796fcc220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 92.39818930625916, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 11.966666666666667, "ram_util_percent": 14.800000000000002}}
{"timers": {"training_iteration": 4.508661206343309, "restore_env_runners": 2.049194573538533e-05, "training_step": 4.5085050769995245, "env_runner_sampling_timer": 0.5531957122542213, "learner_update_timer": 3.945814872480402, "synch_weights": 0.0016946426080655923, "synch_env_connectors": 0.002653672369364743}, "env_runners": {"episode_duration_sec_mean": 0.0003516438046062831, "num_module_steps_sampled": {"default_policy": 4096}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.459104260858031e-05, "get_actions": 8.799955106775804e-05, "un_batch_to_individual_items": 9.032262362768539e-06, "remove_single_ts_time_rank_from_batch": 9.69530361497262e-07, "listify_data_for_vector_env": 1.5264793476775118e-05, "tensor_to_numpy": 2.8290976336664593e-05}}, "connector_pipeline_timer": 0.00018932633064220602}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 8.307323373135075e-06, "add_time_dim_to_batch_and_zero_pad": 2.9867259623377888e-06, "numpy_to_tensor": 1.7417575928882787e-05, "add_observations_from_episodes_to_batch": 4.025044526613072e-06, "add_states_from_episodes_to_batch": 1.8082224927135886e-06}}, "connector_pipeline_timer": 5.549529918219106e-05}, "num_episodes": 4085, "episode_len_min": 1, "time_between_sampling": 0.6359007173431259, "episode_len_mean": 1.0, "env_step_timer": 2.281153877343039e-05, "num_episodes_lifetime": 52937, "agent_episode_returns_mean": {"default_agent": 51.0}, "episode_return_mean": 51.0, "weights_seq_no": 16.0, "num_env_steps_sampled_lifetime": 69632, "env_reset_timer": 0.00013909503468312323, "sample": 0.08969679610474025, "env_to_module_sum_episodes_length_out": 0.5557843110042507, "env_to_module_sum_episodes_length_in": 0.5557843110042507, "episode_len_max": 1, "rlmodule_inference_timer": 6.352035337433617e-05, "num_env_steps_sampled": 4096, "episode_return_max": 51.0, "num_module_steps_sampled_lifetime": {"default_policy": 69632}, "num_agent_steps_sampled": {"default_agent": 4096}, "episode_return_min": 51.0, "num_agent_steps_sampled_lifetime": {"default_agent": 69632}, "module_episode_returns_mean": {"default_policy": 51.0}, "num_env_steps_sampled_lifetime_throughput": 616.6711503870075}, "learners": {"default_policy": {"vf_explained_var": -1.1920928955078125e-07, "gradients_default_optimizer_global_norm": 0.018256893381476402, "mean_kl_loss": 0.0026554311625659466, "vf_loss_unclipped": 2627.69140625, "module_train_batch_size_mean": 128.0, "vf_loss": 10.0, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 0.008269832469522953, "num_module_steps_trained": 245504, "num_trainable_parameters": 134148.0, "weights_seq_no": 17.0, "policy_loss": -1.0011777877807617, "total_loss": 8.998971939086914, "curr_entropy_coeff": 0.0, "num_module_steps_trained_lifetime": 3681664, "curr_kl_coeff": 0.02812500111758709}, "__all_modules__": {"num_env_steps_trained": 15691158, "num_module_steps_trained_lifetime": 3681664, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.785177040721733e-05, "numpy_to_tensor": 0.00016781787693224121, "add_observations_from_episodes_to_batch": 0.006141436379689681, "add_states_from_episodes_to_batch": 5.549582107042099e-06, "batch_individual_items": 0.03146975332903911, "general_advantage_estimation": 0.017854600378287826, "add_columns_from_episodes_to_train_batch": 0.047172070004607485, "add_one_ts_to_episodes_and_truncate": 0.040969609105184907}}, "connector_pipeline_timer": 0.14430297655949242}, "learner_connector_sum_episodes_length_out": 5435.762473842852, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 4096.0, "num_module_steps_trained": 245504, "num_trainable_parameters": 134148.0, "num_env_steps_trained_lifetime": 210857526, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 69632, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 616.6711503870075, "done": false, "training_iteration": 17, "trial_id": "40149_00000", "date": "2025-05-17_14-55-11", "timestamp": 1747461311, "time_this_iter_s": 6.634359359741211, "time_total_s": 99.03254866600037, "pid": 1464251, "hostname": "localhost.localdomain", "node_ip": "10.139.239.36", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MatmulEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4096, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f7796fcc220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 99.03254866600037, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 10.78, "ram_util_percent": 14.800000000000002}}
{"timers": {"training_iteration": 4.5334042449594785, "restore_env_runners": 2.0377095648375757e-05, "training_step": 4.533247618659467, "env_runner_sampling_timer": 0.5589067285810863, "learner_update_timer": 3.964729704345809, "synch_weights": 0.0016946682925916665, "synch_env_connectors": 0.0026496765553749167}, "env_runners": {"episode_duration_sec_mean": 0.00036411846667760983, "num_module_steps_sampled": {"default_policy": 4096}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.4742294411683515e-05, "get_actions": 8.886072394056133e-05, "un_batch_to_individual_items": 9.135103866827807e-06, "remove_single_ts_time_rank_from_batch": 9.850640111872772e-07, "listify_data_for_vector_env": 1.5441684941133938e-05, "tensor_to_numpy": 2.856934972726903e-05}}, "connector_pipeline_timer": 0.00019139640429750214}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 8.438526943352779e-06, "add_time_dim_to_batch_and_zero_pad": 3.0214574974761584e-06, "numpy_to_tensor": 1.7615326868751294e-05, "add_observations_from_episodes_to_batch": 4.076783096971691e-06, "add_states_from_episodes_to_batch": 1.8314635890367453e-06}}, "connector_pipeline_timer": 5.6252282250151524e-05}, "num_episodes": 4089, "episode_len_min": 1, "time_between_sampling": 0.6705163306503161, "episode_len_mean": 1.0, "env_step_timer": 2.301462951524808e-05, "num_episodes_lifetime": 57026, "agent_episode_returns_mean": {"default_agent": 51.0}, "episode_return_mean": 51.0, "weights_seq_no": 17.0, "num_env_steps_sampled_lifetime": 73728, "env_reset_timer": 0.00013909503468312323, "sample": 0.09063392301273353, "env_to_module_sum_episodes_length_out": 0.5416145580277174, "env_to_module_sum_episodes_length_in": 0.5416145580277174, "episode_len_max": 1, "rlmodule_inference_timer": 6.330584046186981e-05, "num_env_steps_sampled": 4096, "episode_return_max": 51.0, "num_module_steps_sampled_lifetime": {"default_policy": 73728}, "num_agent_steps_sampled": {"default_agent": 4096}, "episode_return_min": 51.0, "num_agent_steps_sampled_lifetime": {"default_agent": 73728}, "module_episode_returns_mean": {"default_policy": 51.0}, "num_env_steps_sampled_lifetime_throughput": 585.641840724815}, "learners": {"default_policy": {"vf_explained_var": -1.1920928955078125e-07, "gradients_default_optimizer_global_norm": 0.13338452577590942, "mean_kl_loss": 0.00018248369451612234, "vf_loss_unclipped": 2623.185546875, "module_train_batch_size_mean": 128.0, "vf_loss": 10.0, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 0.00434448616579175, "num_module_steps_trained": 245632, "num_trainable_parameters": 134148.0, "weights_seq_no": 18.0, "policy_loss": -0.991260826587677, "total_loss": 9.008743286132812, "curr_entropy_coeff": 0.0, "num_module_steps_trained_lifetime": 3927296, "curr_kl_coeff": 0.014062500558793545}, "__all_modules__": {"num_env_steps_trained": 15707015, "num_module_steps_trained_lifetime": 3927296, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.7851167047007448e-05, "numpy_to_tensor": 0.00016779757176711593, "add_observations_from_episodes_to_batch": 0.006167032913704772, "add_states_from_episodes_to_batch": 5.547208420825687e-06, "batch_individual_items": 0.03160614969049532, "general_advantage_estimation": 0.017864629983537127, "add_columns_from_episodes_to_train_batch": 0.04721769865757707, "add_one_ts_to_episodes_and_truncate": 0.04105517309456663}}, "connector_pipeline_timer": 0.14460636475047128}, "learner_connector_sum_episodes_length_out": 5438.717174431696, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 4096.0, "num_module_steps_trained": 245632, "num_trainable_parameters": 134148.0, "num_env_steps_trained_lifetime": 226564541, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 73728, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 585.641840724815, "done": false, "training_iteration": 18, "trial_id": "40149_00000", "date": "2025-05-17_14-55-18", "timestamp": 1747461318, "time_this_iter_s": 6.987401723861694, "time_total_s": 106.01995038986206, "pid": 1464251, "hostname": "localhost.localdomain", "node_ip": "10.139.239.36", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MatmulEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4096, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f7796fcc220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 106.01995038986206, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 11.06, "ram_util_percent": 14.800000000000002}}
{"timers": {"training_iteration": 4.556465894650214, "restore_env_runners": 2.026259428897533e-05, "training_step": 4.556308763543882, "env_runner_sampling_timer": 0.5633739335957013, "learner_update_timer": 3.9832004055726684, "synch_weights": 0.0017008919001805765, "synch_env_connectors": 0.002647060509494056}, "env_runners": {"episode_duration_sec_mean": 0.0003830295827356167, "num_module_steps_sampled": {"default_policy": 4096}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.4922092603161805e-05, "get_actions": 8.997980919911341e-05, "un_batch_to_individual_items": 9.263059564629471e-06, "remove_single_ts_time_rank_from_batch": 1.0033548343792324e-06, "listify_data_for_vector_env": 1.5651998605256527e-05, "tensor_to_numpy": 2.8910904566929633e-05}}, "connector_pipeline_timer": 0.00019400877495927578}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 8.631104215283373e-06, "add_time_dim_to_batch_and_zero_pad": 3.0652850383629573e-06, "numpy_to_tensor": 1.785510424904104e-05, "add_observations_from_episodes_to_batch": 4.139545540609953e-06, "add_states_from_episodes_to_batch": 1.8642411238082008e-06}}, "connector_pipeline_timer": 5.724356941238055e-05}, "num_episodes": 4088, "episode_len_min": 1, "time_between_sampling": 0.7049276909574534, "episode_len_mean": 1.0, "env_step_timer": 2.3290547976440983e-05, "num_episodes_lifetime": 61114, "agent_episode_returns_mean": {"default_agent": 51.0}, "episode_return_mean": 51.0, "weights_seq_no": 18.0, "num_env_steps_sampled_lifetime": 77824, "env_reset_timer": 0.00013909503468312323, "sample": 0.09160310166660232, "env_to_module_sum_episodes_length_out": 0.531231987258737, "env_to_module_sum_episodes_length_in": 0.531231987258737, "episode_len_max": 1, "rlmodule_inference_timer": 6.358525856521717e-05, "num_env_steps_sampled": 4096, "episode_return_max": 51.0, "num_module_steps_sampled_lifetime": {"default_policy": 77824}, "num_agent_steps_sampled": {"default_agent": 4096}, "episode_return_min": 51.0, "num_agent_steps_sampled_lifetime": {"default_agent": 77824}, "module_episode_returns_mean": {"default_policy": 51.0}, "num_env_steps_sampled_lifetime_throughput": 597.8301311698783}, "learners": {"default_policy": {"vf_explained_var": 0.0, "gradients_default_optimizer_global_norm": 0.022738017141819, "mean_kl_loss": 0.0002117582771461457, "vf_loss_unclipped": 2627.691650390625, "module_train_batch_size_mean": 128.0, "vf_loss": 10.0, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 0.009029533714056015, "num_module_steps_trained": 245632, "num_trainable_parameters": 134148.0, "weights_seq_no": 19.0, "policy_loss": -0.9986428618431091, "total_loss": 9.001359939575195, "curr_entropy_coeff": 0.0, "num_module_steps_trained_lifetime": 4172928, "curr_kl_coeff": 0.007031250279396772}, "__all_modules__": {"num_env_steps_trained": 15705096, "num_module_steps_trained_lifetime": 4172928, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.7850448668748296e-05, "numpy_to_tensor": 0.0001677764741212398, "add_observations_from_episodes_to_batch": 0.0061933465848987715, "add_states_from_episodes_to_batch": 5.544732957519466e-06, "batch_individual_items": 0.031742091719488295, "general_advantage_estimation": 0.017875404007737284, "add_columns_from_episodes_to_train_batch": 0.04728270275228443, "add_one_ts_to_episodes_and_truncate": 0.04114702426934306}}, "connector_pipeline_timer": 0.1449364397618802}, "learner_connector_sum_episodes_length_out": 5441.887604761378, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 4096.0, "num_module_steps_trained": 245632, "num_trainable_parameters": 134148.0, "num_env_steps_trained_lifetime": 242269637, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 77824, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 597.8301311698783, "done": false, "training_iteration": 19, "trial_id": "40149_00000", "date": "2025-05-17_14-55-25", "timestamp": 1747461325, "time_this_iter_s": 6.84390926361084, "time_total_s": 112.8638596534729, "pid": 1464251, "hostname": "localhost.localdomain", "node_ip": "10.139.239.36", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MatmulEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4096, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f7796fcc220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 112.8638596534729, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 11.155555555555557, "ram_util_percent": 14.800000000000002}}
{"timers": {"training_iteration": 4.577768003514136, "restore_env_runners": 2.0145629068192273e-05, "training_step": 4.577610432058614, "env_runner_sampling_timer": 0.5663042320195326, "learner_update_timer": 4.0014531942177705, "synch_weights": 0.0017024849319024484, "synch_env_connectors": 0.0026429330454259105}, "env_runners": {"episode_duration_sec_mean": 0.00036085222745896317, "num_module_steps_sampled": {"default_policy": 4096}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.4906270715901404e-05, "get_actions": 8.990928458434323e-05, "un_batch_to_individual_items": 9.250267075804829e-06, "remove_single_ts_time_rank_from_batch": 9.997774047840486e-07, "listify_data_for_vector_env": 1.5645347691206562e-05, "tensor_to_numpy": 2.8878013693233993e-05}}, "connector_pipeline_timer": 0.00019383417574480953}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 8.627073928469445e-06, "add_time_dim_to_batch_and_zero_pad": 3.0618145105628584e-06, "numpy_to_tensor": 1.7844667491607726e-05, "add_observations_from_episodes_to_batch": 4.139230302916222e-06, "add_states_from_episodes_to_batch": 1.8608974363891105e-06}}, "connector_pipeline_timer": 5.719300756737253e-05}, "num_episodes": 4093, "episode_len_min": 1, "time_between_sampling": 0.7382526408701318, "episode_len_mean": 1.0, "env_step_timer": 2.3253316278692132e-05, "num_episodes_lifetime": 65207, "agent_episode_returns_mean": {"default_agent": 51.0}, "episode_return_mean": 51.0, "weights_seq_no": 19.0, "num_env_steps_sampled_lifetime": 81920, "env_reset_timer": 0.00013909503468312323, "sample": 0.09257476424350547, "env_to_module_sum_episodes_length_out": 0.5235080305565194, "env_to_module_sum_episodes_length_in": 0.5235080305565194, "episode_len_max": 1, "rlmodule_inference_timer": 6.306410887944041e-05, "num_env_steps_sampled": 4096, "episode_return_max": 51.0, "num_module_steps_sampled_lifetime": {"default_policy": 81920}, "num_agent_steps_sampled": {"default_agent": 4096}, "episode_return_min": 51.0, "num_agent_steps_sampled_lifetime": {"default_agent": 81920}, "module_episode_returns_mean": {"default_policy": 51.0}, "num_env_steps_sampled_lifetime_throughput": 611.4521299062097}, "learners": {"default_policy": {"vf_explained_var": -1.1920928955078125e-07, "gradients_default_optimizer_global_norm": 0.0003969315439462662, "mean_kl_loss": 0.0031823499593883753, "vf_loss_unclipped": 2627.69140625, "module_train_batch_size_mean": 128.0, "vf_loss": 10.0, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 0.0003121033660136163, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "weights_seq_no": 20.0, "policy_loss": -1.0008267164230347, "total_loss": 8.999195098876953, "curr_entropy_coeff": 0.0, "num_module_steps_trained_lifetime": 4418688, "curr_kl_coeff": 0.003515625139698386}, "__all_modules__": {"num_env_steps_trained": 15722880, "num_module_steps_trained_lifetime": 4418688, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.784928203104711e-05, "numpy_to_tensor": 0.00016775459176989437, "add_observations_from_episodes_to_batch": 0.006220241172073257, "add_states_from_episodes_to_batch": 5.542124974648583e-06, "batch_individual_items": 0.031877792167829, "general_advantage_estimation": 0.017886862938052462, "add_columns_from_episodes_to_train_batch": 0.04736605612323733, "add_one_ts_to_episodes_and_truncate": 0.0412448994016154}}, "connector_pipeline_timer": 0.14529192344709377}, "learner_connector_sum_episodes_length_out": 5445.269654767023, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 4096.0, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "num_env_steps_trained_lifetime": 257992517, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 81920, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 611.4521299062097, "done": false, "training_iteration": 20, "trial_id": "40149_00000", "date": "2025-05-17_14-55-31", "timestamp": 1747461331, "time_this_iter_s": 6.691224575042725, "time_total_s": 119.55508422851562, "pid": 1464251, "hostname": "localhost.localdomain", "node_ip": "10.139.239.36", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MatmulEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4096, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f7796fcc220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 119.55508422851562, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 11.09, "ram_util_percent": 14.800000000000002}}
{"timers": {"training_iteration": 4.596622828159189, "restore_env_runners": 2.008233331730134e-05, "training_step": 4.596464249788545, "env_runner_sampling_timer": 0.5682917052784902, "learner_update_timer": 4.018202499205633, "synch_weights": 0.0017025925925488736, "synch_env_connectors": 0.0026428329957802195}, "env_runners": {"episode_duration_sec_mean": 0.0003708031690621283, "num_module_steps_sampled": {"default_policy": 4096}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.471707699724348e-05, "get_actions": 8.884374249344222e-05, "un_batch_to_individual_items": 9.129283543878765e-06, "remove_single_ts_time_rank_from_batch": 9.83716575391702e-07, "listify_data_for_vector_env": 1.542887663927845e-05, "tensor_to_numpy": 2.853246392971268e-05}}, "connector_pipeline_timer": 0.00019126034391394507}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 8.449040258593656e-06, "add_time_dim_to_batch_and_zero_pad": 3.0204784837765294e-06, "numpy_to_tensor": 1.7617242720090216e-05, "add_observations_from_episodes_to_batch": 4.0780283754632795e-06, "add_states_from_episodes_to_batch": 1.8295857289717792e-06}}, "connector_pipeline_timer": 5.6219026657169966e-05}, "num_episodes": 4096, "episode_len_min": 1, "time_between_sampling": 0.770535214480369, "episode_len_mean": 1.0, "env_step_timer": 2.2952860536849325e-05, "num_episodes_lifetime": 69303, "agent_episode_returns_mean": {"default_agent": 51.0}, "episode_return_mean": 51.0, "weights_seq_no": 20.0, "num_env_steps_sampled_lifetime": 86016, "env_reset_timer": 0.00013909503468312323, "sample": 0.09346988753304883, "env_to_module_sum_episodes_length_out": 0.5177339275460586, "env_to_module_sum_episodes_length_in": 0.5177339275460586, "episode_len_max": 1, "rlmodule_inference_timer": 6.191633154456926e-05, "num_env_steps_sampled": 4096, "episode_return_max": 51.0, "num_module_steps_sampled_lifetime": {"default_policy": 86016}, "num_agent_steps_sampled": {"default_agent": 4096}, "episode_return_min": 51.0, "num_agent_steps_sampled_lifetime": {"default_agent": 86016}, "module_episode_returns_mean": {"default_policy": 51.0}, "num_env_steps_sampled_lifetime_throughput": 624.1058224239108}, "learners": {"default_policy": {"vf_explained_var": -1.1920928955078125e-07, "gradients_default_optimizer_global_norm": 4.7026922402437776e-05, "mean_kl_loss": 4.025826638098806e-05, "vf_loss_unclipped": 2627.691650390625, "module_train_batch_size_mean": 128.0, "vf_loss": 10.0, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 3.385653326404281e-05, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "weights_seq_no": 21.0, "policy_loss": -1.0000239610671997, "total_loss": 8.999977111816406, "curr_entropy_coeff": 0.0, "num_module_steps_trained_lifetime": 4664448, "curr_kl_coeff": 0.001757812569849193}, "__all_modules__": {"num_env_steps_trained": 15728640, "num_module_steps_trained_lifetime": 4664448, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.784829027339473e-05, "numpy_to_tensor": 0.0001677386179228471, "add_observations_from_episodes_to_batch": 0.006247752156455679, "add_states_from_episodes_to_batch": 5.5395036690571685e-06, "batch_individual_items": 0.032012874601036, "general_advantage_estimation": 0.01789891760105733, "add_columns_from_episodes_to_train_batch": 0.04745088601298981, "add_one_ts_to_episodes_and_truncate": 0.04134884053691035}}, "connector_pipeline_timer": 0.14565555949032644}, "learner_connector_sum_episodes_length_out": 5448.859075012079, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 4096.0, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "num_env_steps_trained_lifetime": 273721157, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 86016, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 624.1058224239108, "done": false, "training_iteration": 21, "trial_id": "40149_00000", "date": "2025-05-17_14-55-38", "timestamp": 1747461338, "time_this_iter_s": 6.4674623012542725, "time_total_s": 126.0225465297699, "pid": 1464251, "hostname": "localhost.localdomain", "node_ip": "10.139.239.36", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MatmulEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4096, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f7796fcc220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 126.0225465297699, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 11.411111111111111, "ram_util_percent": 14.800000000000002}}
{"timers": {"training_iteration": 4.618190196877308, "restore_env_runners": 1.9949630409695357e-05, "training_step": 4.618031411251105, "env_runner_sampling_timer": 0.5719960719956071, "learner_update_timer": 4.035945997163822, "synch_weights": 0.001703667376044945, "synch_env_connectors": 0.0026394598355537957}, "env_runners": {"episode_duration_sec_mean": 0.00036686149542219937, "num_module_steps_sampled": {"default_policy": 4096}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.4678258968050477e-05, "get_actions": 8.86193069029742e-05, "un_batch_to_individual_items": 9.110745372016929e-06, "remove_single_ts_time_rank_from_batch": 9.80949112069495e-07, "listify_data_for_vector_env": 1.5390335701555167e-05, "tensor_to_numpy": 2.8460347039957432e-05}}, "connector_pipeline_timer": 0.00019074258477988235}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 8.41161850708266e-06, "add_time_dim_to_batch_and_zero_pad": 3.0140733610621166e-06, "numpy_to_tensor": 1.7569939581591747e-05, "add_observations_from_episodes_to_batch": 4.069561366409182e-06, "add_states_from_episodes_to_batch": 1.8231443752125124e-06}}, "connector_pipeline_timer": 5.6011152314629425e-05}, "num_episodes": 4096, "episode_len_min": 1, "time_between_sampling": 0.801293645854596, "episode_len_mean": 1.0, "env_step_timer": 2.287462429555756e-05, "num_episodes_lifetime": 73399, "agent_episode_returns_mean": {"default_agent": 51.0}, "episode_return_mean": 51.0, "weights_seq_no": 21.0, "num_env_steps_sampled_lifetime": 90112, "env_reset_timer": 0.00013909503468312323, "sample": 0.09430788384296022, "env_to_module_sum_episodes_length_out": 0.5135477529333576, "env_to_module_sum_episodes_length_in": 0.5135477529333576, "episode_len_max": 1, "rlmodule_inference_timer": 6.153146272591667e-05, "num_env_steps_sampled": 4096, "episode_return_max": 51.0, "num_module_steps_sampled_lifetime": {"default_policy": 90112}, "num_agent_steps_sampled": {"default_agent": 4096}, "episode_return_min": 51.0, "num_agent_steps_sampled_lifetime": {"default_agent": 90112}, "module_episode_returns_mean": {"default_policy": 51.0}, "num_env_steps_sampled_lifetime_throughput": 605.4308715947612}, "learners": {"default_policy": {"vf_explained_var": -1.1920928955078125e-07, "gradients_default_optimizer_global_norm": 1.739641447784379e-05, "mean_kl_loss": 1.4056072359380778e-06, "vf_loss_unclipped": 2627.691162109375, "module_train_batch_size_mean": 128.0, "vf_loss": 10.0, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 1.1206176168343518e-05, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "weights_seq_no": 22.0, "policy_loss": -1.0000014305114746, "total_loss": 8.999999046325684, "curr_entropy_coeff": 0.0, "num_module_steps_trained_lifetime": 4910208, "curr_kl_coeff": 0.0008789062849245965}, "__all_modules__": {"num_env_steps_trained": 15728640, "num_module_steps_trained_lifetime": 4910208, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.7847179512059857e-05, "numpy_to_tensor": 0.00016772165399712535, "add_observations_from_episodes_to_batch": 0.006275897891933352, "add_states_from_episodes_to_batch": 5.5367662843243935e-06, "batch_individual_items": 0.032164702802255314, "general_advantage_estimation": 0.017911686036097378, "add_columns_from_episodes_to_train_batch": 0.04753717429174159, "add_one_ts_to_episodes_and_truncate": 0.04145846878765343}}, "connector_pipeline_timer": 0.14604446445185254}, "learner_connector_sum_episodes_length_out": 5452.651379886758, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 4096.0, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "num_env_steps_trained_lifetime": 289449797, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 90112, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 605.4308715947612, "done": false, "training_iteration": 22, "trial_id": "40149_00000", "date": "2025-05-17_14-55-45", "timestamp": 1747461345, "time_this_iter_s": 6.7582831382751465, "time_total_s": 132.78082966804504, "pid": 1464251, "hostname": "localhost.localdomain", "node_ip": "10.139.239.36", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MatmulEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4096, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f7796fcc220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 132.78082966804504, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 10.91, "ram_util_percent": 14.800000000000002}}
{"timers": {"training_iteration": 4.6384640167974585, "restore_env_runners": 1.983429423420675e-05, "training_step": 4.638304886607682, "env_runner_sampling_timer": 0.5745450659457078, "learner_update_timer": 4.053570390702998, "synch_weights": 0.0017027878823553725, "synch_env_connectors": 0.0026408429364862384}, "env_runners": {"episode_duration_sec_mean": 0.0003691931524372194, "num_module_steps_sampled": {"default_policy": 4096}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.4619413381475496e-05, "get_actions": 8.835971664804485e-05, "un_batch_to_individual_items": 9.07853318253796e-06, "remove_single_ts_time_rank_from_batch": 9.767420236380792e-07, "listify_data_for_vector_env": 1.533987894926318e-05, "tensor_to_numpy": 2.837379506385917e-05}}, "connector_pipeline_timer": 0.00019008491352668085}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 8.360618709986464e-06, "add_time_dim_to_batch_and_zero_pad": 3.002421427352997e-06, "numpy_to_tensor": 1.750533439122778e-05, "add_observations_from_episodes_to_batch": 4.049956214446025e-06, "add_states_from_episodes_to_batch": 1.8151727398660178e-06}}, "connector_pipeline_timer": 5.573458409446753e-05}, "num_episodes": 4096, "episode_len_min": 1, "time_between_sampling": 0.8309060550417053, "episode_len_mean": 1.0, "env_step_timer": 2.2799936558069162e-05, "num_episodes_lifetime": 77495, "agent_episode_returns_mean": {"default_agent": 51.0}, "episode_return_mean": 51.0, "weights_seq_no": 22.0, "num_env_steps_sampled_lifetime": 94208, "env_reset_timer": 0.00013909503468312323, "sample": 0.09510612800531312, "env_to_module_sum_episodes_length_out": 0.5105128586541102, "env_to_module_sum_episodes_length_in": 0.5105128586541102, "episode_len_max": 1, "rlmodule_inference_timer": 6.110976060019752e-05, "num_env_steps_sampled": 4096, "episode_return_max": 51.0, "num_module_steps_sampled_lifetime": {"default_policy": 94208}, "num_agent_steps_sampled": {"default_agent": 4096}, "episode_return_min": 51.0, "num_agent_steps_sampled_lifetime": {"default_agent": 94208}, "module_episode_returns_mean": {"default_policy": 51.0}, "num_env_steps_sampled_lifetime_throughput": 615.1798528298639}, "learners": {"default_policy": {"vf_explained_var": 0.0, "gradients_default_optimizer_global_norm": 4.378116045700153e-06, "mean_kl_loss": -4.669816462410381e-07, "vf_loss_unclipped": 2627.691650390625, "module_train_batch_size_mean": 128.0, "vf_loss": 10.0, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 5.351837444322882e-06, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "weights_seq_no": 23.0, "policy_loss": -1.000001072883606, "total_loss": 8.999999046325684, "curr_entropy_coeff": 0.0, "num_module_steps_trained_lifetime": 5155968, "curr_kl_coeff": 0.0004394531424622983}, "__all_modules__": {"num_env_steps_trained": 15728640, "num_module_steps_trained_lifetime": 5155968, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.7846067430894393e-05, "numpy_to_tensor": 0.0001677036592841131, "add_observations_from_episodes_to_batch": 0.0063046264882783976, "add_states_from_episodes_to_batch": 5.5339474998678735e-06, "batch_individual_items": 0.03233217123148972, "general_advantage_estimation": 0.017925155560470845, "add_columns_from_episodes_to_train_batch": 0.047625088674420155, "add_one_ts_to_episodes_and_truncate": 0.04157385732003043}}, "connector_pipeline_timer": 0.14645768505989776}, "learner_connector_sum_episodes_length_out": 5456.642152756443, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 4096.0, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "num_env_steps_trained_lifetime": 305178437, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 94208, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 615.1798528298639, "done": false, "training_iteration": 23, "trial_id": "40149_00000", "date": "2025-05-17_14-55-51", "timestamp": 1747461351, "time_this_iter_s": 6.651336193084717, "time_total_s": 139.43216586112976, "pid": 1464251, "hostname": "localhost.localdomain", "node_ip": "10.139.239.36", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MatmulEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4096, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f7796fcc220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 139.43216586112976, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 10.944444444444443, "ram_util_percent": 14.811111111111112}}
{"timers": {"training_iteration": 4.658458414749406, "restore_env_runners": 1.9706991413703134e-05, "training_step": 4.658299106350963, "env_runner_sampling_timer": 0.5782187241157117, "learner_update_timer": 4.069772248446775, "synch_weights": 0.0017026835235473712, "synch_env_connectors": 0.002653097837609283}, "env_runners": {"episode_duration_sec_mean": 0.0003662873314169701, "num_module_steps_sampled": {"default_policy": 4096}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.452474057243039e-05, "get_actions": 8.787895128469635e-05, "un_batch_to_individual_items": 9.026001200737236e-06, "remove_single_ts_time_rank_from_batch": 9.694163757632338e-07, "listify_data_for_vector_env": 1.5242029082784338e-05, "tensor_to_numpy": 2.820519288085631e-05}}, "connector_pipeline_timer": 0.0001889184036270688}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 8.283135074922608e-06, "add_time_dim_to_batch_and_zero_pad": 2.9857353113327907e-06, "numpy_to_tensor": 1.7398463904850134e-05, "add_observations_from_episodes_to_batch": 4.0239481910746004e-06, "add_states_from_episodes_to_batch": 1.8045531192635015e-06}}, "connector_pipeline_timer": 5.53110231763368e-05}, "num_episodes": 4096, "episode_len_min": 1, "time_between_sampling": 0.8594040986624896, "episode_len_mean": 1.0, "env_step_timer": 2.265513357112705e-05, "num_episodes_lifetime": 81591, "agent_episode_returns_mean": {"default_agent": 51.0}, "episode_return_mean": 51.0, "weights_seq_no": 23.0, "num_env_steps_sampled_lifetime": 98304, "env_reset_timer": 0.00013909503468312323, "sample": 0.09584841504514204, "env_to_module_sum_episodes_length_out": 0.5083126199799451, "env_to_module_sum_episodes_length_in": 0.5083126199799451, "episode_len_max": 1, "rlmodule_inference_timer": 6.0630833069492513e-05, "num_env_steps_sampled": 4096, "episode_return_max": 51.0, "num_module_steps_sampled_lifetime": {"default_policy": 98304}, "num_agent_steps_sampled": {"default_agent": 4096}, "episode_return_min": 51.0, "num_agent_steps_sampled_lifetime": {"default_agent": 98304}, "module_episode_returns_mean": {"default_policy": 51.0}, "num_env_steps_sampled_lifetime_throughput": 615.8797932864669}, "learners": {"default_policy": {"vf_explained_var": -1.1920928955078125e-07, "gradients_default_optimizer_global_norm": 2.117505800924846e-06, "mean_kl_loss": 2.467356239321816e-07, "vf_loss_unclipped": 2627.691162109375, "module_train_batch_size_mean": 128.0, "vf_loss": 10.0, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 2.752183945631259e-06, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "weights_seq_no": 24.0, "policy_loss": -1.0000001192092896, "total_loss": 9.0, "curr_entropy_coeff": 0.0, "num_module_steps_trained_lifetime": 5401728, "curr_kl_coeff": 0.00021972657123114914}, "__all_modules__": {"num_env_steps_trained": 15728640, "num_module_steps_trained_lifetime": 5401728, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.7844851966360047e-05, "numpy_to_tensor": 0.0001676845578996248, "add_observations_from_episodes_to_batch": 0.006333955671814707, "add_states_from_episodes_to_batch": 5.531017214848586e-06, "batch_individual_items": 0.03249844626375685, "general_advantage_estimation": 0.017939317639149698, "add_columns_from_episodes_to_train_batch": 0.04771453642371931, "add_one_ts_to_episodes_and_truncate": 0.041695038877480474}}, "connector_pipeline_timer": 0.1468783529691296}, "learner_connector_sum_episodes_length_out": 5460.827045030744, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 4096.0, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "num_env_steps_trained_lifetime": 320907077, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 98304, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 615.8797932864669, "done": false, "training_iteration": 24, "trial_id": "40149_00000", "date": "2025-05-17_14-55-58", "timestamp": 1747461358, "time_this_iter_s": 6.6420738697052, "time_total_s": 146.07423973083496, "pid": 1464251, "hostname": "localhost.localdomain", "node_ip": "10.139.239.36", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MatmulEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4096, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f7796fcc220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 146.07423973083496, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 11.244444444444444, "ram_util_percent": 14.800000000000002}}
{"timers": {"training_iteration": 4.678772024921713, "restore_env_runners": 1.9593081620559954e-05, "training_step": 4.678612339127757, "env_runner_sampling_timer": 0.5808974736036524, "learner_update_timer": 4.087289583822669, "synch_weights": 0.001703289838876404, "synch_env_connectors": 0.002648005219214593}, "env_runners": {"episode_duration_sec_mean": 0.00035932341052102856, "num_module_steps_sampled": {"default_policy": 4096}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.4622244580278998e-05, "get_actions": 8.83956015459092e-05, "un_batch_to_individual_items": 9.080680664162676e-06, "remove_single_ts_time_rank_from_batch": 9.793359879218383e-07, "listify_data_for_vector_env": 1.5357098782048014e-05, "tensor_to_numpy": 2.8375035084231478e-05}}, "connector_pipeline_timer": 0.0001901925473769191}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 8.374221157688188e-06, "add_time_dim_to_batch_and_zero_pad": 3.0036066200950157e-06, "numpy_to_tensor": 1.751526840476672e-05, "add_observations_from_episodes_to_batch": 4.053126957768642e-06, "add_states_from_episodes_to_batch": 1.8183421414929352e-06}}, "connector_pipeline_timer": 5.579524763234977e-05}, "num_episodes": 4096, "episode_len_min": 1, "time_between_sampling": 0.8867804742389723, "episode_len_mean": 1.0, "env_step_timer": 2.279700397619956e-05, "num_episodes_lifetime": 85687, "agent_episode_returns_mean": {"default_agent": 51.0}, "episode_return_mean": 51.0, "weights_seq_no": 24.0, "num_env_steps_sampled_lifetime": 102400, "env_reset_timer": 0.00013909503468312323, "sample": 0.09657120860478621, "env_to_module_sum_episodes_length_out": 0.5067174902067616, "env_to_module_sum_episodes_length_in": 0.5067174902067616, "episode_len_max": 1, "rlmodule_inference_timer": 6.089525474211598e-05, "num_env_steps_sampled": 4096, "episode_return_max": 51.0, "num_module_steps_sampled_lifetime": {"default_policy": 102400}, "num_agent_steps_sampled": {"default_agent": 4096}, "episode_return_min": 51.0, "num_agent_steps_sampled_lifetime": {"default_agent": 102400}, "module_episode_returns_mean": {"default_policy": 51.0}, "num_env_steps_sampled_lifetime_throughput": 611.2022847840587}, "learners": {"default_policy": {"vf_explained_var": 0.0, "gradients_default_optimizer_global_norm": 9.026490488395211e-07, "mean_kl_loss": 1.435631560298134e-07, "vf_loss_unclipped": 2627.691650390625, "module_train_batch_size_mean": 128.0, "vf_loss": 10.0, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 1.2459967138056527e-06, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "weights_seq_no": 25.0, "policy_loss": -1.0000001192092896, "total_loss": 9.0, "curr_entropy_coeff": 0.0, "num_module_steps_trained_lifetime": 5647488, "curr_kl_coeff": 0.00010986328561557457}, "__all_modules__": {"num_env_steps_trained": 15728640, "num_module_steps_trained_lifetime": 5647488, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.7843431105619283e-05, "numpy_to_tensor": 0.00016766425147062415, "add_observations_from_episodes_to_batch": 0.006363930418825359, "add_states_from_episodes_to_batch": 5.527940734819375e-06, "batch_individual_items": 0.03266379326565851, "general_advantage_estimation": 0.017954164688297723, "add_columns_from_episodes_to_train_batch": 0.04782078764875758, "add_one_ts_to_episodes_and_truncate": 0.041821637410152504}}, "connector_pipeline_timer": 0.1473216817945761}, "learner_connector_sum_episodes_length_out": 5465.201775244283, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 4096.0, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "num_env_steps_trained_lifetime": 336635717, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 102400, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 611.2022847840587, "done": false, "training_iteration": 25, "trial_id": "40149_00000", "date": "2025-05-17_14-56-05", "timestamp": 1747461365, "time_this_iter_s": 6.694269895553589, "time_total_s": 152.76850962638855, "pid": 1464251, "hostname": "localhost.localdomain", "node_ip": "10.139.239.36", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MatmulEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4096, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f7796fcc220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 152.76850962638855, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 11.0, "ram_util_percent": 14.800000000000002}}
{"timers": {"training_iteration": 4.698805438332183, "restore_env_runners": 1.9474291089056535e-05, "training_step": 4.698645453046454, "env_runner_sampling_timer": 0.5838864577485117, "learner_update_timer": 4.104232953903687, "synch_weights": 0.0017059366002323646, "synch_env_connectors": 0.0026457759768241896}, "env_runners": {"episode_duration_sec_mean": 0.000348393659805879, "num_module_steps_sampled": {"default_policy": 4096}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.4700107064575736e-05, "get_actions": 8.893915843024051e-05, "un_batch_to_individual_items": 9.139061015783868e-06, "remove_single_ts_time_rank_from_batch": 9.869849707970971e-07, "listify_data_for_vector_env": 1.5467903338797454e-05, "tensor_to_numpy": 2.854685711424907e-05}}, "connector_pipeline_timer": 0.00019150247113158025}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 8.472229841142037e-06, "add_time_dim_to_batch_and_zero_pad": 3.023974800312788e-06, "numpy_to_tensor": 1.763870425658566e-05, "add_observations_from_episodes_to_batch": 4.084128741462844e-06, "add_states_from_episodes_to_batch": 1.8368518271236272e-06}}, "connector_pipeline_timer": 5.634755912665151e-05}, "num_episodes": 4096, "episode_len_min": 1, "time_between_sampling": 0.9131121063480774, "episode_len_mean": 1.0, "env_step_timer": 2.2932787078862246e-05, "num_episodes_lifetime": 89783, "agent_episode_returns_mean": {"default_agent": 51.0}, "episode_return_mean": 51.0, "weights_seq_no": 25.0, "num_env_steps_sampled_lifetime": 106496, "env_reset_timer": 0.00013909503468312323, "sample": 0.09732720640894724, "env_to_module_sum_episodes_length_out": 0.5055610524879022, "env_to_module_sum_episodes_length_in": 0.5055610524879022, "episode_len_max": 1, "rlmodule_inference_timer": 6.133851661020561e-05, "num_env_steps_sampled": 4096, "episode_return_max": 51.0, "num_module_steps_sampled_lifetime": {"default_policy": 106496}, "num_agent_steps_sampled": {"default_agent": 4096}, "episode_return_min": 51.0, "num_agent_steps_sampled_lifetime": {"default_agent": 106496}, "module_episode_returns_mean": {"default_policy": 51.0}, "num_env_steps_sampled_lifetime_throughput": 611.925479255727}, "learners": {"default_policy": {"vf_explained_var": -1.1920928955078125e-07, "gradients_default_optimizer_global_norm": 3.6166463246445346e-07, "mean_kl_loss": 6.657229079110039e-08, "vf_loss_unclipped": 2627.69140625, "module_train_batch_size_mean": 128.0, "vf_loss": 10.0, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 5.282236088532954e-07, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "weights_seq_no": 26.0, "policy_loss": -1.0000001192092896, "total_loss": 9.0, "curr_entropy_coeff": 0.0, "num_module_steps_trained_lifetime": 5893248, "curr_kl_coeff": 5.4931642807787284e-05}, "__all_modules__": {"num_env_steps_trained": 15728640, "num_module_steps_trained_lifetime": 5893248, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.7841827075951435e-05, "numpy_to_tensor": 0.00016764241541175663, "add_observations_from_episodes_to_batch": 0.006394552368829567, "add_states_from_episodes_to_batch": 5.524753384054703e-06, "batch_individual_items": 0.03282819093999385, "general_advantage_estimation": 0.017969713367696784, "add_columns_from_episodes_to_train_batch": 0.04794393522526172, "add_one_ts_to_episodes_and_truncate": 0.041953547119787826}}, "connector_pipeline_timer": 0.1477876370379136}, "learner_connector_sum_episodes_length_out": 5469.76212814905, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 4096.0, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "num_env_steps_trained_lifetime": 352364357, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 106496, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 611.925479255727, "done": false, "training_iteration": 26, "trial_id": "40149_00000", "date": "2025-05-17_14-56-11", "timestamp": 1747461371, "time_this_iter_s": 6.6884446144104, "time_total_s": 159.45695424079895, "pid": 1464251, "hostname": "localhost.localdomain", "node_ip": "10.139.239.36", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MatmulEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4096, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f7796fcc220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 159.45695424079895, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 10.85, "ram_util_percent": 14.810000000000002}}
{"timers": {"training_iteration": 4.719670554199171, "restore_env_runners": 1.9403778460547147e-05, "training_step": 4.719509979566859, "env_runner_sampling_timer": 0.5875446086519099, "learner_update_timer": 4.12131756059476, "synch_weights": 0.0017057654838955397, "synch_env_connectors": 0.002662387077014969}, "env_runners": {"episode_duration_sec_mean": 0.00037302161945262924, "num_module_steps_sampled": {"default_policy": 4096}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.476230354830223e-05, "get_actions": 8.930855757644082e-05, "un_batch_to_individual_items": 9.193261875175036e-06, "remove_single_ts_time_rank_from_batch": 9.930336052664824e-07, "listify_data_for_vector_env": 1.5548218504496707e-05, "tensor_to_numpy": 2.8683567567729827e-05}}, "connector_pipeline_timer": 0.00019245617993803328}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 8.5468540849853e-06, "add_time_dim_to_batch_and_zero_pad": 3.041601148177896e-06, "numpy_to_tensor": 1.7728648430120704e-05, "add_observations_from_episodes_to_batch": 4.103180780719958e-06, "add_states_from_episodes_to_batch": 1.8502838361484996e-06}}, "connector_pipeline_timer": 5.675319590250406e-05}, "num_episodes": 4096, "episode_len_min": 1, "time_between_sampling": 0.9383874738874165, "episode_len_mean": 1.0, "env_step_timer": 2.3033225506936063e-05, "num_episodes_lifetime": 93879, "agent_episode_returns_mean": {"default_agent": 51.0}, "episode_return_mean": 51.0, "weights_seq_no": 26.0, "num_env_steps_sampled_lifetime": 110592, "env_reset_timer": 0.00013909503468312323, "sample": 0.09809366655078552, "env_to_module_sum_episodes_length_out": 0.5047226578819692, "env_to_module_sum_episodes_length_in": 0.5047226578819692, "episode_len_max": 1, "rlmodule_inference_timer": 6.267408384104121e-05, "num_env_steps_sampled": 4096, "episode_return_max": 51.0, "num_module_steps_sampled_lifetime": {"default_policy": 110592}, "num_agent_steps_sampled": {"default_agent": 4096}, "episode_return_min": 51.0, "num_agent_steps_sampled_lifetime": {"default_agent": 110592}, "module_episode_returns_mean": {"default_policy": 51.0}, "num_env_steps_sampled_lifetime_throughput": 602.2902446128471}, "learners": {"default_policy": {"vf_explained_var": -1.1920928955078125e-07, "gradients_default_optimizer_global_norm": 1.4134697323697765e-07, "mean_kl_loss": 2.7568619387352555e-08, "vf_loss_unclipped": 2627.69140625, "module_train_batch_size_mean": 128.0, "vf_loss": 10.0, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 2.1771438696305268e-07, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "weights_seq_no": 27.0, "policy_loss": -1.0000001192092896, "total_loss": 9.0, "curr_entropy_coeff": 0.0, "num_module_steps_trained_lifetime": 6139008, "curr_kl_coeff": 2.7465821403893642e-05}, "__all_modules__": {"num_env_steps_trained": 15728640, "num_module_steps_trained_lifetime": 6139008, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.784005878188836e-05, "numpy_to_tensor": 0.00016762275415536208, "add_observations_from_episodes_to_batch": 0.00642578085708937, "add_states_from_episodes_to_batch": 5.521457687617281e-06, "batch_individual_items": 0.03299172248041623, "general_advantage_estimation": 0.017985909596146092, "add_columns_from_episodes_to_train_batch": 0.04808316318287585, "add_one_ts_to_episodes_and_truncate": 0.042090831551786966}}, "connector_pipeline_timer": 0.14827547172981567}, "learner_connector_sum_episodes_length_out": 5474.503953818196, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 4096.0, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "num_env_steps_trained_lifetime": 368092997, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 110592, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 602.2902446128471, "done": false, "training_iteration": 27, "trial_id": "40149_00000", "date": "2025-05-17_14-56-18", "timestamp": 1747461378, "time_this_iter_s": 6.7894508838653564, "time_total_s": 166.2464051246643, "pid": 1464251, "hostname": "localhost.localdomain", "node_ip": "10.139.239.36", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MatmulEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4096, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f7796fcc220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 166.2464051246643, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 11.4, "ram_util_percent": 14.800000000000002}}
{"timers": {"training_iteration": 4.739741705096755, "restore_env_runners": 1.931012095134017e-05, "training_step": 4.739580708721521, "env_runner_sampling_timer": 0.590495720675695, "learner_update_timer": 4.13831490156896, "synch_weights": 0.001706975359306016, "synch_env_connectors": 0.002656433116835915}, "env_runners": {"episode_duration_sec_mean": 0.00036509972051135264, "num_module_steps_sampled": {"default_policy": 4096}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.4764676749669079e-05, "get_actions": 8.932467456132395e-05, "un_batch_to_individual_items": 9.192642419947098e-06, "remove_single_ts_time_rank_from_batch": 9.926583476890774e-07, "listify_data_for_vector_env": 1.5550063257298066e-05, "tensor_to_numpy": 2.86913028750687e-05}}, "connector_pipeline_timer": 0.00019248657506527327}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 8.546525550782065e-06, "add_time_dim_to_batch_and_zero_pad": 3.0420080881088746e-06, "numpy_to_tensor": 1.7725361655277195e-05, "add_observations_from_episodes_to_batch": 4.106402525779901e-06, "add_states_from_episodes_to_batch": 1.850823168528606e-06}}, "connector_pipeline_timer": 5.674778725683581e-05}, "num_episodes": 4096, "episode_len_min": 1, "time_between_sampling": 0.9627688032131391, "episode_len_mean": 1.0, "env_step_timer": 2.3027460711156763e-05, "num_episodes_lifetime": 97975, "agent_episode_returns_mean": {"default_agent": 51.0}, "episode_return_mean": 51.0, "weights_seq_no": 27.0, "num_env_steps_sampled_lifetime": 114688, "env_reset_timer": 0.00013909503468312323, "sample": 0.09888782091752991, "env_to_module_sum_episodes_length_out": 0.5041148382788944, "env_to_module_sum_episodes_length_in": 0.5041148382788944, "episode_len_max": 1, "rlmodule_inference_timer": 6.236661676445975e-05, "num_env_steps_sampled": 4096, "episode_return_max": 51.0, "num_module_steps_sampled_lifetime": {"default_policy": 114688}, "num_agent_steps_sampled": {"default_agent": 4096}, "episode_return_min": 51.0, "num_agent_steps_sampled_lifetime": {"default_agent": 114688}, "module_episode_returns_mean": {"default_policy": 51.0}, "num_env_steps_sampled_lifetime_throughput": 607.858827757438}, "learners": {"default_policy": {"vf_explained_var": -1.1920928955078125e-07, "gradients_default_optimizer_global_norm": 5.492810117857516e-08, "mean_kl_loss": 1.086346301804042e-08, "vf_loss_unclipped": 2627.69189453125, "module_train_batch_size_mean": 128.0, "vf_loss": 10.0, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 8.902097192731162e-08, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "weights_seq_no": 28.0, "policy_loss": -1.0000001192092896, "total_loss": 9.0, "curr_entropy_coeff": 0.0, "num_module_steps_trained_lifetime": 6384768, "curr_kl_coeff": 1.3732910701946821e-05}, "__all_modules__": {"num_env_steps_trained": 15728640, "num_module_steps_trained_lifetime": 6384768, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.783796437100546e-05, "numpy_to_tensor": 0.0001676018761772239, "add_observations_from_episodes_to_batch": 0.006457533043249466, "add_states_from_episodes_to_batch": 5.518078238425255e-06, "batch_individual_items": 0.03315431896943304, "general_advantage_estimation": 0.018002691759696442, "add_columns_from_episodes_to_train_batch": 0.04823844830871057, "add_one_ts_to_episodes_and_truncate": 0.0422331041570309}}, "connector_pipeline_timer": 0.1487845333762746}, "learner_connector_sum_episodes_length_out": 5479.423166761145, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 4096.0, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "num_env_steps_trained_lifetime": 383821637, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 114688, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 607.858827757438, "done": false, "training_iteration": 28, "trial_id": "40149_00000", "date": "2025-05-17_14-56-25", "timestamp": 1747461385, "time_this_iter_s": 6.731834411621094, "time_total_s": 172.9782395362854, "pid": 1464251, "hostname": "localhost.localdomain", "node_ip": "10.139.239.36", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MatmulEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4096, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f7796fcc220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 172.9782395362854, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 11.41, "ram_util_percent": 14.800000000000002}}
{"timers": {"training_iteration": 4.759524508465328, "restore_env_runners": 1.921168984568965e-05, "training_step": 4.759362917535314, "env_runner_sampling_timer": 0.5936149029090908, "learner_update_timer": 4.154870598784243, "synch_weights": 0.0017061552556381133, "synch_env_connectors": 0.002656100196115064}, "env_runners": {"episode_duration_sec_mean": 0.00035597003443399444, "num_module_steps_sampled": {"default_policy": 4096}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.4679436651565885e-05, "get_actions": 8.887407764976722e-05, "un_batch_to_individual_items": 9.136294263373263e-06, "remove_single_ts_time_rank_from_batch": 9.854265978268744e-07, "listify_data_for_vector_env": 1.545929595318294e-05, "tensor_to_numpy": 2.8538938248550122e-05}}, "connector_pipeline_timer": 0.00019137610247935312}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 8.46503596563076e-06, "add_time_dim_to_batch_and_zero_pad": 3.0218530639215883e-06, "numpy_to_tensor": 1.76271146776647e-05, "add_observations_from_episodes_to_batch": 4.077700910037915e-06, "add_states_from_episodes_to_batch": 1.8365932717024971e-06}}, "connector_pipeline_timer": 5.63068371517668e-05}, "num_episodes": 4096, "episode_len_min": 1, "time_between_sampling": 0.9863675170538193, "episode_len_mean": 1.0, "env_step_timer": 2.2909147083182406e-05, "num_episodes_lifetime": 102071, "agent_episode_returns_mean": {"default_agent": 51.0}, "episode_return_mean": 51.0, "weights_seq_no": 28.0, "num_env_steps_sampled_lifetime": 118784, "env_reset_timer": 0.00013909503468312323, "sample": 0.09963322763269732, "env_to_module_sum_episodes_length_out": 0.5036741810188553, "env_to_module_sum_episodes_length_in": 0.5036741810188553, "episode_len_max": 1, "rlmodule_inference_timer": 6.80356307360431e-05, "num_env_steps_sampled": 4096, "episode_return_max": 51.0, "num_module_steps_sampled_lifetime": {"default_policy": 118784}, "num_agent_steps_sampled": {"default_agent": 4096}, "episode_return_min": 51.0, "num_agent_steps_sampled_lifetime": {"default_agent": 118784}, "module_episode_returns_mean": {"default_policy": 51.0}, "num_env_steps_sampled_lifetime_throughput": 608.6054970959212}, "learners": {"default_policy": {"vf_explained_var": -1.1920928955078125e-07, "gradients_default_optimizer_global_norm": 2.153384137670855e-08, "mean_kl_loss": 4.183707158489369e-09, "vf_loss_unclipped": 2627.691650390625, "module_train_batch_size_mean": 128.0, "vf_loss": 10.0, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 3.668078818463982e-08, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "weights_seq_no": 29.0, "policy_loss": -1.0000001192092896, "total_loss": 9.0, "curr_entropy_coeff": 0.0, "num_module_steps_trained_lifetime": 6630528, "curr_kl_coeff": 6.8664553509734105e-06}, "__all_modules__": {"num_env_steps_trained": 15728640, "num_module_steps_trained_lifetime": 6630528, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.783571274393645e-05, "numpy_to_tensor": 0.00016758023758327076, "add_observations_from_episodes_to_batch": 0.0064899211746044455, "add_states_from_episodes_to_batch": 5.514634037740348e-06, "batch_individual_items": 0.03331581952391992, "general_advantage_estimation": 0.018020078418624418, "add_columns_from_episodes_to_train_batch": 0.04840994153060894, "add_one_ts_to_episodes_and_truncate": 0.04238054965181937}}, "connector_pipeline_timer": 0.1493151586219336}, "learner_connector_sum_episodes_length_out": 5484.515745049852, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 4096.0, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "num_env_steps_trained_lifetime": 399550277, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 118784, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 608.6054970959212, "done": false, "training_iteration": 29, "trial_id": "40149_00000", "date": "2025-05-17_14-56-32", "timestamp": 1747461392, "time_this_iter_s": 6.722679138183594, "time_total_s": 179.700918674469, "pid": 1464251, "hostname": "localhost.localdomain", "node_ip": "10.139.239.36", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MatmulEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4096, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f7796fcc220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 179.700918674469, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 11.5, "ram_util_percent": 14.822222222222223}}
{"timers": {"training_iteration": 4.780677093460777, "restore_env_runners": 1.9100022919534475e-05, "training_step": 4.780515071019349, "env_runner_sampling_timer": 0.5980758419094218, "learner_update_timer": 4.171449152526064, "synch_weights": 0.0017076067928261064, "synch_env_connectors": 0.0026541556749588935}, "env_runners": {"episode_duration_sec_mean": 0.0003500767816149164, "num_module_steps_sampled": {"default_policy": 4096}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.4680084231270347e-05, "get_actions": 8.888257419938897e-05, "un_batch_to_individual_items": 9.124885540583915e-06, "remove_single_ts_time_rank_from_batch": 9.844243990355484e-07, "listify_data_for_vector_env": 1.5449440516417032e-05, "tensor_to_numpy": 2.852433722396425e-05}}, "connector_pipeline_timer": 0.00019133296300862033}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 8.46118484921707e-06, "add_time_dim_to_batch_and_zero_pad": 3.021346928192083e-06, "numpy_to_tensor": 1.762974861624497e-05, "add_observations_from_episodes_to_batch": 4.078198371654828e-06, "add_states_from_episodes_to_batch": 1.8337179641966671e-06}}, "connector_pipeline_timer": 5.627956271698912e-05}, "num_episodes": 4096, "episode_len_min": 1, "time_between_sampling": 1.0092911827856588, "episode_len_mean": 1.0, "env_step_timer": 2.2913867440546275e-05, "num_episodes_lifetime": 106167, "agent_episode_returns_mean": {"default_agent": 51.0}, "episode_return_mean": 51.0, "weights_seq_no": 29.0, "num_env_steps_sampled_lifetime": 122880, "env_reset_timer": 0.00013909503468312323, "sample": 0.10039283396628523, "env_to_module_sum_episodes_length_out": 0.5033547131704298, "env_to_module_sum_episodes_length_in": 0.5033547131704298, "episode_len_max": 1, "rlmodule_inference_timer": 8.025070334996743e-05, "num_env_steps_sampled": 4096, "episode_return_max": 51.0, "num_module_steps_sampled_lifetime": {"default_policy": 122880}, "num_agent_steps_sampled": {"default_agent": 4096}, "episode_return_min": 51.0, "num_agent_steps_sampled_lifetime": {"default_agent": 122880}, "module_episode_returns_mean": {"default_policy": 51.0}, "num_env_steps_sampled_lifetime_throughput": 594.7290725518577}, "learners": {"default_policy": {"vf_explained_var": 0.0, "gradients_default_optimizer_global_norm": 8.688991748329045e-09, "mean_kl_loss": 1.5891243876353656e-09, "vf_loss_unclipped": 2627.69140625, "module_train_batch_size_mean": 128.0, "vf_loss": 10.0, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 1.5561321120571847e-08, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "weights_seq_no": 30.0, "policy_loss": -1.0000001192092896, "total_loss": 9.0, "curr_entropy_coeff": 0.0, "num_module_steps_trained_lifetime": 6876288, "curr_kl_coeff": 3.4332276754867053e-06}, "__all_modules__": {"num_env_steps_trained": 15728640, "num_module_steps_trained_lifetime": 6876288, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.7833959448003607e-05, "numpy_to_tensor": 0.00016755766037527287, "add_observations_from_episodes_to_batch": 0.006522851352328403, "add_states_from_episodes_to_batch": 5.511110711430585e-06, "batch_individual_items": 0.03349250098532432, "general_advantage_estimation": 0.018038097430594546, "add_columns_from_episodes_to_train_batch": 0.04858153921132823, "add_one_ts_to_episodes_and_truncate": 0.042533143853698836}}, "connector_pipeline_timer": 0.14986739896664247}, "learner_connector_sum_episodes_length_out": 5489.777729456109, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 4096.0, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "num_env_steps_trained_lifetime": 415278917, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 122880, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 594.7290725518577, "done": false, "training_iteration": 30, "trial_id": "40149_00000", "date": "2025-05-17_14-56-38", "timestamp": 1747461398, "time_this_iter_s": 6.882869243621826, "time_total_s": 186.58378791809082, "pid": 1464251, "hostname": "localhost.localdomain", "node_ip": "10.139.239.36", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MatmulEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4096, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f7796fcc220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 186.58378791809082, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 11.940000000000001, "ram_util_percent": 14.800000000000002}}
{"timers": {"training_iteration": 4.803103151835703, "restore_env_runners": 1.9028743043152734e-05, "training_step": 4.802940504928722, "env_runner_sampling_timer": 0.6028069729505448, "learner_update_timer": 4.189016792810545, "synch_weights": 0.001708975175004317, "synch_env_connectors": 0.00268571927776021}, "env_runners": {"episode_duration_sec_mean": 0.0004182265874987934, "num_module_steps_sampled": {"default_policy": 4096}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.53262222257289e-05, "get_actions": 9.251008617143112e-05, "un_batch_to_individual_items": 9.524458822545277e-06, "remove_single_ts_time_rank_from_batch": 1.039312628475158e-06, "listify_data_for_vector_env": 1.6135635275021882e-05, "tensor_to_numpy": 2.9671659123992685e-05}}, "connector_pipeline_timer": 0.0001997227951448076}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 9.028482831638148e-06, "add_time_dim_to_batch_and_zero_pad": 3.1589353878230485e-06, "numpy_to_tensor": 1.840293848343836e-05, "add_observations_from_episodes_to_batch": 4.275485027692978e-06, "add_states_from_episodes_to_batch": 1.9227251173716986e-06}}, "connector_pipeline_timer": 5.929877200035139e-05}, "num_episodes": 4096, "episode_len_min": 1, "time_between_sampling": 1.0315338508201697, "episode_len_mean": 1.0, "env_step_timer": 2.389565799708165e-05, "num_episodes_lifetime": 110263, "agent_episode_returns_mean": {"default_agent": 51.0}, "episode_return_mean": 51.0, "weights_seq_no": 30.0, "num_env_steps_sampled_lifetime": 126976, "env_reset_timer": 0.00013909503468312323, "sample": 0.10123172429600123, "env_to_module_sum_episodes_length_out": 0.5031231052623507, "env_to_module_sum_episodes_length_in": 0.5031231052623507, "episode_len_max": 1, "rlmodule_inference_timer": 8.162216044587664e-05, "num_env_steps_sampled": 4096, "episode_return_max": 51.0, "num_module_steps_sampled_lifetime": {"default_policy": 126976}, "num_agent_steps_sampled": {"default_agent": 4096}, "episode_return_min": 51.0, "num_agent_steps_sampled_lifetime": {"default_agent": 126976}, "module_episode_returns_mean": {"default_policy": 51.0}, "num_env_steps_sampled_lifetime_throughput": 581.8393607651523}, "learners": {"default_policy": {"vf_explained_var": -1.1920928955078125e-07, "gradients_default_optimizer_global_norm": 3.735987963437992e-09, "mean_kl_loss": 5.9703109123177e-10, "vf_loss_unclipped": 2627.691650390625, "module_train_batch_size_mean": 128.0, "vf_loss": 10.0, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 7.039427707411505e-09, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "weights_seq_no": 31.0, "policy_loss": -1.0000001192092896, "total_loss": 9.0, "curr_entropy_coeff": 0.0, "num_module_steps_trained_lifetime": 7122048, "curr_kl_coeff": 1.7166138377433526e-06}, "__all_modules__": {"num_env_steps_trained": 15728640, "num_module_steps_trained_lifetime": 7122048, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.7832459349966177e-05, "numpy_to_tensor": 0.00016753472449246287, "add_observations_from_episodes_to_batch": 0.006556417334184134, "add_states_from_episodes_to_batch": 5.5075061933829945e-06, "batch_individual_items": 0.033685730762548466, "general_advantage_estimation": 0.01805671452368676, "add_columns_from_episodes_to_train_batch": 0.048753291274479714, "add_one_ts_to_episodes_and_truncate": 0.04269084008767379}}, "connector_pipeline_timer": 0.15044270694429546}, "learner_connector_sum_episodes_length_out": 5495.205222599737, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 4096.0, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "num_env_steps_trained_lifetime": 431007557, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 126976, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 581.8393607651523, "done": false, "training_iteration": 31, "trial_id": "40149_00000", "date": "2025-05-17_14-56-45", "timestamp": 1747461405, "time_this_iter_s": 7.027887344360352, "time_total_s": 193.61167526245117, "pid": 1464251, "hostname": "localhost.localdomain", "node_ip": "10.139.239.36", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MatmulEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4096, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f7796fcc220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 193.61167526245117, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 20.330000000000002, "ram_util_percent": 14.88}}
{"timers": {"training_iteration": 4.824840313306632, "restore_env_runners": 1.8933935967224006e-05, "training_step": 4.824677418159452, "env_runner_sampling_timer": 0.6084472710201779, "learner_update_timer": 4.205011601773076, "synch_weights": 0.0017094474335797652, "synch_env_connectors": 0.002683089654793654}, "env_runners": {"episode_duration_sec_mean": 0.0004411318732309155, "num_module_steps_sampled": {"default_policy": 4096}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.5962115712354375e-05, "get_actions": 9.603463761327691e-05, "un_batch_to_individual_items": 9.92771402241927e-06, "remove_single_ts_time_rank_from_batch": 1.096210520837608e-06, "listify_data_for_vector_env": 1.6830455060075633e-05, "tensor_to_numpy": 3.0834614344976105e-05}}, "connector_pipeline_timer": 0.00020809525961056204}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 9.599498779769185e-06, "add_time_dim_to_batch_and_zero_pad": 3.299983027051593e-06, "numpy_to_tensor": 1.9197811250407738e-05, "add_observations_from_episodes_to_batch": 4.481624295397249e-06, "add_states_from_episodes_to_batch": 2.01668540537087e-06}}, "connector_pipeline_timer": 6.240139719169968e-05}, "num_episodes": 4096, "episode_len_min": 1, "time_between_sampling": 1.0534453263005739, "episode_len_mean": 1.0, "env_step_timer": 2.488851191067525e-05, "num_episodes_lifetime": 114359, "agent_episode_returns_mean": {"default_agent": 51.0}, "episode_return_mean": 51.0, "weights_seq_no": 31.0, "num_env_steps_sampled_lifetime": 131072, "env_reset_timer": 0.00013909503468312323, "sample": 0.10223502275254855, "env_to_module_sum_episodes_length_out": 0.5029551940833411, "env_to_module_sum_episodes_length_in": 0.5029551940833411, "episode_len_max": 1, "rlmodule_inference_timer": 7.976653457350788e-05, "num_env_steps_sampled": 4096, "episode_return_max": 51.0, "num_module_steps_sampled_lifetime": {"default_policy": 131072}, "num_agent_steps_sampled": {"default_agent": 4096}, "episode_return_min": 51.0, "num_agent_steps_sampled_lifetime": {"default_agent": 131072}, "module_episode_returns_mean": {"default_policy": 51.0}, "num_env_steps_sampled_lifetime_throughput": 586.0898515025947}, "learners": {"default_policy": {"vf_explained_var": -1.1920928955078125e-07, "gradients_default_optimizer_global_norm": 1.794792758857966e-09, "mean_kl_loss": 2.24479199117944e-10, "vf_loss_unclipped": 2627.69140625, "module_train_batch_size_mean": 128.0, "vf_loss": 10.0, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 3.5485543392610452e-09, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "weights_seq_no": 32.0, "policy_loss": -1.0000001192092896, "total_loss": 9.0, "curr_entropy_coeff": 0.0, "num_module_steps_trained_lifetime": 7367808, "curr_kl_coeff": 8.583069188716763e-07}, "__all_modules__": {"num_env_steps_trained": 15728640, "num_module_steps_trained_lifetime": 7367808, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.783104435855618e-05, "numpy_to_tensor": 0.0001675126205624792, "add_observations_from_episodes_to_batch": 0.006590583698769749, "add_states_from_episodes_to_batch": 5.503814462032353e-06, "batch_individual_items": 0.033877513937729586, "general_advantage_estimation": 0.018075959475779974, "add_columns_from_episodes_to_train_batch": 0.04892516465374812, "add_one_ts_to_episodes_and_truncate": 0.04285331222157977}}, "connector_pipeline_timer": 0.15102272371770717}, "learner_connector_sum_episodes_length_out": 5500.794388107546, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 4096.0, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "num_env_steps_trained_lifetime": 446736197, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 131072, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 586.0898515025947, "done": false, "training_iteration": 32, "trial_id": "40149_00000", "date": "2025-05-17_14-56-52", "timestamp": 1747461412, "time_this_iter_s": 6.981005668640137, "time_total_s": 200.5926809310913, "pid": 1464251, "hostname": "localhost.localdomain", "node_ip": "10.139.239.36", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MatmulEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4096, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f7796fcc220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 200.5926809310913, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 18.95, "ram_util_percent": 14.9}}
{"timers": {"training_iteration": 4.84431241808311, "restore_env_runners": 1.8831456407473277e-05, "training_step": 4.844149088918259, "env_runner_sampling_timer": 0.611156130940279, "learner_update_timer": 4.221673625675443, "synch_weights": 0.0017088272395175093, "synch_env_connectors": 0.002679366828263487}, "env_runners": {"episode_duration_sec_mean": 0.00037639986840076745, "num_module_steps_sampled": {"default_policy": 4096}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.5721319567960084e-05, "get_actions": 9.476769811127957e-05, "un_batch_to_individual_items": 9.781733541020069e-06, "remove_single_ts_time_rank_from_batch": 1.0748850251245669e-06, "listify_data_for_vector_env": 1.658186788737197e-05, "tensor_to_numpy": 3.0403504174236933e-05}}, "connector_pipeline_timer": 0.00020505721557195398}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 9.39367665275074e-06, "add_time_dim_to_batch_and_zero_pad": 3.249556439565994e-06, "numpy_to_tensor": 1.8918134791451957e-05, "add_observations_from_episodes_to_batch": 4.408802001358494e-06, "add_states_from_episodes_to_batch": 1.984267523713531e-06}}, "connector_pipeline_timer": 6.129195591566999e-05}, "num_episodes": 4096, "episode_len_min": 1, "time_between_sampling": 1.074730200841006, "episode_len_mean": 1.0, "env_step_timer": 2.4524949466413854e-05, "num_episodes_lifetime": 118455, "agent_episode_returns_mean": {"default_agent": 51.0}, "episode_return_mean": 51.0, "weights_seq_no": 32.0, "num_env_steps_sampled_lifetime": 135168, "env_reset_timer": 0.00013909503468312323, "sample": 0.10319402124021884, "env_to_module_sum_episodes_length_out": 0.5028334617803715, "env_to_module_sum_episodes_length_in": 0.5028334617803715, "episode_len_max": 1, "rlmodule_inference_timer": 7.516436165394338e-05, "num_env_steps_sampled": 4096, "episode_return_max": 51.0, "num_module_steps_sampled_lifetime": {"default_policy": 135168}, "num_agent_steps_sampled": {"default_agent": 4096}, "episode_return_min": 51.0, "num_agent_steps_sampled_lifetime": {"default_agent": 135168}, "module_episode_returns_mean": {"default_policy": 51.0}, "num_env_steps_sampled_lifetime_throughput": 603.8202603665926}, "learners": {"default_policy": {"vf_explained_var": -1.1920928955078125e-07, "gradients_default_optimizer_global_norm": 9.979399528958766e-10, "mean_kl_loss": 8.75881658868316e-11, "vf_loss_unclipped": 2627.69140625, "module_train_batch_size_mean": 128.0, "vf_loss": 10.0, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 2.052273240238378e-09, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "weights_seq_no": 33.0, "policy_loss": -1.0000001192092896, "total_loss": 9.0, "curr_entropy_coeff": 0.0, "num_module_steps_trained_lifetime": 7613568, "curr_kl_coeff": 4.2915345943583816e-07}, "__all_modules__": {"num_env_steps_trained": 15728640, "num_module_steps_trained_lifetime": 7613568, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.7829810023670807e-05, "numpy_to_tensor": 0.00016749092144276395, "add_observations_from_episodes_to_batch": 0.00662524435232904, "add_states_from_episodes_to_batch": 5.500027517246592e-06, "batch_individual_items": 0.034067987484928564, "general_advantage_estimation": 0.01809564368548277, "add_columns_from_episodes_to_train_batch": 0.04911302908170137, "add_one_ts_to_episodes_and_truncate": 0.043020599506996916}}, "connector_pipeline_timer": 0.1516231890291551}, "learner_connector_sum_episodes_length_out": 5506.54144978294, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 4096.0, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "num_env_steps_trained_lifetime": 462464837, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 135168, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 603.8202603665926, "done": false, "training_iteration": 33, "trial_id": "40149_00000", "date": "2025-05-17_14-56-59", "timestamp": 1747461419, "time_this_iter_s": 6.776342153549194, "time_total_s": 207.3690230846405, "pid": 1464251, "hostname": "localhost.localdomain", "node_ip": "10.139.239.36", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MatmulEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4096, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f7796fcc220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 207.3690230846405, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 11.290000000000001, "ram_util_percent": 14.88}}
{"timers": {"training_iteration": 4.863142162511568, "restore_env_runners": 1.8717781526987884e-05, "training_step": 4.8629787868991485, "env_runner_sampling_timer": 0.6136461302910484, "learner_update_timer": 4.2379033328593145, "synch_weights": 0.0017086754069103032, "synch_env_connectors": 0.002675199630289603}, "env_runners": {"episode_duration_sec_mean": 0.0003565141996659804, "num_module_steps_sampled": {"default_policy": 4096}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.5477399472179234e-05, "get_actions": 9.332280447693813e-05, "un_batch_to_individual_items": 9.628931039589947e-06, "remove_single_ts_time_rank_from_batch": 1.0543056627178469e-06, "listify_data_for_vector_env": 1.6320190831837443e-05, "tensor_to_numpy": 2.9958002590417593e-05}}, "connector_pipeline_timer": 0.00020179432795657765}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 9.178571699579117e-06, "add_time_dim_to_batch_and_zero_pad": 3.1985133181885836e-06, "numpy_to_tensor": 1.8609169844642766e-05, "add_observations_from_episodes_to_batch": 4.3302066941251275e-06, "add_states_from_episodes_to_batch": 1.9511441278099015e-06}}, "connector_pipeline_timer": 6.014636674087767e-05}, "num_episodes": 4096, "episode_len_min": 1, "time_between_sampling": 1.094969669206556, "episode_len_mean": 1.0, "env_step_timer": 2.4137825310573127e-05, "num_episodes_lifetime": 122551, "agent_episode_returns_mean": {"default_agent": 51.0}, "episode_return_mean": 51.0, "weights_seq_no": 33.0, "num_env_steps_sampled_lifetime": 139264, "env_reset_timer": 0.00013909503468312323, "sample": 0.10400272884909684, "env_to_module_sum_episodes_length_out": 0.5027452082544674, "env_to_module_sum_episodes_length_in": 0.5027452082544674, "episode_len_max": 1, "rlmodule_inference_timer": 7.146517839370551e-05, "num_env_steps_sampled": 4096, "episode_return_max": 51.0, "num_module_steps_sampled_lifetime": {"default_policy": 139264}, "num_agent_steps_sampled": {"default_agent": 4096}, "episode_return_min": 51.0, "num_agent_steps_sampled_lifetime": {"default_agent": 139264}, "module_episode_returns_mean": {"default_policy": 51.0}, "num_env_steps_sampled_lifetime_throughput": 607.7812679745832}, "learners": {"default_policy": {"vf_explained_var": -1.1920928955078125e-07, "gradients_default_optimizer_global_norm": 6.398282459407767e-10, "mean_kl_loss": 3.752391800060373e-11, "vf_loss_unclipped": 2627.691650390625, "module_train_batch_size_mean": 128.0, "vf_loss": 10.0, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 1.35317901328591e-09, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "weights_seq_no": 34.0, "policy_loss": -1.0000001192092896, "total_loss": 9.0, "curr_entropy_coeff": 0.0, "num_module_steps_trained_lifetime": 7859328, "curr_kl_coeff": 2.1457672971791908e-07}, "__all_modules__": {"num_env_steps_trained": 15728640, "num_module_steps_trained_lifetime": 7859328, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.7828298073940922e-05, "numpy_to_tensor": 0.0001674683569421851, "add_observations_from_episodes_to_batch": 0.00666037239404218, "add_states_from_episodes_to_batch": 5.496141637078476e-06, "batch_individual_items": 0.03425679825748445, "general_advantage_estimation": 0.018115936985453794, "add_columns_from_episodes_to_train_batch": 0.049316864673327306, "add_one_ts_to_episodes_and_truncate": 0.043192156099276374}}, "connector_pipeline_timer": 0.1522432987804095}, "learner_connector_sum_episodes_length_out": 5512.442690786013, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 4096.0, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "num_env_steps_trained_lifetime": 478193477, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 139264, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 607.7812679745832, "done": false, "training_iteration": 34, "trial_id": "40149_00000", "date": "2025-05-17_14-57-06", "timestamp": 1747461426, "time_this_iter_s": 6.73154878616333, "time_total_s": 214.10057187080383, "pid": 1464251, "hostname": "localhost.localdomain", "node_ip": "10.139.239.36", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MatmulEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4096, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f7796fcc220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 214.10057187080383, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 11.21111111111111, "ram_util_percent": 14.811111111111112}}
{"timers": {"training_iteration": 4.881832877936084, "restore_env_runners": 1.8635093447976987e-05, "training_step": 4.88166901020912, "env_runner_sampling_timer": 0.6156518913986715, "learner_update_timer": 4.254487757790543, "synch_weights": 0.0017096775426151353, "synch_env_connectors": 0.002670451843445535}, "env_runners": {"episode_duration_sec_mean": 0.0003511504728521686, "num_module_steps_sampled": {"default_policy": 4096}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.5163919704969553e-05, "get_actions": 9.158048274526671e-05, "un_batch_to_individual_items": 9.436380230276962e-06, "remove_single_ts_time_rank_from_batch": 1.0274625357909488e-06, "listify_data_for_vector_env": 1.597440656943143e-05, "tensor_to_numpy": 2.9401475066582012e-05}}, "connector_pipeline_timer": 0.0001976831771589937}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 8.890657540701302e-06, "add_time_dim_to_batch_and_zero_pad": 3.1265747142553476e-06, "numpy_to_tensor": 1.8217457303540567e-05, "add_observations_from_episodes_to_batch": 4.229574253001809e-06, "add_states_from_episodes_to_batch": 1.903276172618185e-06}}, "connector_pipeline_timer": 5.860489672701715e-05}, "num_episodes": 4096, "episode_len_min": 1, "time_between_sampling": 1.114117097351974, "episode_len_mean": 1.0, "env_step_timer": 2.366189736596723e-05, "num_episodes_lifetime": 126647, "agent_episode_returns_mean": {"default_agent": 51.0}, "episode_return_mean": 51.0, "weights_seq_no": 34.0, "num_env_steps_sampled_lifetime": 143360, "env_reset_timer": 0.00013909503468312323, "sample": 0.10467215396924194, "env_to_module_sum_episodes_length_out": 0.5026812261836082, "env_to_module_sum_episodes_length_in": 0.5026812261836082, "episode_len_max": 1, "rlmodule_inference_timer": 6.821982047877627e-05, "num_env_steps_sampled": 4096, "episode_return_max": 51.0, "num_module_steps_sampled_lifetime": {"default_policy": 143360}, "num_agent_steps_sampled": {"default_agent": 4096}, "episode_return_min": 51.0, "num_agent_steps_sampled_lifetime": {"default_agent": 143360}, "module_episode_returns_mean": {"default_policy": 51.0}, "num_env_steps_sampled_lifetime_throughput": 607.3787768163019}, "learners": {"default_policy": {"vf_explained_var": -1.1920928955078125e-07, "gradients_default_optimizer_global_norm": 4.5788597913265505e-10, "mean_kl_loss": 1.8366376128287065e-11, "vf_loss_unclipped": 2627.69140625, "module_train_batch_size_mean": 128.0, "vf_loss": 10.0, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 9.869913775162331e-10, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "weights_seq_no": 35.0, "policy_loss": -1.0000001192092896, "total_loss": 9.0, "curr_entropy_coeff": 0.0, "num_module_steps_trained_lifetime": 8105088, "curr_kl_coeff": 1.0728836485895954e-07}, "__all_modules__": {"num_env_steps_trained": 15728640, "num_module_steps_trained_lifetime": 8105088, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.782656928446873e-05, "numpy_to_tensor": 0.00016744461594204096, "add_observations_from_episodes_to_batch": 0.006695957508679506, "add_states_from_episodes_to_batch": 5.4921450693931235e-06, "batch_individual_items": 0.0344440944348349, "general_advantage_estimation": 0.018136679957061388, "add_columns_from_episodes_to_train_batch": 0.049535387823911266, "add_one_ts_to_episodes_and_truncate": 0.043368031643962884}}, "connector_pipeline_timer": 0.15288181932953482}, "learner_connector_sum_episodes_length_out": 5518.4944528240485, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 4096.0, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "num_env_steps_trained_lifetime": 493922117, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 143360, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 607.3787768163019, "done": false, "training_iteration": 35, "trial_id": "40149_00000", "date": "2025-05-17_14-57-13", "timestamp": 1747461433, "time_this_iter_s": 6.736486434936523, "time_total_s": 220.83705830574036, "pid": 1464251, "hostname": "localhost.localdomain", "node_ip": "10.139.239.36", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MatmulEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4096, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f7796fcc220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 220.83705830574036, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 11.170000000000002, "ram_util_percent": 14.810000000000002}}
{"timers": {"training_iteration": 4.900449509286627, "restore_env_runners": 1.8535902664949045e-05, "training_step": 4.900285319666707, "env_runner_sampling_timer": 0.6178923891054139, "learner_update_timer": 4.270780657463084, "synch_weights": 0.00171027071678901, "synch_env_connectors": 0.0026677368452795946}, "env_runners": {"episode_duration_sec_mean": 0.00035114484489895403, "num_module_steps_sampled": {"default_policy": 4096}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.497405948909834e-05, "get_actions": 9.04850085731018e-05, "un_batch_to_individual_items": 9.317322254381865e-06, "remove_single_ts_time_rank_from_batch": 1.012148011396713e-06, "listify_data_for_vector_env": 1.576455057270519e-05, "tensor_to_numpy": 2.9049853750971123e-05}}, "connector_pipeline_timer": 0.0001951370998054572}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 8.711464107845405e-06, "add_time_dim_to_batch_and_zero_pad": 3.0857527780808076e-06, "numpy_to_tensor": 1.7978522126123217e-05, "add_observations_from_episodes_to_batch": 4.170548156641796e-06, "add_states_from_episodes_to_batch": 1.8740082623546217e-06}}, "connector_pipeline_timer": 5.76598718525964e-05}, "num_episodes": 4096, "episode_len_min": 1, "time_between_sampling": 1.132348715134873, "episode_len_mean": 1.0, "env_step_timer": 2.335290749942416e-05, "num_episodes_lifetime": 130743, "agent_episode_returns_mean": {"default_agent": 51.0}, "episode_return_mean": 51.0, "weights_seq_no": 35.0, "num_env_steps_sampled_lifetime": 147456, "env_reset_timer": 0.00013909503468312323, "sample": 0.10524315324057486, "env_to_module_sum_episodes_length_out": 0.5026348404403818, "env_to_module_sum_episodes_length_in": 0.5026348404403818, "episode_len_max": 1, "rlmodule_inference_timer": 6.595639803547306e-05, "num_env_steps_sampled": 4096, "episode_return_max": 51.0, "num_module_steps_sampled_lifetime": {"default_policy": 147456}, "num_agent_steps_sampled": {"default_agent": 4096}, "episode_return_min": 51.0, "num_agent_steps_sampled_lifetime": {"default_agent": 147456}, "module_episode_returns_mean": {"default_policy": 51.0}, "num_env_steps_sampled_lifetime_throughput": 606.3599259334172}, "learners": {"default_policy": {"vf_explained_var": -1.1920928955078125e-07, "gradients_default_optimizer_global_norm": 3.5343750148797426e-10, "mean_kl_loss": 1.0266914055034881e-11, "vf_loss_unclipped": 2627.69189453125, "module_train_batch_size_mean": 128.0, "vf_loss": 10.0, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 7.721001615834666e-10, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "weights_seq_no": 36.0, "policy_loss": -1.0000001192092896, "total_loss": 9.0, "curr_entropy_coeff": 0.0, "num_module_steps_trained_lifetime": 8350848, "curr_kl_coeff": 5.364418242947977e-08}, "__all_modules__": {"num_env_steps_trained": 15728640, "num_module_steps_trained_lifetime": 8350848, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.782462703729849e-05, "numpy_to_tensor": 0.00016741985242532532, "add_observations_from_episodes_to_batch": 0.006731955496976814, "add_states_from_episodes_to_batch": 5.488036516615616e-06, "batch_individual_items": 0.03462991140960753, "general_advantage_estimation": 0.01815797514973474, "add_columns_from_episodes_to_train_batch": 0.04976875342790914, "add_one_ts_to_episodes_and_truncate": 0.04354826087265218}}, "connector_pipeline_timer": 0.1535390284512993}, "learner_connector_sum_episodes_length_out": 5524.693135352244, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 4096.0, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "num_env_steps_trained_lifetime": 509650757, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 147456, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 606.3599259334172, "done": false, "training_iteration": 36, "trial_id": "40149_00000", "date": "2025-05-17_14-57-19", "timestamp": 1747461439, "time_this_iter_s": 6.749399423599243, "time_total_s": 227.5864577293396, "pid": 1464251, "hostname": "localhost.localdomain", "node_ip": "10.139.239.36", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MatmulEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4096, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f7796fcc220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 227.5864577293396, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 11.322222222222223, "ram_util_percent": 14.822222222222223}}
{"timers": {"training_iteration": 4.919090156893819, "restore_env_runners": 1.8436703782136885e-05, "training_step": 4.918925608629835, "env_runner_sampling_timer": 0.6203353477335788, "learner_update_timer": 4.286896483608612, "synch_weights": 0.0017092810100773634, "synch_env_connectors": 0.0026802126271095986}, "env_runners": {"episode_duration_sec_mean": 0.0003534438365022652, "num_module_steps_sampled": {"default_policy": 4096}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.4998062656352992e-05, "get_actions": 9.061731421070904e-05, "un_batch_to_individual_items": 9.332806268097195e-06, "remove_single_ts_time_rank_from_batch": 1.0139907453922073e-06, "listify_data_for_vector_env": 1.5804061307840728e-05, "tensor_to_numpy": 2.908828276975096e-05}}, "connector_pipeline_timer": 0.0001954664336527495}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 8.749420587764901e-06, "add_time_dim_to_batch_and_zero_pad": 3.088481831432461e-06, "numpy_to_tensor": 1.8004536531544798e-05, "add_observations_from_episodes_to_batch": 4.175058447938724e-06, "add_states_from_episodes_to_batch": 1.8784664402748386e-06}}, "connector_pipeline_timer": 5.778270374883763e-05}, "num_episodes": 4096, "episode_len_min": 1, "time_between_sampling": 1.1499851193733046, "episode_len_mean": 1.0, "env_step_timer": 2.339864137861963e-05, "num_episodes_lifetime": 134839, "agent_episode_returns_mean": {"default_agent": 51.0}, "episode_return_mean": 51.0, "weights_seq_no": 36.0, "num_env_steps_sampled_lifetime": 151552, "env_reset_timer": 0.00013909503468312323, "sample": 0.10580057576997452, "env_to_module_sum_episodes_length_out": 0.5026012116886733, "env_to_module_sum_episodes_length_in": 0.5026012116886733, "episode_len_max": 1, "rlmodule_inference_timer": 6.507201021825009e-05, "num_env_steps_sampled": 4096, "episode_return_max": 51.0, "num_module_steps_sampled_lifetime": {"default_policy": 151552}, "num_agent_steps_sampled": {"default_agent": 4096}, "episode_return_min": 51.0, "num_agent_steps_sampled_lifetime": {"default_agent": 151552}, "module_episode_returns_mean": {"default_policy": 51.0}, "num_env_steps_sampled_lifetime_throughput": 604.3225705366037}, "learners": {"default_policy": {"vf_explained_var": -1.1920928955078125e-07, "gradients_default_optimizer_global_norm": 2.8710009369881107e-10, "mean_kl_loss": 6.399543221735637e-12, "vf_loss_unclipped": 2627.69140625, "module_train_batch_size_mean": 128.0, "vf_loss": 10.0, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 6.334621716064248e-10, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "weights_seq_no": 37.0, "policy_loss": -1.0000001192092896, "total_loss": 9.0, "curr_entropy_coeff": 0.0, "num_module_steps_trained_lifetime": 8596608, "curr_kl_coeff": 2.6822091214739885e-08}, "__all_modules__": {"num_env_steps_trained": 15728640, "num_module_steps_trained_lifetime": 8596608, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.7822492887515415e-05, "numpy_to_tensor": 0.00016739471941917277, "add_observations_from_episodes_to_batch": 0.006768374255858568, "add_states_from_episodes_to_batch": 5.483887710598069e-06, "batch_individual_items": 0.03481428075994461, "general_advantage_estimation": 0.018179912114559257, "add_columns_from_episodes_to_train_batch": 0.050017342442047384, "add_one_ts_to_episodes_and_truncate": 0.043732621989411066}}, "connector_pipeline_timer": 0.15421521641110203}, "learner_connector_sum_episodes_length_out": 5531.035194784594, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 4096.0, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "num_env_steps_trained_lifetime": 525379397, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 151552, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 604.3225705366037, "done": false, "training_iteration": 37, "trial_id": "40149_00000", "date": "2025-05-17_14-57-26", "timestamp": 1747461446, "time_this_iter_s": 6.770492315292358, "time_total_s": 234.35695004463196, "pid": 1464251, "hostname": "localhost.localdomain", "node_ip": "10.139.239.36", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MatmulEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4096, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f7796fcc220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 234.35695004463196, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 11.010000000000002, "ram_util_percent": 14.800000000000002}}
{"timers": {"training_iteration": 4.938791068504824, "restore_env_runners": 1.833809758359898e-05, "training_step": 4.938626102774129, "env_runner_sampling_timer": 0.6234568019159659, "learner_update_timer": 4.303375079912838, "synch_weights": 0.0017097889800967094, "synch_env_connectors": 0.0026943768418776688}, "env_runners": {"episode_duration_sec_mean": 0.00037639350193785504, "num_module_steps_sampled": {"default_policy": 4096}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.4989830926863657e-05, "get_actions": 9.063384677065533e-05, "un_batch_to_individual_items": 9.330258767994676e-06, "remove_single_ts_time_rank_from_batch": 1.0139280374298626e-06, "listify_data_for_vector_env": 1.5809008131564233e-05, "tensor_to_numpy": 2.9086328014148655e-05}}, "connector_pipeline_timer": 0.0001954880165926746}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 8.751294843349427e-06, "add_time_dim_to_batch_and_zero_pad": 3.0886151462564744e-06, "numpy_to_tensor": 1.800251963950603e-05, "add_observations_from_episodes_to_batch": 4.1742855563834956e-06, "add_states_from_episodes_to_batch": 1.8798926433443709e-06}}, "connector_pipeline_timer": 5.7798331559890774e-05}, "num_episodes": 4096, "episode_len_min": 1, "time_between_sampling": 1.166841539977113, "episode_len_mean": 1.0, "env_step_timer": 2.338712938990137e-05, "num_episodes_lifetime": 138935, "agent_episode_returns_mean": {"default_agent": 51.0}, "episode_return_mean": 51.0, "weights_seq_no": 37.0, "num_env_steps_sampled_lifetime": 155648, "env_reset_timer": 0.00013909503468312323, "sample": 0.10630413472343991, "env_to_module_sum_episodes_length_out": 0.5025768315049619, "env_to_module_sum_episodes_length_in": 0.5025768315049619, "episode_len_max": 1, "rlmodule_inference_timer": 6.437645778301872e-05, "num_env_steps_sampled": 4096, "episode_return_max": 51.0, "num_module_steps_sampled_lifetime": {"default_policy": 155648}, "num_agent_steps_sampled": {"default_agent": 4096}, "episode_return_min": 51.0, "num_agent_steps_sampled_lifetime": {"default_agent": 155648}, "module_episode_returns_mean": {"default_policy": 51.0}, "num_env_steps_sampled_lifetime_throughput": 593.4383121537478}, "learners": {"default_policy": {"vf_explained_var": -1.1920928955078125e-07, "gradients_default_optimizer_global_norm": 2.416013222816815e-10, "mean_kl_loss": 4.33018898515769e-12, "vf_loss_unclipped": 2627.69140625, "module_train_batch_size_mean": 128.0, "vf_loss": 10.0, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 5.372675082604417e-10, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "weights_seq_no": 38.0, "policy_loss": -1.0000001192092896, "total_loss": 9.0, "curr_entropy_coeff": 0.0, "num_module_steps_trained_lifetime": 8842368, "curr_kl_coeff": 1.3411045607369942e-08}, "__all_modules__": {"num_env_steps_trained": 15728640, "num_module_steps_trained_lifetime": 8842368, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.782031005355526e-05, "numpy_to_tensor": 0.00016736864368865976, "add_observations_from_episodes_to_batch": 0.006805371083417441, "add_states_from_episodes_to_batch": 5.479640774843201e-06, "batch_individual_items": 0.03501330199093982, "general_advantage_estimation": 0.018202419051378538, "add_columns_from_episodes_to_train_batch": 0.05026393354246253, "add_one_ts_to_episodes_and_truncate": 0.04392125361455074}}, "connector_pipeline_timer": 0.15490951748075793}, "learner_connector_sum_episodes_length_out": 5537.51714371476, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 4096.0, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "num_env_steps_trained_lifetime": 541108037, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 155648, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 593.4383121537478, "done": false, "training_iteration": 38, "trial_id": "40149_00000", "date": "2025-05-17_14-57-33", "timestamp": 1747461453, "time_this_iter_s": 6.893554449081421, "time_total_s": 241.25050449371338, "pid": 1464251, "hostname": "localhost.localdomain", "node_ip": "10.139.239.36", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MatmulEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4096, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f7796fcc220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 241.25050449371338, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 11.21, "ram_util_percent": 14.800000000000002}}
{"timers": {"training_iteration": 4.957698448449388, "restore_env_runners": 1.8245986220075307e-05, "training_step": 4.957533242946014, "env_runner_sampling_timer": 0.6257807022474812, "learner_update_timer": 4.319853638953194, "synch_weights": 0.0017084801907303734, "synch_env_connectors": 0.00269061728375375}, "env_runners": {"episode_duration_sec_mean": 0.0003664903124445118, "num_module_steps_sampled": {"default_policy": 4096}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.5071007441985283e-05, "get_actions": 9.110618053854114e-05, "un_batch_to_individual_items": 9.378889431134872e-06, "remove_single_ts_time_rank_from_batch": 1.0221179497520057e-06, "listify_data_for_vector_env": 1.589563479145576e-05, "tensor_to_numpy": 2.924085856419944e-05}}, "connector_pipeline_timer": 0.00019658444113493552}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 8.818831143598106e-06, "add_time_dim_to_batch_and_zero_pad": 3.1085597696439516e-06, "numpy_to_tensor": 1.810332298327697e-05, "add_observations_from_episodes_to_batch": 4.201051547800558e-06, "add_states_from_episodes_to_batch": 1.894432281503581e-06}}, "connector_pipeline_timer": 5.820560069924765e-05}, "num_episodes": 4096, "episode_len_min": 1, "time_between_sampling": 1.1832702132609456, "episode_len_mean": 1.0, "env_step_timer": 2.3506556918037357e-05, "num_episodes_lifetime": 143031, "agent_episode_returns_mean": {"default_agent": 51.0}, "episode_return_mean": 51.0, "weights_seq_no": 38.0, "num_env_steps_sampled_lifetime": 159744, "env_reset_timer": 0.00013909503468312323, "sample": 0.10683378000130889, "env_to_module_sum_episodes_length_out": 0.5025591563511842, "env_to_module_sum_episodes_length_in": 0.5025591563511842, "episode_len_max": 1, "rlmodule_inference_timer": 6.424044461335253e-05, "num_env_steps_sampled": 4096, "episode_return_max": 51.0, "num_module_steps_sampled_lifetime": {"default_policy": 159744}, "num_agent_steps_sampled": {"default_agent": 4096}, "episode_return_min": 51.0, "num_agent_steps_sampled_lifetime": {"default_agent": 159744}, "module_episode_returns_mean": {"default_policy": 51.0}, "num_env_steps_sampled_lifetime_throughput": 598.6902758379849}, "learners": {"default_policy": {"vf_explained_var": -1.1920928955078125e-07, "gradients_default_optimizer_global_norm": 2.0854468152364802e-10, "mean_kl_loss": 3.1145745704730388e-12, "vf_loss_unclipped": 2627.69140625, "module_train_batch_size_mean": 128.0, "vf_loss": 10.0, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 4.667498609833842e-10, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "weights_seq_no": 39.0, "policy_loss": -1.0000001192092896, "total_loss": 9.0, "curr_entropy_coeff": 0.0, "num_module_steps_trained_lifetime": 9088128, "curr_kl_coeff": 6.705522803684971e-09}, "__all_modules__": {"num_env_steps_trained": 15728640, "num_module_steps_trained_lifetime": 9088128, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.781818802369044e-05, "numpy_to_tensor": 0.00016734210140131192, "add_observations_from_episodes_to_batch": 0.006842738618398338, "add_states_from_episodes_to_batch": 5.475381184083081e-06, "batch_individual_items": 0.03522697625914493, "general_advantage_estimation": 0.018225437825948713, "add_columns_from_episodes_to_train_batch": 0.05050863249592348, "add_one_ts_to_episodes_and_truncate": 0.04411383057929176}}, "connector_pipeline_timer": 0.15562143206807957}, "learner_connector_sum_episodes_length_out": 5544.135550146845, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 4096.0, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "num_env_steps_trained_lifetime": 556836677, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 159744, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 598.6902758379849, "done": false, "training_iteration": 39, "trial_id": "40149_00000", "date": "2025-05-17_14-57-40", "timestamp": 1747461460, "time_this_iter_s": 6.834019422531128, "time_total_s": 248.0845239162445, "pid": 1464251, "hostname": "localhost.localdomain", "node_ip": "10.139.239.36", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MatmulEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4096, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f7796fcc220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 248.0845239162445, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 11.511111111111111, "ram_util_percent": 14.844444444444447}}
{"timers": {"training_iteration": 4.978834424185301, "restore_env_runners": 1.8177636656329316e-05, "training_step": 4.978668880806793, "env_runner_sampling_timer": 0.6299244376841553, "learner_update_timer": 4.336732414763526, "synch_weights": 0.0017095169389155433, "synch_env_connectors": 0.0026864348613603417}, "env_runners": {"episode_duration_sec_mean": 0.0003555157600203529, "num_module_steps_sampled": {"default_policy": 4096}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.4857284409653367e-05, "get_actions": 8.980815734500298e-05, "un_batch_to_individual_items": 9.231653210084723e-06, "remove_single_ts_time_rank_from_batch": 1.001140226291675e-06, "listify_data_for_vector_env": 1.5650097902231834e-05, "tensor_to_numpy": 2.8828663952834013e-05}}, "connector_pipeline_timer": 0.00019357987470588944}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 8.614989755358603e-06, "add_time_dim_to_batch_and_zero_pad": 3.0616811538271696e-06, "numpy_to_tensor": 1.7829577494112672e-05, "add_observations_from_episodes_to_batch": 4.1330457360015526e-06, "add_states_from_episodes_to_batch": 1.860649853194778e-06}}, "connector_pipeline_timer": 5.71295295802612e-05}, "num_episodes": 4096, "episode_len_min": 1, "time_between_sampling": 1.1992173580703043, "episode_len_mean": 1.0, "env_step_timer": 2.315881440460863e-05, "num_episodes_lifetime": 147127, "agent_episode_returns_mean": {"default_agent": 51.0}, "episode_return_mean": 51.0, "weights_seq_no": 39.0, "num_env_steps_sampled_lifetime": 163840, "env_reset_timer": 0.00013909503468312323, "sample": 0.1073139702156411, "env_to_module_sum_episodes_length_out": 0.5025463422122602, "env_to_module_sum_episodes_length_in": 0.5025463422122602, "episode_len_max": 1, "rlmodule_inference_timer": 6.574911856268617e-05, "num_env_steps_sampled": 4096, "episode_return_max": 51.0, "num_module_steps_sampled_lifetime": {"default_policy": 163840}, "num_agent_steps_sampled": {"default_agent": 4096}, "episode_return_min": 51.0, "num_agent_steps_sampled_lifetime": {"default_agent": 163840}, "module_episode_returns_mean": {"default_policy": 51.0}, "num_env_steps_sampled_lifetime_throughput": 578.284571474759}, "learners": {"default_policy": {"vf_explained_var": -1.1920928955078125e-07, "gradients_default_optimizer_global_norm": 1.83460246994116e-10, "mean_kl_loss": 2.3451553199382857e-12, "vf_loss_unclipped": 2627.69140625, "module_train_batch_size_mean": 128.0, "vf_loss": 10.0, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 4.1285200258478483e-10, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "weights_seq_no": 40.0, "policy_loss": -1.0000001192092896, "total_loss": 9.0, "curr_entropy_coeff": 0.0, "num_module_steps_trained_lifetime": 9333888, "curr_kl_coeff": 3.3527614018424856e-09}, "__all_modules__": {"num_env_steps_trained": 15728640, "num_module_steps_trained_lifetime": 9333888, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.78161087103532e-05, "numpy_to_tensor": 0.00016731550219386139, "add_observations_from_episodes_to_batch": 0.0068804461724671145, "add_states_from_episodes_to_batch": 5.471025529324434e-06, "batch_individual_items": 0.035438199399785875, "general_advantage_estimation": 0.018248943948331552, "add_columns_from_episodes_to_train_batch": 0.050751298937360176, "add_one_ts_to_episodes_and_truncate": 0.044310224837174304}}, "connector_pipeline_timer": 0.15633351368721005}, "learner_connector_sum_episodes_length_out": 5550.887036735917, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 4096.0, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "num_env_steps_trained_lifetime": 572565317, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 163840, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 578.284571474759, "done": false, "training_iteration": 40, "trial_id": "40149_00000", "date": "2025-05-17_14-57-47", "timestamp": 1747461467, "time_this_iter_s": 7.075572490692139, "time_total_s": 255.16009640693665, "pid": 1464251, "hostname": "localhost.localdomain", "node_ip": "10.139.239.36", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MatmulEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4096, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f7796fcc220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 255.16009640693665, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 10.927272727272728, "ram_util_percent": 14.809090909090912}}
{"timers": {"training_iteration": 5.005295018673435, "restore_env_runners": 1.8083331270127126e-05, "training_step": 5.005129168468136, "env_runner_sampling_timer": 0.633170339506257, "learner_update_timer": 4.3598490202958535, "synch_weights": 0.0017114962092959986, "synch_env_connectors": 0.0026815963521723617}, "env_runners": {"episode_duration_sec_mean": 0.00034670641252887435, "num_module_steps_sampled": {"default_policy": 4096}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.4838351767132153e-05, "get_actions": 8.960901768630175e-05, "un_batch_to_individual_items": 9.211664963556871e-06, "remove_single_ts_time_rank_from_batch": 9.986502742027825e-07, "listify_data_for_vector_env": 1.561934122593618e-05, "tensor_to_numpy": 2.875317070202783e-05}}, "connector_pipeline_timer": 0.0001931364668416459}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 8.605379709863602e-06, "add_time_dim_to_batch_and_zero_pad": 3.0482526464354525e-06, "numpy_to_tensor": 1.7779024914088672e-05, "add_observations_from_episodes_to_batch": 4.123255941551012e-06, "add_states_from_episodes_to_batch": 1.8536466875501015e-06}}, "connector_pipeline_timer": 5.698465114618328e-05}, "num_episodes": 4096, "episode_len_min": 1, "time_between_sampling": 1.2152571384843291, "episode_len_mean": 1.0, "env_step_timer": 2.3107225344562964e-05, "num_episodes_lifetime": 151223, "agent_episode_returns_mean": {"default_agent": 51.0}, "episode_return_mean": 51.0, "weights_seq_no": 40.0, "num_env_steps_sampled_lifetime": 167936, "env_reset_timer": 0.00013909503468312323, "sample": 0.1077655420507299, "env_to_module_sum_episodes_length_out": 0.5025370522135181, "env_to_module_sum_episodes_length_in": 0.5025370522135181, "episode_len_max": 1, "rlmodule_inference_timer": 7.330325512646348e-05, "num_env_steps_sampled": 4096, "episode_return_max": 51.0, "num_module_steps_sampled_lifetime": {"default_policy": 167936}, "num_agent_steps_sampled": {"default_agent": 4096}, "episode_return_min": 51.0, "num_agent_steps_sampled_lifetime": {"default_agent": 167936}, "module_episode_returns_mean": {"default_policy": 51.0}, "num_env_steps_sampled_lifetime_throughput": 536.3953616954187}, "learners": {"default_policy": {"vf_explained_var": -1.1920928955078125e-07, "gradients_default_optimizer_global_norm": 1.6377309230986015e-10, "mean_kl_loss": 1.8294064180190972e-12, "vf_loss_unclipped": 2627.69189453125, "module_train_batch_size_mean": 128.0, "vf_loss": 10.0, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 3.702957662721218e-10, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "weights_seq_no": 41.0, "policy_loss": -1.0000001192092896, "total_loss": 9.0, "curr_entropy_coeff": 0.0, "num_module_steps_trained_lifetime": 9579648, "curr_kl_coeff": 1.6763807009212428e-09}, "__all_modules__": {"num_env_steps_trained": 15728640, "num_module_steps_trained_lifetime": 9579648, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.7814053461965685e-05, "numpy_to_tensor": 0.00016729122545327925, "add_observations_from_episodes_to_batch": 0.006918554730104123, "add_states_from_episodes_to_batch": 5.466889757400244e-06, "batch_individual_items": 0.03564742276049155, "general_advantage_estimation": 0.018272844946484925, "add_columns_from_episodes_to_train_batch": 0.05100795533862409, "add_one_ts_to_episodes_and_truncate": 0.044510315863040696}}, "connector_pipeline_timer": 0.15706208358935073}, "learner_connector_sum_episodes_length_out": 5557.768280038193, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 4096.0, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "num_env_steps_trained_lifetime": 588293957, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 167936, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 536.3953616954187, "done": false, "training_iteration": 41, "trial_id": "40149_00000", "date": "2025-05-17_14-57-55", "timestamp": 1747461475, "time_this_iter_s": 7.629495143890381, "time_total_s": 262.789591550827, "pid": 1464251, "hostname": "localhost.localdomain", "node_ip": "10.139.239.36", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MatmulEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4096, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f7796fcc220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 262.789591550827, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 11.669999999999998, "ram_util_percent": 14.820000000000002}}
{"timers": {"training_iteration": 5.032546802507427, "restore_env_runners": 1.798174768775954e-05, "training_step": 5.032380742004153, "env_runner_sampling_timer": 0.6366301702211669, "learner_update_timer": 4.383543637612985, "synch_weights": 0.0017127393474086986, "synch_env_connectors": 0.00268000891835351}, "env_runners": {"episode_duration_sec_mean": 0.00037387200427474454, "num_module_steps_sampled": {"default_policy": 4096}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.490304630573367e-05, "get_actions": 8.998278760139034e-05, "un_batch_to_individual_items": 9.259428651281158e-06, "remove_single_ts_time_rank_from_batch": 1.0045442865870652e-06, "listify_data_for_vector_env": 1.5675028845829796e-05, "tensor_to_numpy": 2.887390662150851e-05}}, "connector_pipeline_timer": 0.0001939770998907331}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 8.653595419120526e-06, "add_time_dim_to_batch_and_zero_pad": 3.0641095527183178e-06, "numpy_to_tensor": 1.7850858827905375e-05, "add_observations_from_episodes_to_batch": 4.141625503632622e-06, "add_states_from_episodes_to_batch": 1.8650508871328037e-06}}, "connector_pipeline_timer": 5.725705662363283e-05}, "num_episodes": 4096, "episode_len_min": 1, "time_between_sampling": 1.2327458308543164, "episode_len_mean": 1.0, "env_step_timer": 2.3193648111434278e-05, "num_episodes_lifetime": 155319, "agent_episode_returns_mean": {"default_agent": 51.0}, "episode_return_mean": 51.0, "weights_seq_no": 41.0, "num_env_steps_sampled_lifetime": 172032, "env_reset_timer": 0.00013909503468312323, "sample": 0.1082768231113592, "env_to_module_sum_episodes_length_out": 0.5025303171471089, "env_to_module_sum_episodes_length_in": 0.5025303171471089, "episode_len_max": 1, "rlmodule_inference_timer": 7.44080447203986e-05, "num_env_steps_sampled": 4096, "episode_return_max": 51.0, "num_module_steps_sampled_lifetime": {"default_policy": 172032}, "num_agent_steps_sampled": {"default_agent": 4096}, "episode_return_min": 51.0, "num_agent_steps_sampled_lifetime": {"default_agent": 172032}, "module_episode_returns_mean": {"default_policy": 51.0}, "num_env_steps_sampled_lifetime_throughput": 529.0186833323899}, "learners": {"default_policy": {"vf_explained_var": -1.1920928955078125e-07, "gradients_default_optimizer_global_norm": 1.4791794178403705e-10, "mean_kl_loss": 1.4659265554911594e-12, "vf_loss_unclipped": 2627.691650390625, "module_train_batch_size_mean": 128.0, "vf_loss": 10.0, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 3.358462397073936e-10, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "weights_seq_no": 42.0, "policy_loss": -1.0000001192092896, "total_loss": 9.0, "curr_entropy_coeff": 0.0, "num_module_steps_trained_lifetime": 9825408, "curr_kl_coeff": 8.381903504606214e-10}, "__all_modules__": {"num_env_steps_trained": 15728640, "num_module_steps_trained_lifetime": 9825408, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.7812213415232384e-05, "numpy_to_tensor": 0.00016726544419486933, "add_observations_from_episodes_to_batch": 0.00695702253247792, "add_states_from_episodes_to_batch": 5.462690299899334e-06, "batch_individual_items": 0.035854597450840846, "general_advantage_estimation": 0.018297184410875064, "add_columns_from_episodes_to_train_batch": 0.05127855986477699, "add_one_ts_to_episodes_and_truncate": 0.0447140118884056}}, "connector_pipeline_timer": 0.1578069674760726}, "learner_connector_sum_episodes_length_out": 5564.77600977075, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 4096.0, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "num_env_steps_trained_lifetime": 604022597, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 172032, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 529.0186833323899, "done": false, "training_iteration": 42, "trial_id": "40149_00000", "date": "2025-05-17_14-58-02", "timestamp": 1747461482, "time_this_iter_s": 7.734835863113403, "time_total_s": 270.52442741394043, "pid": 1464251, "hostname": "localhost.localdomain", "node_ip": "10.139.239.36", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MatmulEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4096, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f7796fcc220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 270.52442741394043, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 11.327272727272726, "ram_util_percent": 14.854545454545457}}
{"timers": {"training_iteration": 5.059907106761862, "restore_env_runners": 1.7877070480355142e-05, "training_step": 5.059740803513855, "env_runner_sampling_timer": 0.6395873813585743, "learner_update_timer": 4.407851938527376, "synch_weights": 0.001712066994247915, "synch_env_connectors": 0.002676264698557438}, "env_runners": {"episode_duration_sec_mean": 0.0003732986151590012, "num_module_steps_sampled": {"default_policy": 4096}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.4853189961405294e-05, "get_actions": 8.968446614785003e-05, "un_batch_to_individual_items": 9.232666530291512e-06, "remove_single_ts_time_rank_from_batch": 1.0011028632412027e-06, "listify_data_for_vector_env": 1.5619448512191763e-05, "tensor_to_numpy": 2.878288982783747e-05}}, "connector_pipeline_timer": 0.0001933305511175407}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 8.614974804101601e-06, "add_time_dim_to_batch_and_zero_pad": 3.0512632021731526e-06, "numpy_to_tensor": 1.7789211596016718e-05, "add_observations_from_episodes_to_batch": 4.124148087121314e-06, "add_states_from_episodes_to_batch": 1.857527053709827e-06}}, "connector_pipeline_timer": 5.703113062119063e-05}, "num_episodes": 4096, "episode_len_min": 1, "time_between_sampling": 1.2511682723214905, "episode_len_mean": 1.0, "env_step_timer": 2.3119246988693532e-05, "num_episodes_lifetime": 159415, "agent_episode_returns_mean": {"default_agent": 51.0}, "episode_return_mean": 51.0, "weights_seq_no": 42.0, "num_env_steps_sampled_lifetime": 176128, "env_reset_timer": 0.00013909503468312323, "sample": 0.10877583459755513, "env_to_module_sum_episodes_length_out": 0.5025254343564011, "env_to_module_sum_episodes_length_in": 0.5025254343564011, "episode_len_max": 1, "rlmodule_inference_timer": 7.17674360508723e-05, "num_env_steps_sampled": 4096, "episode_return_max": 51.0, "num_module_steps_sampled_lifetime": {"default_policy": 176128}, "num_agent_steps_sampled": {"default_agent": 4096}, "episode_return_min": 51.0, "num_agent_steps_sampled_lifetime": {"default_agent": 176128}, "module_episode_returns_mean": {"default_policy": 51.0}, "num_env_steps_sampled_lifetime_throughput": 526.4639066989263}, "learners": {"default_policy": {"vf_explained_var": -1.1920928955078125e-07, "gradients_default_optimizer_global_norm": 1.3486978200916155e-10, "mean_kl_loss": 1.2015008129043214e-12, "vf_loss_unclipped": 2627.691650390625, "module_train_batch_size_mean": 128.0, "vf_loss": 10.0, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 3.073673537912214e-10, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "weights_seq_no": 43.0, "policy_loss": -1.0000001192092896, "total_loss": 9.0, "curr_entropy_coeff": 0.0, "num_module_steps_trained_lifetime": 10071168, "curr_kl_coeff": 4.190951752303107e-10}, "__all_modules__": {"num_env_steps_trained": 15728640, "num_module_steps_trained_lifetime": 10071168, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.781001536370277e-05, "numpy_to_tensor": 0.00016723885024319586, "add_observations_from_episodes_to_batch": 0.006995873479028042, "add_states_from_episodes_to_batch": 5.458422941853614e-06, "batch_individual_items": 0.03605977851229931, "general_advantage_estimation": 0.01832195398328618, "add_columns_from_episodes_to_train_batch": 0.05156249509336673, "add_one_ts_to_episodes_and_truncate": 0.044921395153979006}}, "connector_pipeline_timer": 0.15856770693899683}, "learner_connector_sum_episodes_length_out": 5571.907008080651, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 4096.0, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "num_env_steps_trained_lifetime": 619751237, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 176128, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 526.4639066989263, "done": false, "training_iteration": 43, "trial_id": "40149_00000", "date": "2025-05-17_14-58-10", "timestamp": 1747461490, "time_this_iter_s": 7.772969722747803, "time_total_s": 278.29739713668823, "pid": 1464251, "hostname": "localhost.localdomain", "node_ip": "10.139.239.36", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MatmulEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4096, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f7796fcc220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 278.29739713668823, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 10.633333333333333, "ram_util_percent": 14.825000000000003}}
{"timers": {"training_iteration": 5.087471297533898, "restore_env_runners": 1.7762919592391283e-05, "training_step": 5.087305058029127, "env_runner_sampling_timer": 0.6416731346446702, "learner_update_timer": 4.433252102521813, "synch_weights": 0.0017128009841235487, "synch_env_connectors": 0.0026743180111949466}, "env_runners": {"episode_duration_sec_mean": 0.00035273090543341823, "num_module_steps_sampled": {"default_policy": 4096}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.4813821671063043e-05, "get_actions": 8.943488591064291e-05, "un_batch_to_individual_items": 9.206432180086407e-06, "remove_single_ts_time_rank_from_batch": 9.963705680590832e-07, "listify_data_for_vector_env": 1.557870665648358e-05, "tensor_to_numpy": 2.8702743239577553e-05}}, "connector_pipeline_timer": 0.0001927540925869736}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 8.574954151590594e-06, "add_time_dim_to_batch_and_zero_pad": 3.044309739326187e-06, "numpy_to_tensor": 1.7738287389576447e-05, "add_observations_from_episodes_to_batch": 4.109330933416943e-06, "add_states_from_episodes_to_batch": 1.849376435202958e-06}}, "connector_pipeline_timer": 5.681477600786171e-05}, "num_episodes": 4096, "episode_len_min": 1, "time_between_sampling": 1.2699659266970664, "episode_len_mean": 1.0, "env_step_timer": 2.306928642305939e-05, "num_episodes_lifetime": 163511, "agent_episode_returns_mean": {"default_agent": 51.0}, "episode_return_mean": 51.0, "weights_seq_no": 43.0, "num_env_steps_sampled_lifetime": 180224, "env_reset_timer": 0.00013909503468312323, "sample": 0.10918450000579377, "env_to_module_sum_episodes_length_out": 0.5025218944291535, "env_to_module_sum_episodes_length_in": 0.5025218944291535, "episode_len_max": 1, "rlmodule_inference_timer": 6.884956292250888e-05, "num_env_steps_sampled": 4096, "episode_return_max": 51.0, "num_module_steps_sampled_lifetime": {"default_policy": 180224}, "num_agent_steps_sampled": {"default_agent": 4096}, "episode_return_min": 51.0, "num_agent_steps_sampled_lifetime": {"default_agent": 180224}, "module_episode_returns_mean": {"default_policy": 51.0}, "num_env_steps_sampled_lifetime_throughput": 523.257839364568}, "learners": {"default_policy": {"vf_explained_var": -1.1920928955078125e-07, "gradients_default_optimizer_global_norm": 1.2393572279556508e-10, "mean_kl_loss": 1.003401897160805e-12, "vf_loss_unclipped": 2627.691162109375, "module_train_batch_size_mean": 128.0, "vf_loss": 10.0, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 2.834072976298785e-10, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "weights_seq_no": 44.0, "policy_loss": -1.0000001192092896, "total_loss": 9.0, "curr_entropy_coeff": 0.0, "num_module_steps_trained_lifetime": 10316928, "curr_kl_coeff": 2.0954758761515535e-10}, "__all_modules__": {"num_env_steps_trained": 15728640, "num_module_steps_trained_lifetime": 10316928, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.7807485650457963e-05, "numpy_to_tensor": 0.00016721404822409532, "add_observations_from_episodes_to_batch": 0.007035069464393453, "add_states_from_episodes_to_batch": 5.454072359808953e-06, "batch_individual_items": 0.036262881735975624, "general_advantage_estimation": 0.01834719847790863, "add_columns_from_episodes_to_train_batch": 0.05185898017569347, "add_one_ts_to_episodes_and_truncate": 0.04513223330105359}}, "connector_pipeline_timer": 0.15934319916051348}, "learner_connector_sum_episodes_length_out": 5579.158108823378, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 4096.0, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "num_env_steps_trained_lifetime": 635479877, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 180224, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 523.257839364568, "done": false, "training_iteration": 44, "trial_id": "40149_00000", "date": "2025-05-17_14-58-18", "timestamp": 1747461498, "time_this_iter_s": 7.823265552520752, "time_total_s": 286.120662689209, "pid": 1464251, "hostname": "localhost.localdomain", "node_ip": "10.139.239.36", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MatmulEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4096, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f7796fcc220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 286.120662689209, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 10.745454545454548, "ram_util_percent": 14.863636363636367}}
{"timers": {"training_iteration": 5.115473689038612, "restore_env_runners": 1.768317007075302e-05, "training_step": 5.115306975029031, "env_runner_sampling_timer": 0.6435714139080273, "learner_update_timer": 4.459262633736217, "synch_weights": 0.001713477844431434, "synch_env_connectors": 0.0026954705112646796}, "env_runners": {"episode_duration_sec_mean": 0.00035556365037336946, "num_module_steps_sampled": {"default_policy": 4096}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.4675437500078463e-05, "get_actions": 8.863621653016033e-05, "un_batch_to_individual_items": 9.11653675695995e-06, "remove_single_ts_time_rank_from_batch": 9.84223652673599e-07, "listify_data_for_vector_env": 1.5423961594004724e-05, "tensor_to_numpy": 2.844403491302564e-05}}, "connector_pipeline_timer": 0.00019088880554467378}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 8.441032544338488e-06, "add_time_dim_to_batch_and_zero_pad": 3.010901215579261e-06, "numpy_to_tensor": 1.7561687020467578e-05, "add_observations_from_episodes_to_batch": 4.065624480787971e-06, "add_states_from_episodes_to_batch": 1.8295376413944839e-06}}, "connector_pipeline_timer": 5.611463563209823e-05}, "num_episodes": 4096, "episode_len_min": 1, "time_between_sampling": 1.2893656168982401, "episode_len_mean": 1.0, "env_step_timer": 2.286214072869271e-05, "num_episodes_lifetime": 167607, "agent_episode_returns_mean": {"default_agent": 51.0}, "episode_return_mean": 51.0, "weights_seq_no": 44.0, "num_env_steps_sampled_lifetime": 184320, "env_reset_timer": 0.00013909503468312323, "sample": 0.10953139882424887, "env_to_module_sum_episodes_length_out": 0.5025193280515082, "env_to_module_sum_episodes_length_in": 0.5025193280515082, "episode_len_max": 1, "rlmodule_inference_timer": 6.620189048196616e-05, "num_env_steps_sampled": 4096, "episode_return_max": 51.0, "num_module_steps_sampled_lifetime": {"default_policy": 184320}, "num_agent_steps_sampled": {"default_agent": 4096}, "episode_return_min": 51.0, "num_agent_steps_sampled_lifetime": {"default_agent": 184320}, "module_episode_returns_mean": {"default_policy": 51.0}, "num_env_steps_sampled_lifetime_throughput": 518.3400122304898}, "learners": {"default_policy": {"vf_explained_var": -1.1920928955078125e-07, "gradients_default_optimizer_global_norm": 1.1464486998624679e-10, "mean_kl_loss": 8.500898552796232e-13, "vf_loss_unclipped": 2627.691650390625, "module_train_batch_size_mean": 128.0, "vf_loss": 10.0, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 2.629743645066185e-10, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "weights_seq_no": 45.0, "policy_loss": -1.0000001192092896, "total_loss": 9.0, "curr_entropy_coeff": 0.0, "num_module_steps_trained_lifetime": 10562688, "curr_kl_coeff": 1.0477379380757768e-10}, "__all_modules__": {"num_env_steps_trained": 15728640, "num_module_steps_trained_lifetime": 10562688, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.780515413601226e-05, "numpy_to_tensor": 0.00016719341745630872, "add_observations_from_episodes_to_batch": 0.007074564434797862, "add_states_from_episodes_to_batch": 5.449740843648632e-06, "batch_individual_items": 0.03646408699912107, "general_advantage_estimation": 0.01837293762464639, "add_columns_from_episodes_to_train_batch": 0.05216868691926391, "add_one_ts_to_episodes_and_truncate": 0.04534647668977629}}, "connector_pipeline_timer": 0.16013426881050496}, "learner_connector_sum_episodes_length_out": 5586.526196850442, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 4096.0, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "num_env_steps_trained_lifetime": 651208517, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 184320, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 518.3400122304898, "done": false, "training_iteration": 45, "trial_id": "40149_00000", "date": "2025-05-17_14-58-26", "timestamp": 1747461506, "time_this_iter_s": 7.891852140426636, "time_total_s": 294.0125148296356, "pid": 1464251, "hostname": "localhost.localdomain", "node_ip": "10.139.239.36", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MatmulEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4096, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f7796fcc220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 294.0125148296356, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 10.618181818181817, "ram_util_percent": 14.836363636363638}}
{"timers": {"training_iteration": 5.144470824788934, "restore_env_runners": 1.758448797558791e-05, "training_step": 5.144303862438043, "env_runner_sampling_timer": 0.645478368958389, "learner_update_timer": 4.486265133409798, "synch_weights": 0.0017135592354952935, "synch_env_connectors": 0.002691343855411293}, "env_runners": {"episode_duration_sec_mean": 0.0003703229667735286, "num_module_steps_sampled": {"default_policy": 4096}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.4668134811900796e-05, "get_actions": 8.861973278571508e-05, "un_batch_to_individual_items": 9.11374118225908e-06, "remove_single_ts_time_rank_from_batch": 9.833420242392556e-07, "listify_data_for_vector_env": 1.5419068982069977e-05, "tensor_to_numpy": 2.844993545295261e-05}}, "connector_pipeline_timer": 0.00019084210211204222}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 8.435774033481468e-06, "add_time_dim_to_batch_and_zero_pad": 3.010608762126178e-06, "numpy_to_tensor": 1.7570234143309196e-05, "add_observations_from_episodes_to_batch": 4.0657951935734675e-06, "add_states_from_episodes_to_batch": 1.8299877617788049e-06}}, "connector_pipeline_timer": 5.61144803294781e-05}, "num_episodes": 4096, "episode_len_min": 1, "time_between_sampling": 1.309035333254112, "episode_len_mean": 1.0, "env_step_timer": 2.2838654159539377e-05, "num_episodes_lifetime": 171703, "agent_episode_returns_mean": {"default_agent": 51.0}, "episode_return_mean": 51.0, "weights_seq_no": 45.0, "num_env_steps_sampled_lifetime": 188416, "env_reset_timer": 0.00013909503468312323, "sample": 0.10985749083130837, "env_to_module_sum_episodes_length_out": 0.5025174674781805, "env_to_module_sum_episodes_length_in": 0.5025174674781805, "episode_len_max": 1, "rlmodule_inference_timer": 6.47264295228612e-05, "num_env_steps_sampled": 4096, "episode_return_max": 51.0, "num_module_steps_sampled_lifetime": {"default_policy": 188416}, "num_agent_steps_sampled": {"default_agent": 4096}, "episode_return_min": 51.0, "num_agent_steps_sampled_lifetime": {"default_agent": 188416}, "module_episode_returns_mean": {"default_policy": 51.0}, "num_env_steps_sampled_lifetime_throughput": 510.27528751544713}, "learners": {"default_policy": {"vf_explained_var": -1.1920928955078125e-07, "gradients_default_optimizer_global_norm": 1.0664485960987236e-10, "mean_kl_loss": 7.301242401468178e-13, "vf_loss_unclipped": 2627.691650390625, "module_train_batch_size_mean": 128.0, "vf_loss": 10.0, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 2.453236225274935e-10, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "weights_seq_no": 46.0, "policy_loss": -1.0000001192092896, "total_loss": 9.0, "curr_entropy_coeff": 0.0, "num_module_steps_trained_lifetime": 10808448, "curr_kl_coeff": 5.238689690378884e-11}, "__all_modules__": {"num_env_steps_trained": 15728640, "num_module_steps_trained_lifetime": 10808448, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.7802761705786448e-05, "numpy_to_tensor": 0.00016717161120404257, "add_observations_from_episodes_to_batch": 0.007114397305143678, "add_states_from_episodes_to_batch": 5.445354348760826e-06, "batch_individual_items": 0.03667985402232856, "general_advantage_estimation": 0.018399288188295178, "add_columns_from_episodes_to_train_batch": 0.052475025227549855, "add_one_ts_to_episodes_and_truncate": 0.045564192728105087}}, "connector_pipeline_timer": 0.1609409696094758}, "learner_connector_sum_episodes_length_out": 5594.008207306082, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 4096.0, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "num_env_steps_trained_lifetime": 666937157, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 188416, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 510.27528751544713, "done": false, "training_iteration": 46, "trial_id": "40149_00000", "date": "2025-05-17_14-58-34", "timestamp": 1747461514, "time_this_iter_s": 8.019404649734497, "time_total_s": 302.0319194793701, "pid": 1464251, "hostname": "localhost.localdomain", "node_ip": "10.139.239.36", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MatmulEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4096, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f7796fcc220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 302.0319194793701, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 10.781818181818181, "ram_util_percent": 14.81818181818182}}
{"timers": {"training_iteration": 5.172667978470603, "restore_env_runners": 1.748048299093143e-05, "training_step": 5.172500906003243, "env_runner_sampling_timer": 0.6473324971895631, "learner_update_timer": 4.512501328416019, "synch_weights": 0.001713042493781293, "synch_env_connectors": 0.0026881523367178707}, "env_runners": {"episode_duration_sec_mean": 0.0003683278810058255, "num_module_steps_sampled": {"default_policy": 4096}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.4658034605814075e-05, "get_actions": 8.85453462015023e-05, "un_batch_to_individual_items": 9.100692872258854e-06, "remove_single_ts_time_rank_from_batch": 9.817210771631068e-07, "listify_data_for_vector_env": 1.54061993562005e-05, "tensor_to_numpy": 2.8424243437320115e-05}}, "connector_pipeline_timer": 0.00019067060283697526}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 8.426124550564698e-06, "add_time_dim_to_batch_and_zero_pad": 3.0075783655853616e-06, "numpy_to_tensor": 1.7551093905752784e-05, "add_observations_from_episodes_to_batch": 4.060451937251398e-06, "add_states_from_episodes_to_batch": 1.8266476693598328e-06}}, "connector_pipeline_timer": 5.605197749692949e-05}, "num_episodes": 4096, "episode_len_min": 1, "time_between_sampling": 1.3290010486102064, "episode_len_mean": 1.0, "env_step_timer": 2.281752888476764e-05, "num_episodes_lifetime": 175799, "agent_episode_returns_mean": {"default_agent": 51.0}, "episode_return_mean": 51.0, "weights_seq_no": 46.0, "num_env_steps_sampled_lifetime": 192512, "env_reset_timer": 0.00013909503468312323, "sample": 0.11012858364664678, "env_to_module_sum_episodes_length_out": 0.5025161185991043, "env_to_module_sum_episodes_length_in": 0.5025161185991043, "episode_len_max": 1, "rlmodule_inference_timer": 6.356263577201344e-05, "num_env_steps_sampled": 4096, "episode_return_max": 51.0, "num_module_steps_sampled_lifetime": {"default_policy": 192512}, "num_agent_steps_sampled": {"default_agent": 4096}, "episode_return_min": 51.0, "num_agent_steps_sampled_lifetime": {"default_agent": 192512}, "module_episode_returns_mean": {"default_policy": 51.0}, "num_env_steps_sampled_lifetime_throughput": 513.5534554912495}, "learners": {"default_policy": {"vf_explained_var": -1.1920928955078125e-07, "gradients_default_optimizer_global_norm": 9.970593795038951e-11, "mean_kl_loss": 6.318750861086797e-13, "vf_loss_unclipped": 2627.691650390625, "module_train_batch_size_mean": 128.0, "vf_loss": 10.0, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 2.299672674510589e-10, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "weights_seq_no": 47.0, "policy_loss": -1.0000001192092896, "total_loss": 9.0, "curr_entropy_coeff": 0.0, "num_module_steps_trained_lifetime": 11054208, "curr_kl_coeff": 2.619344845189442e-11}, "__all_modules__": {"num_env_steps_trained": 15728640, "num_module_steps_trained_lifetime": 11054208, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.780058321263088e-05, "numpy_to_tensor": 0.00016714926313549674, "add_observations_from_episodes_to_batch": 0.007154515316439049, "add_states_from_episodes_to_batch": 5.440928307861125e-06, "batch_individual_items": 0.03690955338166283, "general_advantage_estimation": 0.018426041503507785, "add_columns_from_episodes_to_train_batch": 0.05277818101788181, "add_one_ts_to_episodes_and_truncate": 0.04578503510740431}}, "connector_pipeline_timer": 0.16176223193108555}, "learner_connector_sum_episodes_length_out": 5601.601124932925, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 4096.0, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "num_env_steps_trained_lifetime": 682665797, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 192512, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 513.5534554912495, "done": false, "training_iteration": 47, "trial_id": "40149_00000", "date": "2025-05-17_14-58-42", "timestamp": 1747461522, "time_this_iter_s": 7.968442678451538, "time_total_s": 310.00036215782166, "pid": 1464251, "hostname": "localhost.localdomain", "node_ip": "10.139.239.36", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MatmulEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4096, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f7796fcc220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 310.00036215782166, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 10.681818181818182, "ram_util_percent": 14.809090909090912}}
{"timers": {"training_iteration": 5.200885089376637, "restore_env_runners": 1.7398448366832785e-05, "training_step": 5.200717832072675, "env_runner_sampling_timer": 0.651010475966966, "learner_update_timer": 4.536938053691137, "synch_weights": 0.0017122756381459645, "synch_env_connectors": 0.0026835830030358726}, "env_runners": {"episode_duration_sec_mean": 0.0003641674302343745, "num_module_steps_sampled": {"default_policy": 4096}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.4679125133013844e-05, "get_actions": 8.872617183304434e-05, "un_batch_to_individual_items": 9.122473963453315e-06, "remove_single_ts_time_rank_from_batch": 9.843789404941028e-07, "listify_data_for_vector_env": 1.5445328819359354e-05, "tensor_to_numpy": 2.847035147414046e-05}}, "connector_pipeline_timer": 0.00019108900470737446}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 8.45807566061264e-06, "add_time_dim_to_batch_and_zero_pad": 3.015393045030501e-06, "numpy_to_tensor": 1.7594612297915144e-05, "add_observations_from_episodes_to_batch": 4.071841117361332e-06, "add_states_from_episodes_to_batch": 1.8337646956654198e-06}}, "connector_pipeline_timer": 5.6225909555131046e-05}, "num_episodes": 4096, "episode_len_min": 1, "time_between_sampling": 1.3489542974612436, "episode_len_mean": 1.0, "env_step_timer": 2.2860556842950607e-05, "num_episodes_lifetime": 179895, "agent_episode_returns_mean": {"default_agent": 51.0}, "episode_return_mean": 51.0, "weights_seq_no": 47.0, "num_env_steps_sampled_lifetime": 196608, "env_reset_timer": 0.00013909503468312323, "sample": 0.11040207703948414, "env_to_module_sum_episodes_length_out": 0.5025151406882983, "env_to_module_sum_episodes_length_in": 0.5025151406882983, "episode_len_max": 1, "rlmodule_inference_timer": 6.299254802853185e-05, "num_env_steps_sampled": 4096, "episode_return_max": 51.0, "num_module_steps_sampled_lifetime": {"default_policy": 196608}, "num_agent_steps_sampled": {"default_agent": 4096}, "episode_return_min": 51.0, "num_agent_steps_sampled_lifetime": {"default_agent": 196608}, "module_episode_returns_mean": {"default_policy": 51.0}, "num_env_steps_sampled_lifetime_throughput": 511.6348848128254}, "learners": {"default_policy": {"vf_explained_var": -1.1920928955078125e-07, "gradients_default_optimizer_global_norm": 9.360972413885449e-11, "mean_kl_loss": 5.540727382111199e-13, "vf_loss_unclipped": 2627.691650390625, "module_train_batch_size_mean": 128.0, "vf_loss": 10.0, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 2.1643863090670123e-10, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "weights_seq_no": 48.0, "policy_loss": -1.0000001192092896, "total_loss": 9.0, "curr_entropy_coeff": 0.0, "num_module_steps_trained_lifetime": 11299968, "curr_kl_coeff": 1.309672422594721e-11}, "__all_modules__": {"num_env_steps_trained": 15728640, "num_module_steps_trained_lifetime": 11299968, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.7798346105107388e-05, "numpy_to_tensor": 0.00016712649946988106, "add_observations_from_episodes_to_batch": 0.007194967066479257, "add_states_from_episodes_to_batch": 5.436413961780066e-06, "batch_individual_items": 0.03713642128290168, "general_advantage_estimation": 0.018453176900399975, "add_columns_from_episodes_to_train_batch": 0.05307810509818765, "add_one_ts_to_episodes_and_truncate": 0.04600912848374051}}, "connector_pipeline_timer": 0.1625814209726917}, "learner_connector_sum_episodes_length_out": 5609.3019833865, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 4096.0, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "num_env_steps_trained_lifetime": 698394437, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 196608, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 511.6348848128254, "done": false, "training_iteration": 48, "trial_id": "40149_00000", "date": "2025-05-17_14-58-50", "timestamp": 1747461530, "time_this_iter_s": 7.9988789558410645, "time_total_s": 317.9992411136627, "pid": 1464251, "hostname": "localhost.localdomain", "node_ip": "10.139.239.36", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MatmulEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4096, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f7796fcc220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 317.9992411136627, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 10.83333333333333, "ram_util_percent": 14.883333333333335}}
{"timers": {"training_iteration": 5.229236895992752, "restore_env_runners": 1.7321953566121988e-05, "training_step": 5.229069407001695, "env_runner_sampling_timer": 0.6534927132376931, "learner_update_timer": 4.562708335444451, "synch_weights": 0.0017115503209407215, "synch_env_connectors": 0.0026796617828773184}, "env_runners": {"episode_duration_sec_mean": 0.00035188217952963896, "num_module_steps_sampled": {"default_policy": 4096}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.4679493683234707e-05, "get_actions": 8.879088711740572e-05, "un_batch_to_individual_items": 9.130175321564696e-06, "remove_single_ts_time_rank_from_batch": 9.83400705480526e-07, "listify_data_for_vector_env": 1.5440106715888596e-05, "tensor_to_numpy": 2.848789806244402e-05}}, "connector_pipeline_timer": 0.00019118050296171513}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 8.47522995700632e-06, "add_time_dim_to_batch_and_zero_pad": 3.0159191165464664e-06, "numpy_to_tensor": 1.7608636187643793e-05, "add_observations_from_episodes_to_batch": 4.0798848213653545e-06, "add_states_from_episodes_to_batch": 1.8346725109131098e-06}}, "connector_pipeline_timer": 5.627730519474614e-05}, "num_episodes": 4096, "episode_len_min": 1, "time_between_sampling": 1.368650565362315, "episode_len_mean": 1.0, "env_step_timer": 2.2873106397241538e-05, "num_episodes_lifetime": 183991, "agent_episode_returns_mean": {"default_agent": 51.0}, "episode_return_mean": 51.0, "weights_seq_no": 48.0, "num_env_steps_sampled_lifetime": 200704, "env_reset_timer": 0.00013909503468312323, "sample": 0.11067251185104396, "env_to_module_sum_episodes_length_out": 0.502514431722194, "env_to_module_sum_episodes_length_in": 0.502514431722194, "episode_len_max": 1, "rlmodule_inference_timer": 7.000231802198818e-05, "num_env_steps_sampled": 4096, "episode_return_max": 51.0, "num_module_steps_sampled_lifetime": {"default_policy": 200704}, "num_agent_steps_sampled": {"default_agent": 4096}, "episode_return_min": 51.0, "num_agent_steps_sampled_lifetime": {"default_agent": 200704}, "module_episode_returns_mean": {"default_policy": 51.0}, "num_env_steps_sampled_lifetime_throughput": 508.94003796903297}, "learners": {"default_policy": {"vf_explained_var": -1.1920928955078125e-07, "gradients_default_optimizer_global_norm": 8.821483127308127e-11, "mean_kl_loss": 4.895049209724389e-13, "vf_loss_unclipped": 2627.69140625, "module_train_batch_size_mean": 128.0, "vf_loss": 10.0, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 2.044351632424224e-10, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "weights_seq_no": 49.0, "policy_loss": -1.0000001192092896, "total_loss": 9.0, "curr_entropy_coeff": 0.0, "num_module_steps_trained_lifetime": 11545728, "curr_kl_coeff": 6.548362112973605e-12}, "__all_modules__": {"num_env_steps_trained": 15728640, "num_module_steps_trained_lifetime": 11545728, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.779604078374626e-05, "numpy_to_tensor": 0.00016710275275187087, "add_observations_from_episodes_to_batch": 0.007235810222386864, "add_states_from_episodes_to_batch": 5.431852518358176e-06, "batch_individual_items": 0.03736071773417736, "general_advantage_estimation": 0.01848067611529886, "add_columns_from_episodes_to_train_batch": 0.053390595044684123, "add_one_ts_to_episodes_and_truncate": 0.04623621040424244}}, "connector_pipeline_timer": 0.16341436622296776}, "learner_connector_sum_episodes_length_out": 5617.10786455851, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 4096.0, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "num_env_steps_trained_lifetime": 714123077, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 200704, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 508.94003796903297, "done": false, "training_iteration": 49, "trial_id": "40149_00000", "date": "2025-05-17_14-58-58", "timestamp": 1747461538, "time_this_iter_s": 8.040331602096558, "time_total_s": 326.0395727157593, "pid": 1464251, "hostname": "localhost.localdomain", "node_ip": "10.139.239.36", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MatmulEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4096, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f7796fcc220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 326.0395727157593, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 10.700000000000001, "ram_util_percent": 14.872727272727275}}
{"timers": {"training_iteration": 5.2573428958822435, "restore_env_runners": 1.723689302537387e-05, "training_step": 5.257175035661909, "env_runner_sampling_timer": 0.6555979139159658, "learner_update_timer": 4.588603202889512, "synch_weights": 0.0017123555874823863, "synch_env_connectors": 0.00267416064501301}, "env_runners": {"episode_duration_sec_mean": 0.00036032788193551823, "num_module_steps_sampled": {"default_policy": 4096}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.4855516417991317e-05, "get_actions": 8.982318319960398e-05, "un_batch_to_individual_items": 9.252564751352573e-06, "remove_single_ts_time_rank_from_batch": 1.0004189519975924e-06, "listify_data_for_vector_env": 1.5654269734778776e-05, "tensor_to_numpy": 2.884710973540402e-05}}, "connector_pipeline_timer": 0.0001936840624504929}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 8.645703911674918e-06, "add_time_dim_to_batch_and_zero_pad": 3.0566890404413465e-06, "numpy_to_tensor": 1.784394074083072e-05, "add_observations_from_episodes_to_batch": 4.138107517465495e-06, "add_states_from_episodes_to_batch": 1.8649100516417298e-06}}, "connector_pipeline_timer": 5.723120275698141e-05}, "num_episodes": 4096, "episode_len_min": 1, "time_between_sampling": 1.3880411235162913, "episode_len_mean": 1.0, "env_step_timer": 2.314234379715696e-05, "num_episodes_lifetime": 188087, "agent_episode_returns_mean": {"default_agent": 51.0}, "episode_return_mean": 51.0, "weights_seq_no": 49.0, "num_env_steps_sampled_lifetime": 204800, "env_reset_timer": 0.00013909503468312323, "sample": 0.11099749173377561, "env_to_module_sum_episodes_length_out": 0.5025139177357094, "env_to_module_sum_episodes_length_in": 0.5025139177357094, "episode_len_max": 1, "rlmodule_inference_timer": 6.845976744358826e-05, "num_env_steps_sampled": 4096, "episode_return_max": 51.0, "num_module_steps_sampled_lifetime": {"default_policy": 204800}, "num_agent_steps_sampled": {"default_agent": 4096}, "episode_return_min": 51.0, "num_agent_steps_sampled_lifetime": {"default_agent": 204800}, "module_episode_returns_mean": {"default_policy": 51.0}, "num_env_steps_sampled_lifetime_throughput": 508.7225808449277}, "learners": {"default_policy": {"vf_explained_var": -1.1920928955078125e-07, "gradients_default_optimizer_global_norm": 8.340009932661374e-11, "mean_kl_loss": 4.3620562348821446e-13, "vf_loss_unclipped": 2627.691650390625, "module_train_batch_size_mean": 128.0, "vf_loss": 10.0, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 1.93696933492582e-10, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "weights_seq_no": 50.0, "policy_loss": -1.0000001192092896, "total_loss": 9.0, "curr_entropy_coeff": 0.0, "num_module_steps_trained_lifetime": 11791488, "curr_kl_coeff": 3.2741810564868024e-12}, "__all_modules__": {"num_env_steps_trained": 15728640, "num_module_steps_trained_lifetime": 11791488, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.7793624831543355e-05, "numpy_to_tensor": 0.00016707806592020468, "add_observations_from_episodes_to_batch": 0.00727695579576545, "add_states_from_episodes_to_batch": 5.42722136613752e-06, "batch_individual_items": 0.037582449071905596, "general_advantage_estimation": 0.01850861746121215, "add_columns_from_episodes_to_train_batch": 0.05371564762303965, "add_one_ts_to_episodes_and_truncate": 0.046466340574787}}, "connector_pipeline_timer": 0.16426109891924315}, "learner_connector_sum_episodes_length_out": 5625.015897908742, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 4096.0, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "num_env_steps_trained_lifetime": 729851717, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 204800, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 508.7225808449277, "done": false, "training_iteration": 50, "trial_id": "40149_00000", "date": "2025-05-17_14-59-06", "timestamp": 1747461546, "time_this_iter_s": 8.04453158378601, "time_total_s": 334.0841042995453, "pid": 1464251, "hostname": "localhost.localdomain", "node_ip": "10.139.239.36", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MatmulEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4096, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f7796fcc220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 334.0841042995453, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 10.674999999999999, "ram_util_percent": 14.850000000000003}}
{"timers": {"training_iteration": 5.286775803943268, "restore_env_runners": 1.7149784348519742e-05, "training_step": 5.286607717165113, "env_runner_sampling_timer": 0.6582375298368157, "learner_update_timer": 4.6152800946412595, "synch_weights": 0.0017144252813621702, "synch_env_connectors": 0.0026731041177258203}, "env_runners": {"episode_duration_sec_mean": 0.0003722587789525278, "num_module_steps_sampled": {"default_policy": 4096}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.5043996933822356e-05, "get_actions": 9.084838201232482e-05, "un_batch_to_individual_items": 9.364788827403719e-06, "remove_single_ts_time_rank_from_batch": 1.0178820625445045e-06, "listify_data_for_vector_env": 1.5860933722262432e-05, "tensor_to_numpy": 2.9175779066502805e-05}}, "connector_pipeline_timer": 0.00019608312897110482}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 8.827115552454622e-06, "add_time_dim_to_batch_and_zero_pad": 3.094636603073289e-06, "numpy_to_tensor": 1.80695163229062e-05, "add_observations_from_episodes_to_batch": 4.197002020508219e-06, "add_states_from_episodes_to_batch": 1.8898310923704766e-06}}, "connector_pipeline_timer": 5.8118137380153845e-05}, "num_episodes": 4096, "episode_len_min": 1, "time_between_sampling": 1.4070451805562523, "episode_len_mean": 1.0, "env_step_timer": 2.3434289395344822e-05, "num_episodes_lifetime": 192183, "agent_episode_returns_mean": {"default_agent": 51.0}, "episode_return_mean": 51.0, "weights_seq_no": 50.0, "num_env_steps_sampled_lifetime": 208896, "env_reset_timer": 0.00013909503468312323, "sample": 0.1113309825951383, "env_to_module_sum_episodes_length_out": 0.5025135451056153, "env_to_module_sum_episodes_length_in": 0.5025135451056153, "episode_len_max": 1, "rlmodule_inference_timer": 6.749450363057896e-05, "num_env_steps_sampled": 4096, "episode_return_max": 51.0, "num_module_steps_sampled_lifetime": {"default_policy": 208896}, "num_agent_steps_sampled": {"default_agent": 4096}, "episode_return_min": 51.0, "num_agent_steps_sampled_lifetime": {"default_agent": 208896}, "module_episode_returns_mean": {"default_policy": 51.0}, "num_env_steps_sampled_lifetime_throughput": 498.7041581541749}, "learners": {"default_policy": {"vf_explained_var": 0.0, "gradients_default_optimizer_global_norm": 7.909205235190342e-11, "mean_kl_loss": 3.897219190158313e-13, "vf_loss_unclipped": 2627.691650390625, "module_train_batch_size_mean": 128.0, "vf_loss": 10.0, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 1.84067608377525e-10, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "weights_seq_no": 51.0, "policy_loss": -1.0000001192092896, "total_loss": 9.0, "curr_entropy_coeff": 0.0, "num_module_steps_trained_lifetime": 12037248, "curr_kl_coeff": 1.6370905282434012e-12}, "__all_modules__": {"num_env_steps_trained": 15728640, "num_module_steps_trained_lifetime": 12037248, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.779191608784478e-05, "numpy_to_tensor": 0.0001670528378613391, "add_observations_from_episodes_to_batch": 0.007318410004458673, "add_states_from_episodes_to_batch": 5.422550446455571e-06, "batch_individual_items": 0.037801916558504574, "general_advantage_estimation": 0.018536766664600964, "add_columns_from_episodes_to_train_batch": 0.0540530094050219, "add_one_ts_to_episodes_and_truncate": 0.0466993942093886}}, "connector_pipeline_timer": 0.16512133536786666}, "learner_connector_sum_episodes_length_out": 5633.023259805513, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 4096.0, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "num_env_steps_trained_lifetime": 745580357, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 208896, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 498.7041581541749, "done": false, "training_iteration": 51, "trial_id": "40149_00000", "date": "2025-05-17_14-59-14", "timestamp": 1747461554, "time_this_iter_s": 8.205684423446655, "time_total_s": 342.28978872299194, "pid": 1464251, "hostname": "localhost.localdomain", "node_ip": "10.139.239.36", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MatmulEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4096, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f7796fcc220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 342.28978872299194, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 14.781818181818183, "ram_util_percent": 15.07272727272727}}
{"timers": {"training_iteration": 5.327159026403268, "restore_env_runners": 1.709690673305688e-05, "training_step": 5.326990677462966, "env_runner_sampling_timer": 0.6622491904190877, "learner_update_timer": 4.651547503535485, "synch_weights": 0.001714765499284784, "synch_env_connectors": 0.0026715977063381533}, "env_runners": {"episode_duration_sec_mean": 0.0003996719606220722, "num_module_steps_sampled": {"default_policy": 4096}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.5253245894685957e-05, "get_actions": 9.200195214243142e-05, "un_batch_to_individual_items": 9.487423507283893e-06, "remove_single_ts_time_rank_from_batch": 1.0355808656851588e-06, "listify_data_for_vector_env": 1.6094344199949066e-05, "tensor_to_numpy": 2.954035361968616e-05}}, "connector_pipeline_timer": 0.00019879741038880946}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 9.010597443144607e-06, "add_time_dim_to_batch_and_zero_pad": 3.1385604692909787e-06, "numpy_to_tensor": 1.832515917508102e-05, "add_observations_from_episodes_to_batch": 4.259340053210492e-06, "add_states_from_episodes_to_batch": 1.919608425156241e-06}}, "connector_pipeline_timer": 5.911160247623619e-05}, "num_episodes": 4096, "episode_len_min": 1, "time_between_sampling": 1.4259884493578059, "episode_len_mean": 1.0, "env_step_timer": 2.3752627960887383e-05, "num_episodes_lifetime": 196279, "agent_episode_returns_mean": {"default_agent": 51.0}, "episode_return_mean": 51.0, "weights_seq_no": 51.0, "num_env_steps_sampled_lifetime": 212992, "env_reset_timer": 0.00013909503468312323, "sample": 0.11171527307537778, "env_to_module_sum_episodes_length_out": 0.502513274956124, "env_to_module_sum_episodes_length_in": 0.502513274956124, "episode_len_max": 1, "rlmodule_inference_timer": 6.705679355563642e-05, "num_env_steps_sampled": 4096, "episode_return_max": 51.0, "num_module_steps_sampled_lifetime": {"default_policy": 212992}, "num_agent_steps_sampled": {"default_agent": 4096}, "episode_return_min": 51.0, "num_agent_steps_sampled_lifetime": {"default_agent": 212992}, "module_episode_returns_mean": {"default_policy": 51.0}, "num_env_steps_sampled_lifetime_throughput": 438.6452398584654}, "learners": {"default_policy": {"vf_explained_var": -1.1920928955078125e-07, "gradients_default_optimizer_global_norm": 7.521233635898739e-11, "mean_kl_loss": 3.5054991136436453e-13, "vf_loss_unclipped": 2627.691162109375, "module_train_batch_size_mean": 128.0, "vf_loss": 10.0, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 1.7537706009651544e-10, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "weights_seq_no": 52.0, "policy_loss": -1.0000001192092896, "total_loss": 9.0, "curr_entropy_coeff": 0.0, "num_module_steps_trained_lifetime": 12283008, "curr_kl_coeff": 8.185452641217006e-13}, "__all_modules__": {"num_env_steps_trained": 15728640, "num_module_steps_trained_lifetime": 12283008, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.7790802546883964e-05, "numpy_to_tensor": 0.00016703393165290532, "add_observations_from_episodes_to_batch": 0.007360103401590619, "add_states_from_episodes_to_batch": 5.417944126827321e-06, "batch_individual_items": 0.038028465535959614, "general_advantage_estimation": 0.01856820260018093, "add_columns_from_episodes_to_train_batch": 0.05440748217680733, "add_one_ts_to_episodes_and_truncate": 0.04693513289964146}}, "connector_pipeline_timer": 0.16601213867912093}, "learner_connector_sum_episodes_length_out": 5641.127172874558, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 4096.0, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "num_env_steps_trained_lifetime": 761308997, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 212992, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 438.6452398584654, "done": false, "training_iteration": 52, "trial_id": "40149_00000", "date": "2025-05-17_14-59-24", "timestamp": 1747461564, "time_this_iter_s": 9.329854011535645, "time_total_s": 351.6196427345276, "pid": 1464251, "hostname": "localhost.localdomain", "node_ip": "10.139.239.36", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MatmulEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4096, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f7796fcc220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 351.6196427345276, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 34.26428571428572, "ram_util_percent": 18.264285714285712}}
{"timers": {"training_iteration": 5.358171715809336, "restore_env_runners": 1.70325368476168e-05, "training_step": 5.358002998418482, "env_runner_sampling_timer": 0.6666540875951605, "learner_update_timer": 4.678052489779796, "synch_weights": 0.0017175968741858112, "synch_env_connectors": 0.0026698701197800856}, "env_runners": {"episode_duration_sec_mean": 0.0004055687240906991, "num_module_steps_sampled": {"default_policy": 4096}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.5478286987989718e-05, "get_actions": 9.324839342887387e-05, "un_batch_to_individual_items": 9.614688342900027e-06, "remove_single_ts_time_rank_from_batch": 1.0503559129983735e-06, "listify_data_for_vector_env": 1.628598156456039e-05, "tensor_to_numpy": 2.9893849974357824e-05}}, "connector_pipeline_timer": 0.00020146026779457936}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 9.165286994861037e-06, "add_time_dim_to_batch_and_zero_pad": 3.1791980339710178e-06, "numpy_to_tensor": 1.854300423406676e-05, "add_observations_from_episodes_to_batch": 4.318076780822749e-06, "add_states_from_episodes_to_batch": 1.942852222836261e-06}}, "connector_pipeline_timer": 5.993474932102395e-05}, "num_episodes": 4096, "episode_len_min": 1, "time_between_sampling": 1.4477616294589684, "episode_len_mean": 1.0, "env_step_timer": 2.410483795957108e-05, "num_episodes_lifetime": 200375, "agent_episode_returns_mean": {"default_agent": 51.0}, "episode_return_mean": 51.0, "weights_seq_no": 52.0, "num_env_steps_sampled_lifetime": 217088, "env_reset_timer": 0.00013909503468312323, "sample": 0.1120813542985371, "env_to_module_sum_episodes_length_out": 0.5025130791030552, "env_to_module_sum_episodes_length_in": 0.5025130791030552, "episode_len_max": 1, "rlmodule_inference_timer": 6.806315283448177e-05, "num_env_steps_sampled": 4096, "episode_return_max": 51.0, "num_module_steps_sampled_lifetime": {"default_policy": 217088}, "num_agent_steps_sampled": {"default_agent": 4096}, "episode_return_min": 51.0, "num_agent_steps_sampled_lifetime": {"default_agent": 217088}, "module_episode_returns_mean": {"default_policy": 51.0}, "num_env_steps_sampled_lifetime_throughput": 485.17500107701017}, "learners": {"default_policy": {"vf_explained_var": 0.0, "gradients_default_optimizer_global_norm": 7.168420718128843e-11, "mean_kl_loss": 3.184909746958148e-13, "vf_loss_unclipped": 2627.691650390625, "module_train_batch_size_mean": 128.0, "vf_loss": 10.0, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 1.6745708986132257e-10, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "weights_seq_no": 53.0, "policy_loss": -1.0000001192092896, "total_loss": 9.0, "curr_entropy_coeff": 0.0, "num_module_steps_trained_lifetime": 12528768, "curr_kl_coeff": 4.092726320608503e-13}, "__all_modules__": {"num_env_steps_trained": 15728640, "num_module_steps_trained_lifetime": 12528768, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.7789645287934183e-05, "numpy_to_tensor": 0.0001670116223879204, "add_observations_from_episodes_to_batch": 0.007402182667782835, "add_states_from_episodes_to_batch": 5.4132723846195e-06, "batch_individual_items": 0.038253399712616716, "general_advantage_estimation": 0.01860000225359106, "add_columns_from_episodes_to_train_batch": 0.054775487446313255, "add_one_ts_to_episodes_and_truncate": 0.0471740129573675}}, "connector_pipeline_timer": 0.1669187682030114}, "learner_connector_sum_episodes_length_out": 5649.324905356241, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 4096.0, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "num_env_steps_trained_lifetime": 777037637, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 217088, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 485.17500107701017, "done": false, "training_iteration": 53, "trial_id": "40149_00000", "date": "2025-05-17_14-59-32", "timestamp": 1747461572, "time_this_iter_s": 8.433324575424194, "time_total_s": 360.0529673099518, "pid": 1464251, "hostname": "localhost.localdomain", "node_ip": "10.139.239.36", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MatmulEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4096, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f7796fcc220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 360.0529673099518, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 15.263636363636362, "ram_util_percent": 17.60909090909091}}
{"timers": {"training_iteration": 5.38479117241124, "restore_env_runners": 1.6954380981890672e-05, "training_step": 5.3846222233042464, "env_runner_sampling_timer": 0.6689596384184608, "learner_update_timer": 4.702300421522195, "synch_weights": 0.001716706425258072, "synch_env_connectors": 0.0026686202584609484}, "env_runners": {"episode_duration_sec_mean": 0.00035274902620585635, "num_module_steps_sampled": {"default_policy": 4096}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.5284500116322156e-05, "get_actions": 9.21353630117731e-05, "un_batch_to_individual_items": 9.49879066495442e-06, "remove_single_ts_time_rank_from_batch": 1.0333847577665345e-06, "listify_data_for_vector_env": 1.6081207955258903e-05, "tensor_to_numpy": 2.9540006089720462e-05}}, "connector_pipeline_timer": 0.0001988948512680522}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 8.994489345110349e-06, "add_time_dim_to_batch_and_zero_pad": 3.1403059926030514e-06, "numpy_to_tensor": 1.8311491612787725e-05, "add_observations_from_episodes_to_batch": 4.255186813071426e-06, "add_states_from_episodes_to_batch": 1.915512931825139e-06}}, "connector_pipeline_timer": 5.9019202575411156e-05}, "num_episodes": 4096, "episode_len_min": 1, "time_between_sampling": 1.4685146609296147, "episode_len_mean": 1.0, "env_step_timer": 2.3815239579248887e-05, "num_episodes_lifetime": 204471, "agent_episode_returns_mean": {"default_agent": 51.0}, "episode_return_mean": 51.0, "weights_seq_no": 53.0, "num_env_steps_sampled_lifetime": 221184, "env_reset_timer": 0.00013909503468312323, "sample": 0.11244966442838128, "env_to_module_sum_episodes_length_out": 0.5025129371134317, "env_to_module_sum_episodes_length_in": 0.5025129371134317, "episode_len_max": 1, "rlmodule_inference_timer": 6.617367060778011e-05, "num_env_steps_sampled": 4096, "episode_return_max": 51.0, "num_module_steps_sampled_lifetime": {"default_policy": 221184}, "num_agent_steps_sampled": {"default_agent": 4096}, "episode_return_min": 51.0, "num_agent_steps_sampled_lifetime": {"default_agent": 221184}, "module_episode_returns_mean": {"default_policy": 51.0}, "num_env_steps_sampled_lifetime_throughput": 509.8894047851871}, "learners": {"default_policy": {"vf_explained_var": -1.1920928955078125e-07, "gradients_default_optimizer_global_norm": 6.848419747962353e-11, "mean_kl_loss": 2.8846667892920563e-13, "vf_loss_unclipped": 2627.691650390625, "module_train_batch_size_mean": 128.0, "vf_loss": 10.0, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 1.6026177607209036e-10, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "weights_seq_no": 54.0, "policy_loss": -1.0000001192092896, "total_loss": 9.0, "curr_entropy_coeff": 0.0, "num_module_steps_trained_lifetime": 12774528, "curr_kl_coeff": 2.0463631603042515e-13}, "__all_modules__": {"num_env_steps_trained": 15728640, "num_module_steps_trained_lifetime": 12774528, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.7788252885465396e-05, "numpy_to_tensor": 0.0001669885599213663, "add_observations_from_episodes_to_batch": 0.0074446074090076956, "add_states_from_episodes_to_batch": 5.408525987667749e-06, "batch_individual_items": 0.038491650308684955, "general_advantage_estimation": 0.01863207139326278, "add_columns_from_episodes_to_train_batch": 0.055138786139211436, "add_one_ts_to_episodes_and_truncate": 0.04741551523185983}}, "connector_pipeline_timer": 0.1678372582117575}, "learner_connector_sum_episodes_length_out": 5657.613770471004, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 4096.0, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "num_env_steps_trained_lifetime": 792766277, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 221184, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 509.8894047851871, "done": false, "training_iteration": 54, "trial_id": "40149_00000", "date": "2025-05-17_14-59-40", "timestamp": 1747461580, "time_this_iter_s": 8.026044368743896, "time_total_s": 368.0790116786957, "pid": 1464251, "hostname": "localhost.localdomain", "node_ip": "10.139.239.36", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MatmulEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4096, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f7796fcc220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 368.0790116786957, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 10.508333333333335, "ram_util_percent": 15.199999999999996}}
{"timers": {"training_iteration": 5.410443931647533, "restore_env_runners": 1.6870696964378784e-05, "training_step": 5.410274802242052, "env_runner_sampling_timer": 0.6700908839441281, "learner_update_timer": 4.726729468917659, "synch_weights": 0.0017187148911839637, "synch_env_connectors": 0.0026809493459708784}, "env_runners": {"episode_duration_sec_mean": 0.0003571246561477892, "num_module_steps_sampled": {"default_policy": 4096}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.5004856858987193e-05, "get_actions": 9.051787961338307e-05, "un_batch_to_individual_items": 9.312896408421487e-06, "remove_single_ts_time_rank_from_batch": 1.0077430834510584e-06, "listify_data_for_vector_env": 1.5756728816374838e-05, "tensor_to_numpy": 2.9008032996904184e-05}}, "connector_pipeline_timer": 0.00019503421370099266}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 8.710811298218339e-06, "add_time_dim_to_batch_and_zero_pad": 3.0765637289550255e-06, "numpy_to_tensor": 1.795336323311165e-05, "add_observations_from_episodes_to_batch": 4.165683174687847e-06, "add_states_from_episodes_to_batch": 1.8692125917198815e-06}}, "connector_pipeline_timer": 5.754821206535681e-05}, "num_episodes": 4096, "episode_len_min": 1, "time_between_sampling": 1.4874788567657284, "episode_len_mean": 1.0, "env_step_timer": 2.338465804022201e-05, "num_episodes_lifetime": 208567, "agent_episode_returns_mean": {"default_agent": 51.0}, "episode_return_mean": 51.0, "weights_seq_no": 54.0, "num_env_steps_sampled_lifetime": 225280, "env_reset_timer": 0.00013909503468312323, "sample": 0.11271662118905793, "env_to_module_sum_episodes_length_out": 0.5025128341737467, "env_to_module_sum_episodes_length_in": 0.5025128341737467, "episode_len_max": 1, "rlmodule_inference_timer": 6.415408995625918e-05, "num_env_steps_sampled": 4096, "episode_return_max": 51.0, "num_module_steps_sampled_lifetime": {"default_policy": 225280}, "num_agent_steps_sampled": {"default_agent": 4096}, "episode_return_min": 51.0, "num_agent_steps_sampled_lifetime": {"default_agent": 225280}, "module_episode_returns_mean": {"default_policy": 51.0}, "num_env_steps_sampled_lifetime_throughput": 514.3517857106673}, "learners": {"default_policy": {"vf_explained_var": -1.1920928955078125e-07, "gradients_default_optimizer_global_norm": 6.55508564095797e-11, "mean_kl_loss": 2.64270918516607e-13, "vf_loss_unclipped": 2627.69140625, "module_train_batch_size_mean": 128.0, "vf_loss": 10.0, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 1.53652243706226e-10, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "weights_seq_no": 55.0, "policy_loss": -1.0000001192092896, "total_loss": 9.0, "curr_entropy_coeff": 0.0, "num_module_steps_trained_lifetime": 13020288, "curr_kl_coeff": 1.0231815801521257e-13}, "__all_modules__": {"num_env_steps_trained": 15728640, "num_module_steps_trained_lifetime": 13020288, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.7787044969148608e-05, "numpy_to_tensor": 0.00016696416834228696, "add_observations_from_episodes_to_batch": 0.007487261088944421, "add_states_from_episodes_to_batch": 5.403709888114938e-06, "batch_individual_items": 0.038743547591961885, "general_advantage_estimation": 0.018664406453920805, "add_columns_from_episodes_to_train_batch": 0.05549728105081349, "add_one_ts_to_episodes_and_truncate": 0.047659654023167124}}, "connector_pipeline_timer": 0.16876772156110628}, "learner_connector_sum_episodes_length_out": 5665.991125792934, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 4096.0, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "num_env_steps_trained_lifetime": 808494917, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 225280, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 514.3517857106673, "done": false, "training_iteration": 55, "trial_id": "40149_00000", "date": "2025-05-17_14-59-48", "timestamp": 1747461588, "time_this_iter_s": 7.954503774642944, "time_total_s": 376.0335154533386, "pid": 1464251, "hostname": "localhost.localdomain", "node_ip": "10.139.239.36", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MatmulEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4096, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f7796fcc220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 376.0335154533386, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 10.772727272727273, "ram_util_percent": 15.263636363636364}}
{"timers": {"training_iteration": 5.435974333230438, "restore_env_runners": 1.679086028726446e-05, "training_step": 5.435804893379672, "env_runner_sampling_timer": 0.6732324749252023, "learner_update_timer": 4.749034261518481, "synch_weights": 0.0017183400518948888, "synch_env_connectors": 0.002676381311739268}, "env_runners": {"episode_duration_sec_mean": 0.0003538475575624034, "num_module_steps_sampled": {"default_policy": 4096}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.4880782124105122e-05, "get_actions": 8.984004656961483e-05, "un_batch_to_individual_items": 9.237847075016289e-06, "remove_single_ts_time_rank_from_batch": 9.975017149150555e-07, "listify_data_for_vector_env": 1.562372934491972e-05, "tensor_to_numpy": 2.8798320919798556e-05}}, "connector_pipeline_timer": 0.00019348462918709956}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 8.598824820912838e-06, "add_time_dim_to_batch_and_zero_pad": 3.0511734947194803e-06, "numpy_to_tensor": 1.7805838558528618e-05, "add_observations_from_episodes_to_batch": 4.124885866900991e-06, "add_states_from_episodes_to_batch": 1.8509603625843116e-06}}, "connector_pipeline_timer": 5.696337506041082e-05}, "num_episodes": 4096, "episode_len_min": 1, "time_between_sampling": 1.5050663403936928, "episode_len_mean": 1.0, "env_step_timer": 2.3197239419377297e-05, "num_episodes_lifetime": 212663, "agent_episode_returns_mean": {"default_agent": 51.0}, "episode_return_mean": 51.0, "weights_seq_no": 55.0, "num_env_steps_sampled_lifetime": 229376, "env_reset_timer": 0.00013909503468312323, "sample": 0.1129110157546307, "env_to_module_sum_episodes_length_out": 0.5025127595444994, "env_to_module_sum_episodes_length_in": 0.5025127595444994, "episode_len_max": 1, "rlmodule_inference_timer": 6.307902121317978e-05, "num_env_steps_sampled": 4096, "episode_return_max": 51.0, "num_module_steps_sampled_lifetime": {"default_policy": 229376}, "num_agent_steps_sampled": {"default_agent": 4096}, "episode_return_min": 51.0, "num_agent_steps_sampled_lifetime": {"default_agent": 229376}, "module_episode_returns_mean": {"default_policy": 51.0}, "num_env_steps_sampled_lifetime_throughput": 513.5975818073906}, "learners": {"default_policy": {"vf_explained_var": -1.1920928955078125e-07, "gradients_default_optimizer_global_norm": 6.286181297721072e-11, "mean_kl_loss": 2.419845465499726e-13, "vf_loss_unclipped": 2627.691650390625, "module_train_batch_size_mean": 128.0, "vf_loss": 10.0, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 1.475844862985909e-10, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "weights_seq_no": 56.0, "policy_loss": -1.0000001192092896, "total_loss": 9.0, "curr_entropy_coeff": 0.0, "num_module_steps_trained_lifetime": 13266048, "curr_kl_coeff": 5.1159079007606287e-14}, "__all_modules__": {"num_env_steps_trained": 15728640, "num_module_steps_trained_lifetime": 13266048, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.7785621291650373e-05, "numpy_to_tensor": 0.0001669385988451167, "add_observations_from_episodes_to_batch": 0.00753027175293978, "add_states_from_episodes_to_batch": 5.398821949965714e-06, "batch_individual_items": 0.03899187226134224, "general_advantage_estimation": 0.018696995938625584, "add_columns_from_episodes_to_train_batch": 0.05585125605057332, "add_one_ts_to_episodes_and_truncate": 0.04790638196982118}}, "connector_pipeline_timer": 0.16969334026825306}, "learner_connector_sum_episodes_length_out": 5674.45437263138, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 4096.0, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "num_env_steps_trained_lifetime": 824223557, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 229376, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 513.5975818073906, "done": false, "training_iteration": 56, "trial_id": "40149_00000", "date": "2025-05-17_14-59-56", "timestamp": 1747461596, "time_this_iter_s": 7.967848539352417, "time_total_s": 384.00136399269104, "pid": 1464251, "hostname": "localhost.localdomain", "node_ip": "10.139.239.36", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MatmulEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4096, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f7796fcc220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 384.00136399269104, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 10.80909090909091, "ram_util_percent": 15.209090909090907}}
{"timers": {"training_iteration": 5.461404411147566, "restore_env_runners": 1.6696492407343108e-05, "training_step": 5.46123484058595, "env_runner_sampling_timer": 0.6747313190565434, "learner_update_timer": 4.772877166763025, "synch_weights": 0.001721420110676562, "synch_env_connectors": 0.002672273019210035}, "env_runners": {"episode_duration_sec_mean": 0.0003546794760040939, "num_module_steps_sampled": {"default_policy": 4096}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.4745557905529719e-05, "get_actions": 8.91081776171395e-05, "un_batch_to_individual_items": 9.159790140593831e-06, "remove_single_ts_time_rank_from_batch": 9.869410849550015e-07, "listify_data_for_vector_env": 1.5478332589668012e-05, "tensor_to_numpy": 2.857762884636912e-05}}, "connector_pipeline_timer": 0.0001917907599178156}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 8.470790201157074e-06, "add_time_dim_to_batch_and_zero_pad": 3.02326929370038e-06, "numpy_to_tensor": 1.7634204795722038e-05, "add_observations_from_episodes_to_batch": 4.08208445501067e-06, "add_states_from_episodes_to_batch": 1.833867146960668e-06}}, "connector_pipeline_timer": 5.633248860532609e-05}, "num_episodes": 4096, "episode_len_min": 1, "time_between_sampling": 1.521323877954988, "episode_len_mean": 1.0, "env_step_timer": 2.2984870572829428e-05, "num_episodes_lifetime": 216759, "agent_episode_returns_mean": {"default_agent": 51.0}, "episode_return_mean": 51.0, "weights_seq_no": 56.0, "num_env_steps_sampled_lifetime": 233472, "env_reset_timer": 0.00013909503468312323, "sample": 0.11305530856715046, "env_to_module_sum_episodes_length_out": 0.5025127054397625, "env_to_module_sum_episodes_length_in": 0.5025127054397625, "episode_len_max": 1, "rlmodule_inference_timer": 6.215228968340721e-05, "num_env_steps_sampled": 4096, "episode_return_max": 51.0, "num_module_steps_sampled_lifetime": {"default_policy": 233472}, "num_agent_steps_sampled": {"default_agent": 4096}, "episode_return_min": 51.0, "num_agent_steps_sampled_lifetime": {"default_agent": 233472}, "module_episode_returns_mean": {"default_policy": 51.0}, "num_env_steps_sampled_lifetime_throughput": 512.578908543541}, "learners": {"default_policy": {"vf_explained_var": -1.1920928955078125e-07, "gradients_default_optimizer_global_norm": 6.037591954166643e-11, "mean_kl_loss": 2.236197473937454e-13, "vf_loss_unclipped": 2627.69189453125, "module_train_batch_size_mean": 128.0, "vf_loss": 10.0, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 1.4196414876987973e-10, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "weights_seq_no": 57.0, "policy_loss": -1.0000001192092896, "total_loss": 9.0, "curr_entropy_coeff": 0.0, "num_module_steps_trained_lifetime": 13511808, "curr_kl_coeff": 2.5579539503803143e-14}, "__all_modules__": {"num_env_steps_trained": 15728640, "num_module_steps_trained_lifetime": 13511808, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.7783940176876977e-05, "numpy_to_tensor": 0.00016691268391780023, "add_observations_from_episodes_to_batch": 0.007573485849448971, "add_states_from_episodes_to_batch": 5.3938880964413196e-06, "batch_individual_items": 0.03923696333317639, "general_advantage_estimation": 0.018729845169894472, "add_columns_from_episodes_to_train_batch": 0.056216332416629926, "add_one_ts_to_episodes_and_truncate": 0.0481554624171415}}, "connector_pipeline_timer": 0.17062963582330154}, "learner_connector_sum_episodes_length_out": 5683.000955420476, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 4096.0, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "num_env_steps_trained_lifetime": 839952197, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 233472, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 512.578908543541, "done": false, "training_iteration": 57, "trial_id": "40149_00000", "date": "2025-05-17_15-00-04", "timestamp": 1747461604, "time_this_iter_s": 7.9831702709198, "time_total_s": 391.98453426361084, "pid": 1464251, "hostname": "localhost.localdomain", "node_ip": "10.139.239.36", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MatmulEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4096, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f7796fcc220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 391.98453426361084, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 10.950000000000001, "ram_util_percent": 15.266666666666666}}
{"timers": {"training_iteration": 5.4868311592465835, "restore_env_runners": 1.6608177674695954e-05, "training_step": 5.4866612935803145, "env_runner_sampling_timer": 0.6766539585963933, "learner_update_timer": 4.7962922876948975, "synch_weights": 0.001720262410177898, "synch_env_connectors": 0.002668202308997367}, "env_runners": {"episode_duration_sec_mean": 0.0003615474452089984, "num_module_steps_sampled": {"default_policy": 4096}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.4736809958048249e-05, "get_actions": 8.902022698961086e-05, "un_batch_to_individual_items": 9.155602204349244e-06, "remove_single_ts_time_rank_from_batch": 9.871389745454896e-07, "listify_data_for_vector_env": 1.5468669405077856e-05, "tensor_to_numpy": 2.856408247424532e-05}}, "connector_pipeline_timer": 0.00019166535903072335}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 8.48248936622308e-06, "add_time_dim_to_batch_and_zero_pad": 3.022381790636476e-06, "numpy_to_tensor": 1.763286833550355e-05, "add_observations_from_episodes_to_batch": 4.0874615273498036e-06, "add_states_from_episodes_to_batch": 1.8325952215754398e-06}}, "connector_pipeline_timer": 5.635011817989322e-05}, "num_episodes": 4096, "episode_len_min": 1, "time_between_sampling": 1.5366384990179904, "episode_len_mean": 1.0, "env_step_timer": 2.296206217793589e-05, "num_episodes_lifetime": 220855, "agent_episode_returns_mean": {"default_agent": 51.0}, "episode_return_mean": 51.0, "weights_seq_no": 57.0, "num_env_steps_sampled_lifetime": 237568, "env_reset_timer": 0.00013909503468312323, "sample": 0.11317548497222177, "env_to_module_sum_episodes_length_out": 0.5025126662148923, "env_to_module_sum_episodes_length_in": 0.5025126662148923, "episode_len_max": 1, "rlmodule_inference_timer": 6.179969577947282e-05, "num_env_steps_sampled": 4096, "episode_return_max": 51.0, "num_module_steps_sampled_lifetime": {"default_policy": 237568}, "num_agent_steps_sampled": {"default_agent": 4096}, "episode_return_min": 51.0, "num_agent_steps_sampled_lifetime": {"default_agent": 237568}, "module_episode_returns_mean": {"default_policy": 51.0}, "num_env_steps_sampled_lifetime_throughput": 510.95873068050287}, "learners": {"default_policy": {"vf_explained_var": -1.1920928955078125e-07, "gradients_default_optimizer_global_norm": 5.8088155813207365e-11, "mean_kl_loss": 2.0553211097038698e-13, "vf_loss_unclipped": 2627.69140625, "module_train_batch_size_mean": 128.0, "vf_loss": 10.0, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 1.3678558286045472e-10, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "weights_seq_no": 58.0, "policy_loss": -1.0000001192092896, "total_loss": 9.0, "curr_entropy_coeff": 0.0, "num_module_steps_trained_lifetime": 13757568, "curr_kl_coeff": 1.2789769751901572e-14}, "__all_modules__": {"num_env_steps_trained": 15728640, "num_module_steps_trained_lifetime": 13757568, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.7781905716102403e-05, "numpy_to_tensor": 0.00016688547723281495, "add_observations_from_episodes_to_batch": 0.007617000024060188, "add_states_from_episodes_to_batch": 5.388925834882084e-06, "batch_individual_items": 0.039478865739548195, "general_advantage_estimation": 0.01876293431264348, "add_columns_from_episodes_to_train_batch": 0.05659207680046627, "add_one_ts_to_episodes_and_truncate": 0.04840690435501849}}, "connector_pipeline_timer": 0.1715763273145298}, "learner_connector_sum_episodes_length_out": 5691.628361116529, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 4096.0, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "num_env_steps_trained_lifetime": 855680837, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 237568, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 510.95873068050287, "done": false, "training_iteration": 58, "trial_id": "40149_00000", "date": "2025-05-17_15-00-12", "timestamp": 1747461612, "time_this_iter_s": 8.008169412612915, "time_total_s": 399.99270367622375, "pid": 1464251, "hostname": "localhost.localdomain", "node_ip": "10.139.239.36", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MatmulEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4096, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f7796fcc220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 399.99270367622375, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 10.272727272727273, "ram_util_percent": 15.245454545454542}}
{"timers": {"training_iteration": 5.5111680644241785, "restore_env_runners": 1.6519236182651177e-05, "training_step": 5.510997998154475, "env_runner_sampling_timer": 0.6777734539906128, "learner_update_timer": 4.8194249621882435, "synch_weights": 0.0017203142259571904, "synch_env_connectors": 0.0026622193562083002}, "env_runners": {"episode_duration_sec_mean": 0.00035619611662696116, "num_module_steps_sampled": {"default_policy": 4096}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.4574241626867338e-05, "get_actions": 8.813433350128417e-05, "un_batch_to_individual_items": 9.056294886191824e-06, "remove_single_ts_time_rank_from_batch": 9.732611975855143e-07, "listify_data_for_vector_env": 1.5291487260610203e-05, "tensor_to_numpy": 2.827124583337994e-05}}, "connector_pipeline_timer": 0.00018957414437720848}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 8.327019175239144e-06, "add_time_dim_to_batch_and_zero_pad": 2.984502523904063e-06, "numpy_to_tensor": 1.743056236432535e-05, "add_observations_from_episodes_to_batch": 4.03219426307369e-06, "add_states_from_episodes_to_batch": 1.8067532717805208e-06}}, "connector_pipeline_timer": 5.5536836107546925e-05}, "num_episodes": 4096, "episode_len_min": 1, "time_between_sampling": 1.5510416133108085, "episode_len_mean": 1.0, "env_step_timer": 2.2716856675976696e-05, "num_episodes_lifetime": 224951, "agent_episode_returns_mean": {"default_agent": 51.0}, "episode_return_mean": 51.0, "weights_seq_no": 58.0, "num_env_steps_sampled_lifetime": 241664, "env_reset_timer": 0.00013909503468312323, "sample": 0.11326115975887925, "env_to_module_sum_episodes_length_out": 0.5025126377776328, "env_to_module_sum_episodes_length_in": 0.5025126377776328, "episode_len_max": 1, "rlmodule_inference_timer": 6.087616149863987e-05, "num_env_steps_sampled": 4096, "episode_return_max": 51.0, "num_module_steps_sampled_lifetime": {"default_policy": 241664}, "num_agent_steps_sampled": {"default_agent": 4096}, "episode_return_min": 51.0, "num_agent_steps_sampled_lifetime": {"default_agent": 241664}, "module_episode_returns_mean": {"default_policy": 51.0}, "num_env_steps_sampled_lifetime_throughput": 516.3950709833276}, "learners": {"default_policy": {"vf_explained_var": -1.1920928955078125e-07, "gradients_default_optimizer_global_norm": 5.597939126134044e-11, "mean_kl_loss": 1.8938623998036863e-13, "vf_loss_unclipped": 2627.69140625, "module_train_batch_size_mean": 128.0, "vf_loss": 10.0, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 1.320030196261257e-10, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "weights_seq_no": 59.0, "policy_loss": -1.0000001192092896, "total_loss": 9.0, "curr_entropy_coeff": 0.0, "num_module_steps_trained_lifetime": 14003328, "curr_kl_coeff": 6.394884875950786e-15}, "__all_modules__": {"num_env_steps_trained": 15728640, "num_module_steps_trained_lifetime": 14003328, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.7779597356782285e-05, "numpy_to_tensor": 0.00016685729071139868, "add_observations_from_episodes_to_batch": 0.007660708388196298, "add_states_from_episodes_to_batch": 5.383922222070838e-06, "batch_individual_items": 0.03971776153435002, "general_advantage_estimation": 0.018796259633822848, "add_columns_from_episodes_to_train_batch": 0.056978533068887886, "add_one_ts_to_episodes_and_truncate": 0.04866060656929805}}, "connector_pipeline_timer": 0.17253341159905083}, "learner_connector_sum_episodes_length_out": 5700.3341186031175, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 4096.0, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "num_env_steps_trained_lifetime": 871409477, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 241664, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 516.3950709833276, "done": false, "training_iteration": 59, "trial_id": "40149_00000", "date": "2025-05-17_15-00-20", "timestamp": 1747461620, "time_this_iter_s": 7.924861192703247, "time_total_s": 407.917564868927, "pid": 1464251, "hostname": "localhost.localdomain", "node_ip": "10.139.239.36", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MatmulEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4096, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f7796fcc220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 407.917564868927, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 10.572727272727274, "ram_util_percent": 15.227272727272725}}
{"timers": {"training_iteration": 5.536587673770695, "restore_env_runners": 1.6436704520087878e-05, "training_step": 5.53641746532195, "env_runner_sampling_timer": 0.679596031280648, "learner_update_timer": 4.842959963256329, "synch_weights": 0.0017196807337311075, "synch_env_connectors": 0.0026599225027011462}, "env_runners": {"episode_duration_sec_mean": 0.00035701037995750085, "num_module_steps_sampled": {"default_policy": 4096}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.458280502003936e-05, "get_actions": 8.808233147954665e-05, "un_batch_to_individual_items": 9.057205678596665e-06, "remove_single_ts_time_rank_from_batch": 9.744479071102212e-07, "listify_data_for_vector_env": 1.5302324175766363e-05, "tensor_to_numpy": 2.8279004392597666e-05}}, "connector_pipeline_timer": 0.00018956266849766063}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 8.333584626642097e-06, "add_time_dim_to_batch_and_zero_pad": 2.9857937612397527e-06, "numpy_to_tensor": 1.743788762376994e-05, "add_observations_from_episodes_to_batch": 4.0339810136811995e-06, "add_states_from_episodes_to_batch": 1.809668691912206e-06}}, "connector_pipeline_timer": 5.556799399217129e-05}, "num_episodes": 4096, "episode_len_min": 1, "time_between_sampling": 1.5644908133663196, "episode_len_mean": 1.0, "env_step_timer": 2.2725604247726812e-05, "num_episodes_lifetime": 229047, "agent_episode_returns_mean": {"default_agent": 51.0}, "episode_return_mean": 51.0, "weights_seq_no": 59.0, "num_env_steps_sampled_lifetime": 245760, "env_reset_timer": 0.00013909503468312323, "sample": 0.11331901798748818, "env_to_module_sum_episodes_length_out": 0.5025126171611785, "env_to_module_sum_episodes_length_in": 0.5025126171611785, "episode_len_max": 1, "rlmodule_inference_timer": 6.058081876817462e-05, "num_env_steps_sampled": 4096, "episode_return_max": 51.0, "num_module_steps_sampled_lifetime": {"default_policy": 245760}, "num_agent_steps_sampled": {"default_agent": 4096}, "episode_return_min": 51.0, "num_agent_steps_sampled_lifetime": {"default_agent": 245760}, "module_episode_returns_mean": {"default_policy": 51.0}, "num_env_steps_sampled_lifetime_throughput": 507.8813347240407}, "learners": {"default_policy": {"vf_explained_var": -1.1920928955078125e-07, "gradients_default_optimizer_global_norm": 5.398982649840178e-11, "mean_kl_loss": 1.7859707311142226e-13, "vf_loss_unclipped": 2627.691162109375, "module_train_batch_size_mean": 128.0, "vf_loss": 10.0, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 1.2748496702741363e-10, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "weights_seq_no": 60.0, "policy_loss": -1.0000001192092896, "total_loss": 9.0, "curr_entropy_coeff": 0.0, "num_module_steps_trained_lifetime": 14249088, "curr_kl_coeff": 3.197442437975393e-15}, "__all_modules__": {"num_env_steps_trained": 15728640, "num_module_steps_trained_lifetime": 14249088, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.777721107281867e-05, "numpy_to_tensor": 0.0001668292196709698, "add_observations_from_episodes_to_batch": 0.00770469185624551, "add_states_from_episodes_to_batch": 5.3788745882132406e-06, "batch_individual_items": 0.039953608510688854, "general_advantage_estimation": 0.01882985648795061, "add_columns_from_episodes_to_train_batch": 0.05737538459766467, "add_one_ts_to_episodes_and_truncate": 0.04891653535765032}}, "connector_pipeline_timer": 0.17350061451994692}, "learner_connector_sum_episodes_length_out": 5709.115798103863, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 4096.0, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "num_env_steps_trained_lifetime": 887138117, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 245760, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 507.8813347240407, "done": false, "training_iteration": 60, "trial_id": "40149_00000", "date": "2025-05-17_15-00-28", "timestamp": 1747461628, "time_this_iter_s": 8.059404134750366, "time_total_s": 415.97696900367737, "pid": 1464251, "hostname": "localhost.localdomain", "node_ip": "10.139.239.36", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MatmulEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4096, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f7796fcc220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 415.97696900367737, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 10.341666666666667, "ram_util_percent": 15.249999999999998}}
{"timers": {"training_iteration": 5.561157385703184, "restore_env_runners": 1.6354998174150214e-05, "training_step": 5.560987005538861, "env_runner_sampling_timer": 0.6813031232970205, "learner_update_timer": 4.865733199044611, "synch_weights": 0.0017192223064664348, "synch_env_connectors": 0.0026771042780964487}, "env_runners": {"episode_duration_sec_mean": 0.00035964310882263817, "num_module_steps_sampled": {"default_policy": 4096}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.4568158726421777e-05, "get_actions": 8.798663619138624e-05, "un_batch_to_individual_items": 9.042271717980272e-06, "remove_single_ts_time_rank_from_batch": 9.730603100550386e-07, "listify_data_for_vector_env": 1.5284215833876353e-05, "tensor_to_numpy": 2.8244447346394407e-05}}, "connector_pipeline_timer": 0.00018931829226882037}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 8.329400687382758e-06, "add_time_dim_to_batch_and_zero_pad": 2.983718278858151e-06, "numpy_to_tensor": 1.7422085281155845e-05, "add_observations_from_episodes_to_batch": 4.029610918503048e-06, "add_states_from_episodes_to_batch": 1.808899582569718e-06}}, "connector_pipeline_timer": 5.5517107543100514e-05}, "num_episodes": 4096, "episode_len_min": 1, "time_between_sampling": 1.5776158995383642, "episode_len_mean": 1.0, "env_step_timer": 2.2709626228875388e-05, "num_episodes_lifetime": 233143, "agent_episode_returns_mean": {"default_agent": 51.0}, "episode_return_mean": 51.0, "weights_seq_no": 60.0, "num_env_steps_sampled_lifetime": 249856, "env_reset_timer": 0.00013909503468312323, "sample": 0.1133806269969971, "env_to_module_sum_episodes_length_out": 0.5025126022146549, "env_to_module_sum_episodes_length_in": 0.5025126022146549, "episode_len_max": 1, "rlmodule_inference_timer": 6.042032710444926e-05, "num_env_steps_sampled": 4096, "episode_return_max": 51.0, "num_module_steps_sampled_lifetime": {"default_policy": 249856}, "num_agent_steps_sampled": {"default_agent": 4096}, "episode_return_min": 51.0, "num_agent_steps_sampled_lifetime": {"default_agent": 249856}, "module_episode_returns_mean": {"default_policy": 51.0}, "num_env_steps_sampled_lifetime_throughput": 511.5172225656372}, "learners": {"default_policy": {"vf_explained_var": -1.1920928955078125e-07, "gradients_default_optimizer_global_norm": 5.215651521783826e-11, "mean_kl_loss": 1.6439417372966086e-13, "vf_loss_unclipped": 2627.69189453125, "module_train_batch_size_mean": 128.0, "vf_loss": 10.0, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 1.2331680121491218e-10, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "weights_seq_no": 61.0, "policy_loss": -1.0000001192092896, "total_loss": 9.0, "curr_entropy_coeff": 0.0, "num_module_steps_trained_lifetime": 14494848, "curr_kl_coeff": 1.5987212189876965e-15}, "__all_modules__": {"num_env_steps_trained": 15728640, "num_module_steps_trained_lifetime": 14494848, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.7774595346203047e-05, "numpy_to_tensor": 0.00016680091502534926, "add_observations_from_episodes_to_batch": 0.007748818958104159, "add_states_from_episodes_to_batch": 5.3738013107284864e-06, "batch_individual_items": 0.04018625480625568, "general_advantage_estimation": 0.018863685260238714, "add_columns_from_episodes_to_train_batch": 0.057782542644766156, "add_one_ts_to_episodes_and_truncate": 0.049174523162983895}}, "connector_pipeline_timer": 0.17447735085656485}, "learner_connector_sum_episodes_length_out": 5717.971010602733, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 4096.0, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "num_env_steps_trained_lifetime": 902866757, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 249856, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 511.5172225656372, "done": false, "training_iteration": 61, "trial_id": "40149_00000", "date": "2025-05-17_15-00-36", "timestamp": 1747461636, "time_this_iter_s": 7.998016834259033, "time_total_s": 423.9749858379364, "pid": 1464251, "hostname": "localhost.localdomain", "node_ip": "10.139.239.36", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MatmulEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4096, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f7796fcc220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 423.9749858379364, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 10.327272727272728, "ram_util_percent": 15.218181818181817}}
{"timers": {"training_iteration": 5.585635114685631, "restore_env_runners": 1.6295447820162804e-05, "training_step": 5.585464287413673, "env_runner_sampling_timer": 0.6832163070040115, "learner_update_timer": 4.88822553994448, "synch_weights": 0.00171754346345988, "synch_env_connectors": 0.0026731779156676204}, "env_runners": {"episode_duration_sec_mean": 0.00035947750075138174, "num_module_steps_sampled": {"default_policy": 4096}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.4578360974786183e-05, "get_actions": 8.805896318169737e-05, "un_batch_to_individual_items": 9.043613996725053e-06, "remove_single_ts_time_rank_from_batch": 9.738969584789197e-07, "listify_data_for_vector_env": 1.5288984305422047e-05, "tensor_to_numpy": 2.825638248743347e-05}}, "connector_pipeline_timer": 0.00018945177386972908}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 8.34534256170097e-06, "add_time_dim_to_batch_and_zero_pad": 2.983744543767139e-06, "numpy_to_tensor": 1.7440060989544028e-05, "add_observations_from_episodes_to_batch": 4.032909964426184e-06, "add_states_from_episodes_to_batch": 1.8087367667667964e-06}}, "connector_pipeline_timer": 5.556582652175826e-05}, "num_episodes": 4096, "episode_len_min": 1, "time_between_sampling": 1.5901043273109186, "episode_len_mean": 1.0, "env_step_timer": 2.2718123418978662e-05, "num_episodes_lifetime": 237239, "agent_episode_returns_mean": {"default_agent": 51.0}, "episode_return_mean": 51.0, "weights_seq_no": 61.0, "num_env_steps_sampled_lifetime": 253952, "env_reset_timer": 0.00013909503468312323, "sample": 0.11347172942323235, "env_to_module_sum_episodes_length_out": 0.5025125913787188, "env_to_module_sum_episodes_length_in": 0.5025125913787188, "episode_len_max": 1, "rlmodule_inference_timer": 6.127730977252026e-05, "num_env_steps_sampled": 4096, "episode_return_max": 51.0, "num_module_steps_sampled_lifetime": {"default_policy": 253952}, "num_agent_steps_sampled": {"default_agent": 4096}, "episode_return_min": 51.0, "num_agent_steps_sampled_lifetime": {"default_agent": 253952}, "module_episode_returns_mean": {"default_policy": 51.0}, "num_env_steps_sampled_lifetime_throughput": 510.6839210633394}, "learners": {"default_policy": {"vf_explained_var": 0.0, "gradients_default_optimizer_global_norm": 5.0447007682308254e-11, "mean_kl_loss": 1.5324431990298287e-13, "vf_loss_unclipped": 2627.691162109375, "module_train_batch_size_mean": 128.0, "vf_loss": 10.0, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 1.1942372091233722e-10, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "weights_seq_no": 62.0, "policy_loss": -1.0000001192092896, "total_loss": 9.0, "curr_entropy_coeff": 0.0, "num_module_steps_trained_lifetime": 14740608, "curr_kl_coeff": 7.993606094938482e-16}, "__all_modules__": {"num_env_steps_trained": 15728640, "num_module_steps_trained_lifetime": 14740608, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.7771948416832533e-05, "numpy_to_tensor": 0.0001667715366570698, "add_observations_from_episodes_to_batch": 0.007793146252944245, "add_states_from_episodes_to_batch": 5.368711404985114e-06, "batch_individual_items": 0.04043172228016775, "general_advantage_estimation": 0.01889768322942791, "add_columns_from_episodes_to_train_batch": 0.05818387023016666, "add_one_ts_to_episodes_and_truncate": 0.04943448076717132}}, "connector_pipeline_timer": 0.17546342063259354}, "learner_connector_sum_episodes_length_out": 5726.897407271816, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 4096.0, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "num_env_steps_trained_lifetime": 918595397, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 253952, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 510.6839210633394, "done": false, "training_iteration": 62, "trial_id": "40149_00000", "date": "2025-05-17_15-00-44", "timestamp": 1747461644, "time_this_iter_s": 8.013158082962036, "time_total_s": 431.98814392089844, "pid": 1464251, "hostname": "localhost.localdomain", "node_ip": "10.139.239.36", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MatmulEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4096, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f7796fcc220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 431.98814392089844, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 10.183333333333335, "ram_util_percent": 15.258333333333333}}
{"timers": {"training_iteration": 5.610367717658951, "restore_env_runners": 1.621063363427785e-05, "training_step": 5.610196676969876, "env_runner_sampling_timer": 0.6853573967037638, "learner_update_timer": 4.910741925965564, "synch_weights": 0.0017170926788748634, "synch_env_connectors": 0.0026699212966347246}, "env_runners": {"episode_duration_sec_mean": 0.0003586713137337938, "num_module_steps_sampled": {"default_policy": 4096}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.4675608644932593e-05, "get_actions": 8.866339123648134e-05, "un_batch_to_individual_items": 9.113288377909992e-06, "remove_single_ts_time_rank_from_batch": 9.837436955714074e-07, "listify_data_for_vector_env": 1.5408697206891194e-05, "tensor_to_numpy": 2.8445656863603515e-05}}, "connector_pipeline_timer": 0.00019089125450482558}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 8.43808388281836e-06, "add_time_dim_to_batch_and_zero_pad": 3.008937981473513e-06, "numpy_to_tensor": 1.7569141438002394e-05, "add_observations_from_episodes_to_batch": 4.064547652636821e-06, "add_states_from_episodes_to_batch": 1.8263971245108165e-06}}, "connector_pipeline_timer": 5.608779297355191e-05}, "num_episodes": 4096, "episode_len_min": 1, "time_between_sampling": 1.60196112783863, "episode_len_mean": 1.0, "env_step_timer": 2.287942844547149e-05, "num_episodes_lifetime": 241335, "agent_episode_returns_mean": {"default_agent": 51.0}, "episode_return_mean": 51.0, "weights_seq_no": 62.0, "num_env_steps_sampled_lifetime": 258048, "env_reset_timer": 0.00013909503468312323, "sample": 0.11357082272424875, "env_to_module_sum_episodes_length_out": 0.5025125835228784, "env_to_module_sum_episodes_length_in": 0.5025125835228784, "episode_len_max": 1, "rlmodule_inference_timer": 6.145096955737212e-05, "num_env_steps_sampled": 4096, "episode_return_max": 51.0, "num_module_steps_sampled_lifetime": {"default_policy": 258048}, "num_agent_steps_sampled": {"default_agent": 4096}, "episode_return_min": 51.0, "num_agent_steps_sampled_lifetime": {"default_agent": 258048}, "module_episode_returns_mean": {"default_policy": 51.0}, "num_env_steps_sampled_lifetime_throughput": 507.5187597659864}, "learners": {"default_policy": {"vf_explained_var": -1.1920928955078125e-07, "gradients_default_optimizer_global_norm": 4.882333773381653e-11, "mean_kl_loss": 1.4551314526153186e-13, "vf_loss_unclipped": 2627.69140625, "module_train_batch_size_mean": 128.0, "vf_loss": 10.0, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 1.1572136998649896e-10, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "weights_seq_no": 63.0, "policy_loss": -1.0000001192092896, "total_loss": 9.0, "curr_entropy_coeff": 0.0, "num_module_steps_trained_lifetime": 14986368, "curr_kl_coeff": 3.996803047469241e-16}, "__all_modules__": {"num_env_steps_trained": 15728640, "num_module_steps_trained_lifetime": 14986368, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.7769434466106818e-05, "numpy_to_tensor": 0.0001667409666697335, "add_observations_from_episodes_to_batch": 0.007837693643096104, "add_states_from_episodes_to_batch": 5.36360771321958e-06, "batch_individual_items": 0.0406899973203175, "general_advantage_estimation": 0.018931609199711843, "add_columns_from_episodes_to_train_batch": 0.05857975931178595, "add_one_ts_to_episodes_and_truncate": 0.04969639755945619}}, "connector_pipeline_timer": 0.17645897801791402}, "learner_connector_sum_episodes_length_out": 5735.892678906456, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 4096.0, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "num_env_steps_trained_lifetime": 934324037, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 258048, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 507.5187597659864, "done": false, "training_iteration": 63, "trial_id": "40149_00000", "date": "2025-05-17_15-00-52", "timestamp": 1747461652, "time_this_iter_s": 8.063080072402954, "time_total_s": 440.0512239933014, "pid": 1464251, "hostname": "localhost.localdomain", "node_ip": "10.139.239.36", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MatmulEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4096, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f7796fcc220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 440.0512239933014, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 10.645454545454546, "ram_util_percent": 15.263636363636364}}
{"timers": {"training_iteration": 5.635058550231755, "restore_env_runners": 1.61307875284912e-05, "training_step": 5.634887272710064, "env_runner_sampling_timer": 0.6895357850660151, "learner_update_timer": 4.931180833876591, "synch_weights": 0.0017175039022622822, "synch_env_connectors": 0.002665971884369072}, "env_runners": {"episode_duration_sec_mean": 0.00037018637158325873, "num_module_steps_sampled": {"default_policy": 4096}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.4680418333089388e-05, "get_actions": 8.874043993558906e-05, "un_batch_to_individual_items": 9.11664336304949e-06, "remove_single_ts_time_rank_from_batch": 9.832149145050102e-07, "listify_data_for_vector_env": 1.5404987217069367e-05, "tensor_to_numpy": 2.8466264318115014e-05}}, "connector_pipeline_timer": 0.0001909836010444588}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 8.428199250318311e-06, "add_time_dim_to_batch_and_zero_pad": 3.0117255021393444e-06, "numpy_to_tensor": 1.7577565126388487e-05, "add_observations_from_episodes_to_batch": 4.067001653426152e-06, "add_states_from_episodes_to_batch": 1.8252577053118194e-06}}, "connector_pipeline_timer": 5.6081197136030956e-05}, "num_episodes": 4096, "episode_len_min": 1, "time_between_sampling": 1.613612467545098, "episode_len_mean": 1.0, "env_step_timer": 2.2866079273690386e-05, "num_episodes_lifetime": 245431, "agent_episode_returns_mean": {"default_agent": 51.0}, "episode_return_mean": 51.0, "weights_seq_no": 63.0, "num_env_steps_sampled_lifetime": 262144, "env_reset_timer": 0.00013909503468312323, "sample": 0.11370326261131108, "env_to_module_sum_episodes_length_out": 0.5025125778275485, "env_to_module_sum_episodes_length_in": 0.5025125778275485, "episode_len_max": 1, "rlmodule_inference_timer": 7.625549536190974e-05, "num_env_steps_sampled": 4096, "episode_return_max": 51.0, "num_module_steps_sampled_lifetime": {"default_policy": 262144}, "num_agent_steps_sampled": {"default_agent": 4096}, "episode_return_min": 51.0, "num_agent_steps_sampled_lifetime": {"default_agent": 262144}, "module_episode_returns_mean": {"default_policy": 51.0}, "num_env_steps_sampled_lifetime_throughput": 506.2353190255379}, "learners": {"default_policy": {"vf_explained_var": -1.1920928955078125e-07, "gradients_default_optimizer_global_norm": 4.7313500339818404e-11, "mean_kl_loss": 1.3517549438731707e-13, "vf_loss_unclipped": 2627.69140625, "module_train_batch_size_mean": 128.0, "vf_loss": 10.0, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 1.1227541119041007e-10, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "weights_seq_no": 64.0, "policy_loss": -1.0000001192092896, "total_loss": 9.0, "curr_entropy_coeff": 0.0, "num_module_steps_trained_lifetime": 15232128, "curr_kl_coeff": 1.9984015237346206e-16}, "__all_modules__": {"num_env_steps_trained": 15728640, "num_module_steps_trained_lifetime": 15232128, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.776719739828088e-05, "numpy_to_tensor": 0.00016670953233642862, "add_observations_from_episodes_to_batch": 0.007882386938921135, "add_states_from_episodes_to_batch": 5.358468028116841e-06, "batch_individual_items": 0.04094452021353641, "general_advantage_estimation": 0.018965545937574588, "add_columns_from_episodes_to_train_batch": 0.05896994318354949, "add_one_ts_to_episodes_and_truncate": 0.04996014358422338}}, "connector_pipeline_timer": 0.17744708517316388}, "learner_connector_sum_episodes_length_out": 5744.954555367677, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 4096.0, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "num_env_steps_trained_lifetime": 950052677, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 262144, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 506.2353190255379, "done": false, "training_iteration": 64, "trial_id": "40149_00000", "date": "2025-05-17_15-01-00", "timestamp": 1747461660, "time_this_iter_s": 8.083997249603271, "time_total_s": 448.13522124290466, "pid": 1464251, "hostname": "localhost.localdomain", "node_ip": "10.139.239.36", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MatmulEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4096, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f7796fcc220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 448.13522124290466, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 10.863636363636363, "ram_util_percent": 15.236363636363638}}
{"timers": {"training_iteration": 5.659164230649512, "restore_env_runners": 1.605323931310755e-05, "training_step": 5.658992766853653, "env_runner_sampling_timer": 0.6915250924852252, "learner_update_timer": 4.953240999947383, "synch_weights": 0.0017175466241452827, "synch_env_connectors": 0.0026648778258511916}, "env_runners": {"episode_duration_sec_mean": 0.00036628864108934067, "num_module_steps_sampled": {"default_policy": 4096}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.4712369626346765e-05, "get_actions": 8.888131621623057e-05, "un_batch_to_individual_items": 9.139798284359275e-06, "remove_single_ts_time_rank_from_batch": 9.873908223837837e-07, "listify_data_for_vector_env": 1.5451524553643525e-05, "tensor_to_numpy": 2.8531087122094483e-05}}, "connector_pipeline_timer": 0.00019139054503157824}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 8.447279165098021e-06, "add_time_dim_to_batch_and_zero_pad": 3.018155948474606e-06, "numpy_to_tensor": 1.761082383351405e-05, "add_observations_from_episodes_to_batch": 4.0737805336707055e-06, "add_states_from_episodes_to_batch": 1.8309526495073035e-06}}, "connector_pipeline_timer": 5.622296800963566e-05}, "num_episodes": 4096, "episode_len_min": 1, "time_between_sampling": 1.6248888268631476, "episode_len_mean": 1.0, "env_step_timer": 2.2908984498815138e-05, "num_episodes_lifetime": 249527, "agent_episode_returns_mean": {"default_agent": 51.0}, "episode_return_mean": 51.0, "weights_seq_no": 64.0, "num_env_steps_sampled_lifetime": 266240, "env_reset_timer": 0.00013909503468312323, "sample": 0.1138096021883093, "env_to_module_sum_episodes_length_out": 0.5025125736985467, "env_to_module_sum_episodes_length_in": 0.5025125736985467, "episode_len_max": 1, "rlmodule_inference_timer": 7.277253954381644e-05, "num_env_steps_sampled": 4096, "episode_return_max": 51.0, "num_module_steps_sampled_lifetime": {"default_policy": 266240}, "num_agent_steps_sampled": {"default_agent": 4096}, "episode_return_min": 51.0, "num_agent_steps_sampled_lifetime": {"default_agent": 266240}, "module_episode_returns_mean": {"default_policy": 51.0}, "num_env_steps_sampled_lifetime_throughput": 508.32277897509704}, "learners": {"default_policy": {"vf_explained_var": -1.1920928955078125e-07, "gradients_default_optimizer_global_norm": 4.592053473584379e-11, "mean_kl_loss": 1.2466282617740881e-13, "vf_loss_unclipped": 2627.69140625, "module_train_batch_size_mean": 128.0, "vf_loss": 10.0, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 1.0909141645587539e-10, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "weights_seq_no": 65.0, "policy_loss": -1.0000001192092896, "total_loss": 9.0, "curr_entropy_coeff": 0.0, "num_module_steps_trained_lifetime": 15477888, "curr_kl_coeff": 9.992007618673103e-17}, "__all_modules__": {"num_env_steps_trained": 15728640, "num_module_steps_trained_lifetime": 15477888, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.7764783029610825e-05, "numpy_to_tensor": 0.0001666777128869888, "add_observations_from_episodes_to_batch": 0.007927219994770618, "add_states_from_episodes_to_batch": 5.353278480845576e-06, "batch_individual_items": 0.04119567129285601, "general_advantage_estimation": 0.018999757421959546, "add_columns_from_episodes_to_train_batch": 0.05936949049024983, "add_one_ts_to_episodes_and_truncate": 0.05022560432253813}}, "connector_pipeline_timer": 0.17844330674921047}, "learner_connector_sum_episodes_length_out": 5754.080805031783, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 4096.0, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "num_env_steps_trained_lifetime": 965781317, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 266240, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 508.32277897509704, "done": false, "training_iteration": 65, "trial_id": "40149_00000", "date": "2025-05-17_15-01-08", "timestamp": 1747461668, "time_this_iter_s": 8.051585912704468, "time_total_s": 456.18680715560913, "pid": 1464251, "hostname": "localhost.localdomain", "node_ip": "10.139.239.36", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MatmulEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4096, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f7796fcc220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 456.18680715560913, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 10.6, "ram_util_percent": 15.216666666666663}}
{"timers": {"training_iteration": 5.683014579693397, "restore_env_runners": 1.5985777477317454e-05, "training_step": 5.682842805054417, "env_runner_sampling_timer": 0.6934937227602451, "learner_update_timer": 4.975064570268277, "synch_weights": 0.0017175499580936973, "synch_env_connectors": 0.0026795835080015906}, "env_runners": {"episode_duration_sec_mean": 0.0003544406827131752, "num_module_steps_sampled": {"default_policy": 4096}, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.4614629663848044e-05, "get_actions": 8.830301515356147e-05, "un_batch_to_individual_items": 9.084660943851075e-06, "remove_single_ts_time_rank_from_batch": 9.797765868599541e-07, "listify_data_for_vector_env": 1.5339541912953584e-05, "tensor_to_numpy": 2.8347776845173152e-05}}, "connector_pipeline_timer": 0.00019005292965959607}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 8.358451493424136e-06, "add_time_dim_to_batch_and_zero_pad": 2.992623781645778e-06, "numpy_to_tensor": 1.74881253387007e-05, "add_observations_from_episodes_to_batch": 4.0385878037904745e-06, "add_states_from_episodes_to_batch": 1.8130115525823386e-06}}, "connector_pipeline_timer": 5.571527714473732e-05}, "num_episodes": 4096, "episode_len_min": 1, "time_between_sampling": 1.635703223861617, "episode_len_mean": 1.0, "env_step_timer": 2.276725306746114e-05, "num_episodes_lifetime": 253623, "agent_episode_returns_mean": {"default_agent": 51.0}, "episode_return_mean": 51.0, "weights_seq_no": 65.0, "num_env_steps_sampled_lifetime": 270336, "env_reset_timer": 0.00013909503468312323, "sample": 0.11388416335398734, "env_to_module_sum_episodes_length_out": 0.5025125707051012, "env_to_module_sum_episodes_length_in": 0.5025125707051012, "episode_len_max": 1, "rlmodule_inference_timer": 7.198165303941307e-05, "num_env_steps_sampled": 4096, "episode_return_max": 51.0, "num_module_steps_sampled_lifetime": {"default_policy": 270336}, "num_agent_steps_sampled": {"default_agent": 4096}, "episode_return_min": 51.0, "num_agent_steps_sampled_lifetime": {"default_agent": 270336}, "module_episode_returns_mean": {"default_policy": 51.0}, "num_env_steps_sampled_lifetime_throughput": 508.34472311941204}, "learners": {"default_policy": {"vf_explained_var": -1.1920928955078125e-07, "gradients_default_optimizer_global_norm": 4.458834343412654e-11, "mean_kl_loss": 1.1921378868882254e-13, "vf_loss_unclipped": 2627.691650390625, "module_train_batch_size_mean": 128.0, "vf_loss": 10.0, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "entropy": 1.0604252892454369e-10, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "weights_seq_no": 66.0, "policy_loss": -1.0000001192092896, "total_loss": 9.0, "curr_entropy_coeff": 0.0, "num_module_steps_trained_lifetime": 15723648, "curr_kl_coeff": 4.9960038093365514e-17}, "__all_modules__": {"num_env_steps_trained": 15728640, "num_module_steps_trained_lifetime": 15723648, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.7762056933191787e-05, "numpy_to_tensor": 0.0001666451344727391, "add_observations_from_episodes_to_batch": 0.007972229020415245, "add_states_from_episodes_to_batch": 5.348031583713289e-06, "batch_individual_items": 0.04144327699256782, "general_advantage_estimation": 0.019034078257971827, "add_columns_from_episodes_to_train_batch": 0.05977830714879958, "add_one_ts_to_episodes_and_truncate": 0.05049277052151806}}, "connector_pipeline_timer": 0.17944725123731467}, "learner_connector_sum_episodes_length_out": 5763.26923424707, "num_non_trainable_parameters": 0.0, "learner_connector_sum_episodes_length_in": 4096.0, "num_module_steps_trained": 245760, "num_trainable_parameters": 134148.0, "num_env_steps_trained_lifetime": 981509957, "num_env_steps_trained_lifetime_throughput": 0.0}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 270336, "fault_tolerance": {"num_healthy_workers": 8, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 508.34472311941204, "done": false, "training_iteration": 66, "trial_id": "40149_00000", "date": "2025-05-17_15-01-16", "timestamp": 1747461676, "time_this_iter_s": 8.050467252731323, "time_total_s": 464.23727440834045, "pid": 1464251, "hostname": "localhost.localdomain", "node_ip": "10.139.239.36", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "MatmulEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": true, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 8, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 4096, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7f7796fcc220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 464.23727440834045, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 10.336363636363636, "ram_util_percent": 15.199999999999996}}
